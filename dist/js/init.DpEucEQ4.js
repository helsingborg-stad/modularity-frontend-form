var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});const _Steps=class _Steps{constructor(steps,stepNavigator,stepUIManager,nextButton,previousButton){this.steps=steps,this.stepNavigator=stepNavigator,this.stepUIManager=stepUIManager,this.nextButton=nextButton,this.previousButton=previousButton}editableSteps={};init(){this.editableSteps[this.stepNavigator.getActiveStepIndex()]=!0,this.setupPrevious(),this.setupNext(),this.setupEdit()}setupEdit(){for(const step of Object.values(this.steps))step.getEditItem()&&step.getEditItem().addEventListener("click",e=>{if(e.preventDefault(),step.getId()===this.stepNavigator.getActiveStepIndex()||!this.editableSteps[step.getId()])return;const currentStep=this.stepNavigator.getActiveStep(),nextStep=this.stepNavigator.goTo(step.getId());this.stepUIManager.handleValidity(currentStep,currentStep.validate()),nextStep&&this.handleMove(currentStep,nextStep)})}setupNext(){this.nextButton.addEventListener("click",e=>{e.preventDefault();const currentStep=this.stepNavigator.getActiveStep(),stepIsValid=currentStep.validate();if(this.stepUIManager.handleValidity(currentStep,stepIsValid,!0),!stepIsValid){this.stepUIManager.triggerErrorAnimation(currentStep);return}const nextStep=this.stepNavigator.goNext();nextStep&&(this.editableSteps[nextStep.getId()]=!0,this.handleMove(currentStep,nextStep))})}setupPrevious(){this.previousButton.addEventListener("click",e=>{e.preventDefault();const currentStep=this.stepNavigator.getActiveStep(),nextStep=this.stepNavigator.goPrevious(),stepIsValid=currentStep.validate();this.stepUIManager.handleValidity(currentStep,stepIsValid),nextStep&&this.handleMove(currentStep,nextStep)})}handleMove(currentStep,nextStep){this.stepUIManager.updateButtonStates(nextStep.getId(),currentStep.getId()),this.stepUIManager.showAndHideSteps(nextStep,currentStep)}};__name(_Steps,"Steps");let Steps=_Steps;const _StepUIManager=class _StepUIManager{constructor(steps,lang,nextButton,prevButton){this.steps=steps,this.lang=lang,this.nextButton=nextButton,this.prevButton=prevButton,this.nextButtonLabelElement=this.nextButton.querySelector(".c-button__label-text"),this.iconElement=this.nextButton.querySelector(".c-icon"),this.maxSteps=Object.keys(this.steps).length-1}visibilityHiddenClass="u-visibility--hidden";isActiveClass="is-active";validClass="is-valid";invalidClass="is-invalid";hasPassedClass="has-passed";shakeAnimationClass="animate-shake";exitRightAnimationClass="animate-exit-right";exitLeftAnimationClass="animate-exit-left";nextButtonLabelElement;maxSteps;iconElement;updateButtonStates(activeStep,previousActiveStep){const label=activeStep===this.maxSteps?this.lang.submit??"Submit":this.lang.next??"Next";this.nextButtonLabelElement&&(this.nextButtonLabelElement.innerHTML=label),this.nextButton&&this.nextButton.setAttribute("aria-label",label),this.iconElement&&this.iconElement.setAttribute("data-material-symbol",activeStep===this.maxSteps?"send":"arrow_forward_ios"),this.prevButton.classList.toggle(this.visibilityHiddenClass,activeStep===0)}handleValidity(step,valid,allowEdit=!1){step.getStepContainer().classList.toggle(this.invalidClass,!valid),step.getEditItem()?.classList.toggle(this.invalidClass,!valid),step.getEditItem()?.classList.toggle(this.validClass,valid),valid&&allowEdit&&step.getEditItem()?.classList.add(this.hasPassedClass),this.updateEditItemIcon(step,valid)}triggerErrorAnimation(step){step.getStepContainer().classList.remove(this.shakeAnimationClass),step.getStepContainer().offsetWidth,step.getStepContainer().classList.add(this.shakeAnimationClass)}showAndHideSteps(stepToShow,stepToHide){const exitClass=stepToShow.getId()>stepToHide.getId()?this.exitLeftAnimationClass:this.exitRightAnimationClass,allAnim=[this.exitLeftAnimationClass,this.exitRightAnimationClass,this.shakeAnimationClass];this.hideStep(stepToHide),stepToHide.getStepContainer().classList.remove(...allAnim),stepToShow.getStepContainer().classList.remove(...allAnim),stepToShow.getStepContainer().offsetWidth,stepToHide.getStepContainer().classList.add(exitClass),stepToShow.getStepContainer().classList.add(this.isActiveClass),this.showStep(stepToShow);const onTransitionEnd=__name(e=>{e.propertyName!=="transform"&&e.propertyName!=="opacity"||(stepToHide.getStepContainer().classList.remove(this.isActiveClass,exitClass),stepToHide.getStepContainer().removeEventListener("transitionend",onTransitionEnd))},"onTransitionEnd");stepToHide.getStepContainer().addEventListener("transitionend",onTransitionEnd),setTimeout(()=>{stepToHide.getStepContainer().classList.remove(this.isActiveClass,exitClass)},400)}showStep(step){step.getStepContainer().classList.add(this.isActiveClass),step.getEditItem()?.classList.add(this.isActiveClass)}hideStep(step){step.getStepContainer().classList.remove(this.isActiveClass),step.getEditItem()?.classList.remove(this.isActiveClass)}updateEditItemIcon(step,valid){step.getEditItemIcon()&&step.getEditItemIcon().setAttribute("data-material-symbol",valid?"check":"close")}};__name(_StepUIManager,"StepUIManager");let StepUIManager=_StepUIManager;const _StepNavigator=class _StepNavigator{constructor(steps,validator,submit,stepUIManager,formContainer,activeStep=0){this.steps=steps,this.validator=validator,this.submit=submit,this.stepUIManager=stepUIManager,this.formContainer=formContainer,this.activeStep=activeStep}goTo(id){return this.steps[id]&&id!==this.activeStep?(this.activeStep=id,this.steps[this.activeStep]):null}goNext(){return this.activeStep<Object.keys(this.steps).length-1?(this.activeStep++,this.steps[this.activeStep]):(this.activeStep===Object.keys(this.steps).length-1&&this.handleLastStep(),null)}goPrevious(){return this.activeStep>0?(this.activeStep--,this.steps[this.activeStep]):null}getActiveStep(){return this.steps[this.activeStep]}getActiveStepIndex(){return this.activeStep}getStep(id){return this.steps[id]?this.steps[id]:null}handleLastStep(){if(!this.validator.validateSteps()){const invalidStep=this.validator.getInvalidSteps()[0];if(invalidStep&&this.steps[Number(invalidStep)]){const step=this.steps[Number(invalidStep)];this.stepUIManager.showAndHideSteps(step,this.getActiveStep()),this.goTo(step.getId()),this.formContainer.scrollIntoView({behavior:"smooth"})}return}this.submit.submit()}};__name(_StepNavigator,"StepNavigator");let StepNavigator=_StepNavigator;var SubmitStatus=(SubmitStatus2=>(SubmitStatus2.Loading="loading",SubmitStatus2.Working="working",SubmitStatus2.Success="success",SubmitStatus2.Error="error",SubmitStatus2))(SubmitStatus||{}),FormMode=(FormMode2=>(FormMode2.Post="post",FormMode2.Update="update",FormMode2))(FormMode||{});const _Submit=class _Submit{constructor(form,modularityFrontendFormData2,modularityFrontendFormLang2,asyncNonce,statusHandler,statusRenderer){this.form=form,this.modularityFrontendFormData=modularityFrontendFormData2,this.modularityFrontendFormLang=modularityFrontendFormLang2,this.asyncNonce=asyncNonce,this.statusHandler=statusHandler,this.statusRenderer=statusRenderer,this.disableFormSubmission()}retry(){this.statusRenderer.reset(),this.submit()}return(){this.statusRenderer.reset()}disableFormSubmission(){const message="Form submission is disabled";this.form.formElement.addEventListener("submit",e=>{console.warn(message),e.preventDefault()}),this.form.formElement.submit=function(){console.warn(message)}}async submit(){this.statusHandler.setStatus(SubmitStatus.Working,this.modularityFrontendFormLang?.submitInit??"Submitting your form, please wait...","send",10);const url=this.form.mode===FormMode.Post?this.modularityFrontendFormData.apiRoutes?.submitForm:this.form.mode===FormMode.Update?this.modularityFrontendFormData.apiRoutes?.updateForm:null;if(!url){this.statusHandler.setStatus(SubmitStatus.Error,this.modularityFrontendFormLang?.submitUrlError??"Could not find the submit URL. Please check your configuration.","link_off",0,4e3,this,this);return}const nonce=await this.asyncNonce.get(this.statusHandler,this.form.formId);try{const urlWithParams=new URL(url);if(urlWithParams.searchParams.append("module-id",this.form.formId.toString()),urlWithParams.searchParams.append("nonce",nonce?.toString()||""),urlWithParams.searchParams.append("holding-post-id",(this.form.holdingPostId??0).toString()),this.form.mode===FormMode.Update&&this.form.formUpdateId){const token=new URLSearchParams(window.location.search).get("token")??null;token&&urlWithParams.searchParams.append("token",token),urlWithParams.searchParams.append("post-id",this.form.formUpdateId.toString())}const finalUrl=urlWithParams.toString(),response=await fetch(finalUrl,{method:"POST",body:new FormData(this.form.formElement)}),json=await response.json();if(!response.ok){if(json.code=="invalid_field_values"){this.statusHandler.setStatus(SubmitStatus.Error,json?.message??this.modularityFrontendFormLang?.submitError,"data_alert",0,2e3,this,this);return}this.statusHandler.setStatus(SubmitStatus.Error,json?.message??this.modularityFrontendFormLang?.submitError,"error",0,3e3,this,this);return}response.ok&&this.statusHandler.setStatus(SubmitStatus.Success,this.modularityFrontendFormLang?.submitSuccess??"Form submitted successfully! Thank you for your submission.","celebration",100,4e3,this,!1)}catch(error){console.error("Error submitting form:",error),this.statusHandler.setStatus(SubmitStatus.Error,this.modularityFrontendFormLang?.submitError??"Form submission failed. Please try again."+(error?.message?` (${error.message})`:""),"error",0,4e3,this,this)}}};__name(_Submit,"Submit");let Submit=_Submit;const _FieldValidator=class _FieldValidator{constructor(uiHandler,validators=[]){this.uiHandler=uiHandler,this.validators=validators}parent;invalidValidator=!1;init(parent){this.parent=parent,this.uiHandler.init(this.parent),this.validators.forEach(validator=>{validator.init(this.parent)})}validate(){let isValid=!0;for(const validator of this.validators){const isInvalid=validator.isInvalid();if(isInvalid){isValid=!1,this.uiHandler.addInvalidNotice(isInvalid.getFailedValidationMessage()),this.invalidValidator=isInvalid;break}}return isValid&&this.uiHandler.removeInvalidNotice(),!isValid&&this.invalidValidator&&this.uiHandler.updateInvalidNotice(this.invalidValidator.getFailedValidationMessage()),isValid}};__name(_FieldValidator,"FieldValidator");let FieldValidator=_FieldValidator;const _FieldValidatorUIHandler=class _FieldValidatorUIHandler{constructor(notices){this.notices=notices}messageElementTarget="[data-js-frontend-form-notice-message]";field;activeNotice=null;invalidClass="is-invalid";currentNoticeMessage=null;noticeMessageElement=null;errorNotice;init(field){this.errorNotice=this.notices.getErrorNotice(),this.noticeMessageElement=this.errorNotice.querySelector(this.messageElementTarget),this.field=field}addInvalidNotice(message){if(this.activeNotice)return;const messageElement=this.errorNotice.querySelector(this.messageElementTarget);if(!messageElement){console.error("Message element not found in notice");return}this.noticeMessageElement=messageElement,this.currentNoticeMessage=message,this.noticeMessageElement.innerHTML=message,this.field.getFieldContainer().classList.add(this.invalidClass),this.field.getFieldContainer().append(this.errorNotice),this.activeNotice=this.errorNotice}updateInvalidNotice(message){!this.activeNotice||this.currentNoticeMessage===message||(this.noticeMessageElement.innerHTML=message,this.currentNoticeMessage=message)}removeInvalidNotice(){this.activeNotice&&(this.field.getFieldContainer().classList.remove(this.invalidClass),this.activeNotice.remove(),this.activeNotice=null)}};__name(_FieldValidatorUIHandler,"FieldValidatorUIHandler");let FieldValidatorUIHandler=_FieldValidatorUIHandler;const _NullFieldConditionsHandler=class _NullFieldConditionsHandler{constructor(conditions){this.conditions=conditions}init(parent,conditionsBuilder){}getConditions(){return[]}validate(){return!0}getIsDisabled(){return!1}addValueChangeListener(field){}checkConditions(){}};__name(_NullFieldConditionsHandler,"NullFieldConditionsHandler");let NullFieldConditionsHandler=_NullFieldConditionsHandler;const _NullFieldConditionValidator=class _NullFieldConditionValidator{init(parent){}validate(condition){return!1}};__name(_NullFieldConditionValidator,"NullFieldConditionValidator");let NullFieldConditionValidator=_NullFieldConditionValidator;const _NullFieldValueLoader=class _NullFieldValueLoader{load(value){}};__name(_NullFieldValueLoader,"NullFieldValueLoader");let NullFieldValueLoader=_NullFieldValueLoader;const _NullField=class _NullField{constructor(field,type,name,nullFieldConditionValidator,conditionsHandler,validator,loader=new NullFieldValueLoader){this.field=field,this.name=name,this.nullFieldConditionValidator=nullFieldConditionValidator,this.conditionsHandler=conditionsHandler,this.validator=validator,this.loader=loader,console.error(`Field type "${type}" is not implemented.`)}init(conditionBuilder){this.conditionsHandler.init(this,conditionBuilder),this.nullFieldConditionValidator.init(this),this.validator.init(this)}getFieldContainer(){return this.field}getName(){return this.name}getConditionsHandler(){return this.conditionsHandler}isRequired(){return!1}hasValue(){return!0}getValueLoader(){return this.loader}getConditionValidator(){return this.nullFieldConditionValidator}getValidator(){return this.validator}};__name(_NullField,"NullField");let NullField=_NullField;const _NullFieldFactory=class _NullFieldFactory{static create(field,type,name,unstructuredConditions,notices,stepId){return new NullField(field,type,name,new NullFieldConditionValidator,new NullFieldConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[]))}};__name(_NullFieldFactory,"NullFieldFactory");let NullFieldFactory=_NullFieldFactory;const _RepeaterConditionsHandler=class _RepeaterConditionsHandler{constructor(unstructuredConditions){this.unstructuredConditions=unstructuredConditions}fieldsObject={};parent=null;conditions=[];isDisabled=!1;init(parent,conditionsBuilder){this.parent=parent,this.conditions=conditionsBuilder.build(this.unstructuredConditions)}updateDisabled(disabled){this.parent&&this.isDisabled!==disabled&&(this.isDisabled=disabled,this.parent.getFieldContainer().classList.toggle("u-display--none",disabled),this.checkConditions())}validate(){let isValid=!1;for(const condition of this.getConditions())if(condition.validate()){isValid=!0;break}this.updateDisabled(!isValid)}getIsDisabled(){return this.isDisabled}getConditions(){return this.conditions}addValueChangeListener(field){this.fieldsObject[field.getName()]=field}checkConditions(){for(const fieldName in this.fieldsObject)this.fieldsObject[fieldName].getConditionsHandler().validate()}};__name(_RepeaterConditionsHandler,"RepeaterConditionsHandler");let RepeaterConditionsHandler=_RepeaterConditionsHandler;const _RepeaterConditionValidator=class _RepeaterConditionValidator{parent=null;init(parent){this.parent=parent}validate(condition){const rowCount=this.parent?.getRowCount()??0;switch(condition.operator){case"==empty":return rowCount===0;case"!=empty":return rowCount!==0;case">":return rowCount>Number(condition.value);case"<":return rowCount<Number(condition.value);default:return console.error("Invalid operator:",condition.operator),!1}}};__name(_RepeaterConditionValidator,"RepeaterConditionValidator");let RepeaterConditionValidator=_RepeaterConditionValidator;const _RepeaterValueLoader=class _RepeaterValueLoader{constructor(repeaterUI){this.repeaterUI=repeaterUI}parent;init(parent){this.parent=parent}load(value){if(!Array.isArray(value)||value.length===0){console.error("Invalid value for repeater field. Expected a non-empty array.");return}const linesToCreate=value.length-this.repeaterUI.getRowCount();for(let i=0;i<linesToCreate;i++)this.repeaterUI.buildRow(!0,!1);const rowFieldsObject=this.repeaterUI.getRows();for(const[index,rowValue]of value.entries()){if(typeof rowValue!="object"||rowValue===null){console.error(`Invalid row value at index ${index}. Expected an object.`);continue}this.addDataToRow(index,rowValue,rowFieldsObject)}}addDataToRow(rowIndex,rowValue,rowFieldsObject){for(const[fieldName,fieldValue]of Object.entries(rowValue)){const keyToLookForInRowFieldsObject=`[${this.parent.getName()}][${rowIndex}][${fieldName}]`;if(!rowFieldsObject[rowIndex]||!rowFieldsObject[rowIndex][keyToLookForInRowFieldsObject]){console.error(`Field with name ${keyToLookForInRowFieldsObject} not found in row ${rowIndex}. Skipping this field.`);continue}rowFieldsObject[rowIndex][keyToLookForInRowFieldsObject].getValueLoader().load(fieldValue)}}};__name(_RepeaterValueLoader,"RepeaterValueLoader");let RepeaterValueLoader=_RepeaterValueLoader;const _Repeater=class _Repeater{constructor(field,name,repeaterUI,conditionValidator,conditionsHandler,validator,loader=new RepeaterValueLoader){this.field=field,this.name=name,this.repeaterUI=repeaterUI,this.conditionValidator=conditionValidator,this.conditionsHandler=conditionsHandler,this.validator=validator,this.loader=loader}required=!1;minRows=0;maxRows=0;init(conditionBuilder){this.required=this.field.hasAttribute("data-js-required"),this.minRows=parseInt(this.field.getAttribute("data-js-min-rows")??"0"),this.maxRows=parseInt(this.field.getAttribute("data-js-max-rows")??"100"),this.repeaterUI.init(this,conditionBuilder),this.conditionsHandler.init(this,conditionBuilder),this.conditionValidator.init(this),this.validator.init(this),this.loader.init(this),this.listenForChanges()}getName(){return this.name}getConditionsHandler(){return this.conditionsHandler}getConditionValidator(){return this.conditionValidator}getValidator(){return this.validator}hasValue(){return this.repeaterUI.getRowCount()>0}getMinRows(){return this.minRows}getMaxRows(){return this.maxRows}getRowCount(){return this.repeaterUI.getRowCount()}isRequired(){return this.required}getFieldContainer(){return this.field}getValueLoader(){return this.loader}listenForChanges(){this.repeaterUI.addRowChangeListener(rowCount=>{this.validator.validate()})}};__name(_Repeater,"Repeater");let Repeater=_Repeater;const _RepeaterUI=class _RepeaterUI{constructor(fieldBuilder,fieldsInitiator,repeaterContainer,addRowButton,rowBuilder,stepId){this.fieldBuilder=fieldBuilder,this.fieldsInitiator=fieldsInitiator,this.repeaterContainer=repeaterContainer,this.addRowButton=addRowButton,this.rowBuilder=rowBuilder,this.stepId=stepId}rowIndex=0;rowCount=0;repeaterField;conditionBuilder;rowFieldsObject={};rowChangeListeners=[];rowCountElement=null;init(repeaterField,conditionBuilder){if(this.repeaterField=repeaterField,this.conditionBuilder=conditionBuilder,this.rowCountElement=this.repeaterField.getFieldContainer().querySelector("[data-js-repeater-row-counter]"),!this.repeaterField||!this.conditionBuilder){console.error("Repeater field or condition builder is not set");return}this.setupListeners();for(let i=0;i<this.repeaterField.getMinRows();i++)this.buildRow(!1)}getRowIndex(){return this.rowIndex}getRowCount(){return this.rowCount}getRows(){return this.rowFieldsObject}addRowChangeListener(rowCountChangeListener){this.rowChangeListeners.push(rowCountChangeListener)}rowCountChanged(count){this.rowChangeListeners.forEach(listener=>listener(count))}setupListeners(){this.addRowButton.addEventListener("click",e=>{e.preventDefault(),this.buildRow()}),this.rowCountElement&&this.addRowChangeListener(count=>{this.rowCountElement.innerHTML=count.toString()}),this.addRowChangeListener(count=>{this.addRowButton.disabled=count>=this.repeaterField.getMaxRows()})}removeRow(rowId){for(const fieldName in this.rowFieldsObject[rowId])this.fieldBuilder.removeField(fieldName,this.stepId)}buildRow(includeRemoveRowButton=!0,focusNewRow=!0){const rowId=this.rowIndex.toString(),row=this.rowBuilder.createRow(rowId,includeRemoveRowButton),builtRow=this.buildAddedFields(row);this.rowFieldsObject[rowId]=builtRow,row.querySelector("[data-js-repeater-remove-row]")?.addEventListener("click",e=>{e.preventDefault(),this.rowBuilder.deleteRow(row),this.removeRow(rowId),this.rowCountChanged(--this.rowCount)}),includeRemoveRowButton&&focusNewRow&&this.focusOnNewRow(row),this.rowCountChanged(++this.rowCount),this.rowIndex++}focusOnNewRow(row){const firstFocusable=row.querySelector(":not(.u-display--none) input, :not(.u-display--none) select, :not(.u-display--none) textarea, :not(.u-display--none) fieldset");firstFocusable&&firstFocusable.focus()}buildAddedFields(row){const newFieldsObject={};[...row.querySelectorAll("[data-js-field]")].forEach(field=>{const builtField=this.fieldBuilder.build(field,field.dataset.jsField,this.stepId);newFieldsObject[builtField.getName()]=builtField});for(const fieldName in newFieldsObject)newFieldsObject[fieldName].init(this.conditionBuilder),newFieldsObject[fieldName].getConditionsHandler().validate();return this.fieldsInitiator.initializeConditionals(newFieldsObject),newFieldsObject}};__name(_RepeaterUI,"RepeaterUI");let RepeaterUI=_RepeaterUI;const _RowBuilder=class _RowBuilder{constructor(template,templateContainer){this.template=template,this.templateContainer=templateContainer}replacement="MOD_FRONTEND_FORM_REPEATER_ROW_INDEX_REPLACE";createRow(id,includeRemoveRowButton=!0){let rowHtml=this.template.innerHTML;return rowHtml=rowHtml.replaceAll(this.replacement,id),this.appendRow(rowHtml,includeRemoveRowButton)}appendRow(rowHtml,includeRemoveRowButton=!0){const tempDiv=document.createElement("div");tempDiv.innerHTML=rowHtml;const row=tempDiv.firstElementChild;return this.templateContainer.appendChild(row),requestAnimationFrame(()=>{row.style.maxHeight=includeRemoveRowButton?row.scrollHeight+48+"px":"unset"}),includeRemoveRowButton||(row.classList.add("no-remove"),row.classList.add("animate-show")),row.addEventListener("transitionend",()=>{row.classList.add("animate-show"),row.style.maxHeight="unset"},{once:!0}),row}deleteRow(row){row.style.maxHeight=row.scrollHeight+48+"px",requestAnimationFrame(()=>{row.classList.add("animate-remove"),row.style.maxHeight="0px"}),row.addEventListener("transitionend",()=>{row.remove()},{once:!0})}};__name(_RowBuilder,"RowBuilder");let RowBuilder=_RowBuilder;const _RepeaterUIFactory=class _RepeaterUIFactory{static createRepeater(fieldBuilder,fieldsInitiator,repeaterContainer,addRowButton,stepId){const template=repeaterContainer.querySelector("[data-js-repeater-row-template]"),templateContainer=repeaterContainer.querySelector("[data-js-repeater-row-container]");return!template||!templateContainer?(console.error("Missing template or template container for repeater"),null):new RepeaterUI(fieldBuilder,fieldsInitiator,repeaterContainer,addRowButton,new RowBuilder(template,templateContainer),stepId)}};__name(_RepeaterUIFactory,"RepeaterUIFactory");let RepeaterUIFactory=_RepeaterUIFactory;const _RepeaterFactory=class _RepeaterFactory{static create(fieldBuilder,fieldsInitiator,field,name,unstructuredConditions,notices,stepId){const addRowButton=field.querySelector("[data-js-repeater-add-row]");if(!addRowButton)return console.error("Failed to find add row button for repeater"),NullFieldFactory.create(field,"repeater",name,unstructuredConditions,notices,stepId);const repeaterUI=RepeaterUIFactory.createRepeater(fieldBuilder,fieldsInitiator,field,addRowButton,stepId);return repeaterUI?new Repeater(field,name,repeaterUI,new RepeaterConditionValidator,new RepeaterConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[]),new RepeaterValueLoader(repeaterUI)):(console.error("Failed to create repeater UI instance"),NullFieldFactory.create(field,"repeater",name,unstructuredConditions,notices,stepId))}};__name(_RepeaterFactory,"RepeaterFactory");let RepeaterFactory=_RepeaterFactory;const _RadioConditionsHandler=class _RadioConditionsHandler{constructor(unstructuredConditions){this.unstructuredConditions=unstructuredConditions}fieldsObject={};parent=null;conditions=[];isDisabled=!1;init(parent,conditionsBuilder){this.parent=parent,this.conditions=conditionsBuilder.build(this.unstructuredConditions)}updateDisabled(disabled){this.isDisabled!==disabled&&(this.isDisabled=disabled,this.parent?.getChoices().forEach((checkbox,index)=>{index===0&&this.parent?.getFieldContainer().classList.toggle("u-display--none",disabled),checkbox.disabled=disabled}),this.checkConditions())}validate(){let isValid=!1;for(const condition of this.getConditions())if(condition.validate()){isValid=!0;break}this.updateDisabled(!isValid)}getIsDisabled(){return this.isDisabled}getConditions(){return this.conditions}addValueChangeListener(field){this.fieldsObject[field.getName()]=field}checkConditions(){for(const fieldName in this.fieldsObject)this.fieldsObject[fieldName].getConditionsHandler().validate()}};__name(_RadioConditionsHandler,"RadioConditionsHandler");let RadioConditionsHandler=_RadioConditionsHandler;const _RadioConditionValidator=class _RadioConditionValidator{parent=null;init(parent){this.parent=parent}validate(condition){const selected=this.parent?.getSelectedChoice()??"";switch(condition.operator){case"==":case"=":case"===":case"==contains":return selected===condition.value;case"!=":case"!==":case"!=contains":return selected!==condition.value;case"==empty":return Number(selected)===0;case"!=empty":return Number(selected)>0;default:return console.error("Invalid operator:",condition.operator),!1}}};__name(_RadioConditionValidator,"RadioConditionValidator");let RadioConditionValidator=_RadioConditionValidator;const _RadioValueLoader=class _RadioValueLoader{parent;init(parent){this.parent=parent}load(value){const sanitizedValue=this.extractValue(value);if(sanitizedValue===null)return;this.parent.getChoices().forEach(choice=>{choice.value===sanitizedValue?choice.checked=!0:choice.checked=!1})}extractValue(value){return value==null?null:String(typeof value=="boolean"?+value:value)}};__name(_RadioValueLoader,"RadioValueLoader");let RadioValueLoader=_RadioValueLoader;const _Radio=class _Radio{constructor(field,choices,name,radioValidator,conditionsHandler,validator,loader=new RadioValueLoader){this.field=field,this.choices=choices,this.name=name,this.radioValidator=radioValidator,this.conditionsHandler=conditionsHandler,this.validator=validator,this.loader=loader}required=!1;init(conditionBuilder){this.required=this.getFieldContainer().hasAttribute("data-js-required"),this.conditionsHandler.init(this,conditionBuilder),this.radioValidator.init(this),this.validator.init(this),this.loader.init(this),this.listenForChanges()}getName(){return this.name}getConditionsHandler(){return this.conditionsHandler}getConditionValidator(){return this.radioValidator}getValidator(){return this.validator}getChoices(){return this.choices}hasValue(){return this.getSelectedChoice().length>0}isRequired(){return this.required}getValueLoader(){return this.loader}getSelectedChoice(){const selectedChoice=[...this.getChoices()].find(choice=>choice.checked);return selectedChoice?selectedChoice.value:""}getFieldContainer(){return this.field}listenForChanges(){this.choices.forEach(choice=>{choice.addEventListener("change",()=>{this.conditionsHandler.checkConditions(),this.validator.validate()})})}};__name(_Radio,"Radio");let Radio=_Radio;var _a;let Required$1=(_a=class{constructor(modularityFrontendFormLang2){this.modularityFrontendFormLang=modularityFrontendFormLang2}radio;init(radio){this.radio=radio}isInvalid(){return this.radio.isRequired()&&!this.radio.hasValue()?this:!1}getFailedValidationMessage(){return this.modularityFrontendFormLang.errorRequired??"Please select a choice."}},__name(_a,"Required"),_a);const _RadioFactory=class _RadioFactory{static create(field,name,unstructuredConditions,modularityFrontendFormLang2,notices,stepId){const choices=field.querySelectorAll('input[type="radio"]');return choices.length===0?(console.error("Radio field is missing input elements"),NullFieldFactory.create(field,"radio",name,unstructuredConditions,notices,stepId)):new Radio(field,choices,name,new RadioConditionValidator,new RadioConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new Required$1(modularityFrontendFormLang2)]))}};__name(_RadioFactory,"RadioFactory");let RadioFactory=_RadioFactory;const _GoogleMapConditionsHandler=class _GoogleMapConditionsHandler{constructor(unstructuredConditions){this.unstructuredConditions=unstructuredConditions}fieldsObject={};parent=null;conditions=[];isDisabled=!1;init(parent,conditionsBuilder){this.parent=parent,this.conditions=conditionsBuilder.build(this.unstructuredConditions)}updateDisabled(disabled){this.parent&&this.isDisabled!==disabled&&(this.isDisabled=disabled,this.parent.getFieldContainer().classList.toggle("u-display--none",disabled),this.parent.getHiddenField().disabled=disabled,this.checkConditions())}validate(){let isValid=!1;for(const condition of this.getConditions())if(condition.validate()){isValid=!0;break}this.updateDisabled(!isValid)}getIsDisabled(){return this.isDisabled}getConditions(){return this.conditions}addValueChangeListener(field){this.fieldsObject[field.getName()]=field}checkConditions(){for(const fieldName in this.fieldsObject)this.fieldsObject[fieldName].getConditionsHandler().validate()}};__name(_GoogleMapConditionsHandler,"GoogleMapConditionsHandler");let GoogleMapConditionsHandler=_GoogleMapConditionsHandler;const _GoogleMapConditionValidator=class _GoogleMapConditionValidator{parent=null;init(parent){this.parent=parent}validate(condition){const value=!!this.parent?.getOpenstreetmap().hasPlaceData();switch(condition.operator){case"==":case"=":case"===":case"!=empty":case"==contains":return value===!0;case"!=":case"!==":case"==empty":case"!=contains":return value===!1;default:return console.error("Invalid operator:",condition.operator),!1}}};__name(_GoogleMapConditionValidator,"GoogleMapConditionValidator");let GoogleMapConditionValidator=_GoogleMapConditionValidator;const _GoogleMapValueLoader=class _GoogleMapValueLoader{parent;init(parent){this.parent=parent}load(value){if(this.isNotAValidPlaceObject(value)){console.error("Invalid place object provided to GoogleMapValueLoader:",value);return}this.parent.getOpenstreetmap().addOrMoveMarker({lat:value.latitude,lng:value.longitude},value),this.parent.getOpenstreetmap().getMap().setView({lat:value.latitude,lng:value.longitude},14)}isNotAValidPlaceObject(value){return typeof value!="object"||!value.address||!value.latitude||!value.longitude||!value.name}};__name(_GoogleMapValueLoader,"GoogleMapValueLoader");let GoogleMapValueLoader=_GoogleMapValueLoader;const _GoogleMap=class _GoogleMap{constructor(field,hiddenField,openstreetmapInstance,name,googleMapValidator,conditionsHandler,validator,loader=new GoogleMapValueLoader){this.field=field,this.hiddenField=hiddenField,this.openstreetmapInstance=openstreetmapInstance,this.name=name,this.googleMapValidator=googleMapValidator,this.conditionsHandler=conditionsHandler,this.validator=validator,this.loader=loader}required=!1;init(conditionBuilder){this.required=this.getFieldContainer().hasAttribute("data-js-required"),this.conditionsHandler.init(this,conditionBuilder),this.googleMapValidator.init(this),this.openstreetmapInstance.init(),this.validator.init(this),this.loader.init(this),this.listenForMarkerEvents()}getName(){return this.name}getConditionsHandler(){return this.conditionsHandler}getConditionValidator(){return this.googleMapValidator}getValidator(){return this.validator}getOpenstreetmap(){return this.openstreetmapInstance}getFieldContainer(){return this.field}isRequired(){return this.required}hasValue(){return this.getHiddenField().value.length>0}getHiddenField(){return this.hiddenField}getValueLoader(){return this.loader}listenForMarkerEvents(){this.openstreetmapInstance.addMarkerMovedListener(placeObject=>{this.hiddenField.value=placeObject?JSON.stringify(placeObject):"",this.conditionsHandler.checkConditions(),this.validator.validate()})}};__name(_GoogleMap,"GoogleMap");let GoogleMap=_GoogleMap;var dist={},types={},hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0})),types}__name(requireTypes,"requireTypes");var eventListenerInterface={},hasRequiredEventListenerInterface;function requireEventListenerInterface(){return hasRequiredEventListenerInterface||(hasRequiredEventListenerInterface=1,Object.defineProperty(eventListenerInterface,"__esModule",{value:!0})),eventListenerInterface}__name(requireEventListenerInterface,"requireEventListenerInterface");var addableInterface={},hasRequiredAddableInterface;function requireAddableInterface(){return hasRequiredAddableInterface||(hasRequiredAddableInterface=1,Object.defineProperty(addableInterface,"__esModule",{value:!0})),addableInterface}__name(requireAddableInterface,"requireAddableInterface");var addToInterface={},hasRequiredAddToInterface;function requireAddToInterface(){return hasRequiredAddToInterface||(hasRequiredAddToInterface=1,Object.defineProperty(addToInterface,"__esModule",{value:!0})),addToInterface}__name(requireAddToInterface,"requireAddToInterface");var TilesHelper={},hasRequiredTilesHelper;function requireTilesHelper(){var _a2;if(hasRequiredTilesHelper)return TilesHelper;hasRequiredTilesHelper=1,Object.defineProperty(TilesHelper,"__esModule",{value:!0}),TilesHelper.TilesHelper=void 0;let TilesHelper$1=(_a2=class{getDefaultTiles(style){switch(style){case"dark":return{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png"};case"pale":return{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png"};case"color":return{attribution:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"};default:return{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png"}}}},__name(_a2,"TilesHelper"),_a2);return TilesHelper.TilesHelper=TilesHelper$1,TilesHelper}__name(requireTilesHelper,"requireTilesHelper");var TilesHelperInterface={},hasRequiredTilesHelperInterface;function requireTilesHelperInterface(){return hasRequiredTilesHelperInterface||(hasRequiredTilesHelperInterface=1,Object.defineProperty(TilesHelperInterface,"__esModule",{value:!0})),TilesHelperInterface}__name(requireTilesHelperInterface,"requireTilesHelperInterface");var createMap={},leafletSrc$1={exports:{}};var leafletSrc=leafletSrc$1.exports,hasRequiredLeafletSrc;function requireLeafletSrc(){return hasRequiredLeafletSrc||(hasRequiredLeafletSrc=1,(function(module,exports$1){(function(global,factory){factory(exports$1)})(leafletSrc,(function(exports$12){var version="1.9.4";function extend(dest){var i,j,len,src;for(j=1,len=arguments.length;j<len;j++){src=arguments[j];for(i in src)dest[i]=src[i]}return dest}__name(extend,"extend");var create$2=Object.create||(function(){function F(){}return __name(F,"F"),function(proto){return F.prototype=proto,new F}})();function bind(fn,obj){var slice=Array.prototype.slice;if(fn.bind)return fn.bind.apply(fn,slice.call(arguments,1));var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.length?args.concat(slice.call(arguments)):arguments)}}__name(bind,"bind");var lastId=0;function stamp(obj){return"_leaflet_id"in obj||(obj._leaflet_id=++lastId),obj._leaflet_id}__name(stamp,"stamp");function throttle(fn,time,context){var lock,args,wrapperFn,later;return later=__name(function(){lock=!1,args&&(wrapperFn.apply(context,args),args=!1)},"later"),wrapperFn=__name(function(){lock?args=arguments:(fn.apply(context,arguments),setTimeout(later,time),lock=!0)},"wrapperFn"),wrapperFn}__name(throttle,"throttle");function wrapNum(x,range,includeMax){var max=range[1],min=range[0],d=max-min;return x===max&&includeMax?x:((x-min)%d+d)%d+min}__name(wrapNum,"wrapNum");function falseFn(){return!1}__name(falseFn,"falseFn");function formatNum(num,precision){if(precision===!1)return num;var pow=Math.pow(10,precision===void 0?6:precision);return Math.round(num*pow)/pow}__name(formatNum,"formatNum");function trim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}__name(trim,"trim");function splitWords(str){return trim(str).split(/\s+/)}__name(splitWords,"splitWords");function setOptions(obj,options){Object.prototype.hasOwnProperty.call(obj,"options")||(obj.options=obj.options?create$2(obj.options):{});for(var i in options)obj.options[i]=options[i];return obj.options}__name(setOptions,"setOptions");function getParamString(obj,existingUrl,uppercase){var params=[];for(var i in obj)params.push(encodeURIComponent(uppercase?i.toUpperCase():i)+"="+encodeURIComponent(obj[i]));return(!existingUrl||existingUrl.indexOf("?")===-1?"?":"&")+params.join("&")}__name(getParamString,"getParamString");var templateRe=/\{ *([\w_ -]+) *\}/g;function template(str,data){return str.replace(templateRe,function(str2,key){var value=data[key];if(value===void 0)throw new Error("No value provided for variable "+str2);return typeof value=="function"&&(value=value(data)),value})}__name(template,"template");var isArray=Array.isArray||function(obj){return Object.prototype.toString.call(obj)==="[object Array]"};function indexOf(array,el){for(var i=0;i<array.length;i++)if(array[i]===el)return i;return-1}__name(indexOf,"indexOf");var emptyImageUrl="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function getPrefixed(name){return window["webkit"+name]||window["moz"+name]||window["ms"+name]}__name(getPrefixed,"getPrefixed");var lastTime=0;function timeoutDefer(fn){var time=+new Date,timeToCall=Math.max(0,16-(time-lastTime));return lastTime=time+timeToCall,window.setTimeout(fn,timeToCall)}__name(timeoutDefer,"timeoutDefer");var requestFn=window.requestAnimationFrame||getPrefixed("RequestAnimationFrame")||timeoutDefer,cancelFn=window.cancelAnimationFrame||getPrefixed("CancelAnimationFrame")||getPrefixed("CancelRequestAnimationFrame")||function(id){window.clearTimeout(id)};function requestAnimFrame(fn,context,immediate){if(immediate&&requestFn===timeoutDefer)fn.call(context);else return requestFn.call(window,bind(fn,context))}__name(requestAnimFrame,"requestAnimFrame");function cancelAnimFrame(id){id&&cancelFn.call(window,id)}__name(cancelAnimFrame,"cancelAnimFrame");var Util={__proto__:null,extend,create:create$2,bind,get lastId(){return lastId},stamp,throttle,wrapNum,falseFn,formatNum,trim,splitWords,setOptions,getParamString,template,isArray,indexOf,emptyImageUrl,requestFn,cancelFn,requestAnimFrame,cancelAnimFrame};function Class(){}__name(Class,"Class"),Class.extend=function(props){var NewClass=__name(function(){setOptions(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},"NewClass"),parentProto=NewClass.__super__=this.prototype,proto=create$2(parentProto);proto.constructor=NewClass,NewClass.prototype=proto;for(var i in this)Object.prototype.hasOwnProperty.call(this,i)&&i!=="prototype"&&i!=="__super__"&&(NewClass[i]=this[i]);return props.statics&&extend(NewClass,props.statics),props.includes&&(checkDeprecatedMixinEvents(props.includes),extend.apply(null,[proto].concat(props.includes))),extend(proto,props),delete proto.statics,delete proto.includes,proto.options&&(proto.options=parentProto.options?create$2(parentProto.options):{},extend(proto.options,props.options)),proto._initHooks=[],proto.callInitHooks=function(){if(!this._initHooksCalled){parentProto.callInitHooks&&parentProto.callInitHooks.call(this),this._initHooksCalled=!0;for(var i2=0,len=proto._initHooks.length;i2<len;i2++)proto._initHooks[i2].call(this)}},NewClass},Class.include=function(props){var parentOptions=this.prototype.options;return extend(this.prototype,props),props.options&&(this.prototype.options=parentOptions,this.mergeOptions(props.options)),this},Class.mergeOptions=function(options){return extend(this.prototype.options,options),this},Class.addInitHook=function(fn){var args=Array.prototype.slice.call(arguments,1),init=typeof fn=="function"?fn:function(){this[fn].apply(this,args)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(init),this};function checkDeprecatedMixinEvents(includes){if(!(typeof L>"u"||!L||!L.Mixin)){includes=isArray(includes)?includes:[includes];for(var i=0;i<includes.length;i++)includes[i]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}__name(checkDeprecatedMixinEvents,"checkDeprecatedMixinEvents");var Events={on:__name(function(types2,fn,context){if(typeof types2=="object")for(var type in types2)this._on(type,types2[type],fn);else{types2=splitWords(types2);for(var i=0,len=types2.length;i<len;i++)this._on(types2[i],fn,context)}return this},"on"),off:__name(function(types2,fn,context){if(!arguments.length)delete this._events;else if(typeof types2=="object")for(var type in types2)this._off(type,types2[type],fn);else{types2=splitWords(types2);for(var removeAll=arguments.length===1,i=0,len=types2.length;i<len;i++)removeAll?this._off(types2[i]):this._off(types2[i],fn,context)}return this},"off"),_on:__name(function(type,fn,context,_once){if(typeof fn!="function"){console.warn("wrong listener type: "+typeof fn);return}if(this._listens(type,fn,context)===!1){context===this&&(context=void 0);var newListener={fn,ctx:context};_once&&(newListener.once=!0),this._events=this._events||{},this._events[type]=this._events[type]||[],this._events[type].push(newListener)}},"_on"),_off:__name(function(type,fn,context){var listeners,i,len;if(this._events&&(listeners=this._events[type],!!listeners)){if(arguments.length===1){if(this._firingCount)for(i=0,len=listeners.length;i<len;i++)listeners[i].fn=falseFn;delete this._events[type];return}if(typeof fn!="function"){console.warn("wrong listener type: "+typeof fn);return}var index2=this._listens(type,fn,context);if(index2!==!1){var listener=listeners[index2];this._firingCount&&(listener.fn=falseFn,this._events[type]=listeners=listeners.slice()),listeners.splice(index2,1)}}},"_off"),fire:__name(function(type,data,propagate){if(!this.listens(type,propagate))return this;var event=extend({},data,{type,target:this,sourceTarget:data&&data.sourceTarget||this});if(this._events){var listeners=this._events[type];if(listeners){this._firingCount=this._firingCount+1||1;for(var i=0,len=listeners.length;i<len;i++){var l=listeners[i],fn=l.fn;l.once&&this.off(type,fn,l.ctx),fn.call(l.ctx||this,event)}this._firingCount--}}return propagate&&this._propagateEvent(event),this},"fire"),listens:__name(function(type,fn,context,propagate){typeof type!="string"&&console.warn('"string" type argument expected');var _fn=fn;typeof fn!="function"&&(propagate=!!fn,_fn=void 0,context=void 0);var listeners=this._events&&this._events[type];if(listeners&&listeners.length&&this._listens(type,_fn,context)!==!1)return!0;if(propagate){for(var id in this._eventParents)if(this._eventParents[id].listens(type,fn,context,propagate))return!0}return!1},"listens"),_listens:__name(function(type,fn,context){if(!this._events)return!1;var listeners=this._events[type]||[];if(!fn)return!!listeners.length;context===this&&(context=void 0);for(var i=0,len=listeners.length;i<len;i++)if(listeners[i].fn===fn&&listeners[i].ctx===context)return i;return!1},"_listens"),once:__name(function(types2,fn,context){if(typeof types2=="object")for(var type in types2)this._on(type,types2[type],fn,!0);else{types2=splitWords(types2);for(var i=0,len=types2.length;i<len;i++)this._on(types2[i],fn,context,!0)}return this},"once"),addEventParent:__name(function(obj){return this._eventParents=this._eventParents||{},this._eventParents[stamp(obj)]=obj,this},"addEventParent"),removeEventParent:__name(function(obj){return this._eventParents&&delete this._eventParents[stamp(obj)],this},"removeEventParent"),_propagateEvent:__name(function(e){for(var id in this._eventParents)this._eventParents[id].fire(e.type,extend({layer:e.target,propagatedFrom:e.target},e),!0)},"_propagateEvent")};Events.addEventListener=Events.on,Events.removeEventListener=Events.clearAllEventListeners=Events.off,Events.addOneTimeEventListener=Events.once,Events.fireEvent=Events.fire,Events.hasEventListeners=Events.listens;var Evented=Class.extend(Events);function Point(x,y,round){this.x=round?Math.round(x):x,this.y=round?Math.round(y):y}__name(Point,"Point");var trunc=Math.trunc||function(v){return v>0?Math.floor(v):Math.ceil(v)};Point.prototype={clone:__name(function(){return new Point(this.x,this.y)},"clone"),add:__name(function(point){return this.clone()._add(toPoint(point))},"add"),_add:__name(function(point){return this.x+=point.x,this.y+=point.y,this},"_add"),subtract:__name(function(point){return this.clone()._subtract(toPoint(point))},"subtract"),_subtract:__name(function(point){return this.x-=point.x,this.y-=point.y,this},"_subtract"),divideBy:__name(function(num){return this.clone()._divideBy(num)},"divideBy"),_divideBy:__name(function(num){return this.x/=num,this.y/=num,this},"_divideBy"),multiplyBy:__name(function(num){return this.clone()._multiplyBy(num)},"multiplyBy"),_multiplyBy:__name(function(num){return this.x*=num,this.y*=num,this},"_multiplyBy"),scaleBy:__name(function(point){return new Point(this.x*point.x,this.y*point.y)},"scaleBy"),unscaleBy:__name(function(point){return new Point(this.x/point.x,this.y/point.y)},"unscaleBy"),round:__name(function(){return this.clone()._round()},"round"),_round:__name(function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},"_round"),floor:__name(function(){return this.clone()._floor()},"floor"),_floor:__name(function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},"_floor"),ceil:__name(function(){return this.clone()._ceil()},"ceil"),_ceil:__name(function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},"_ceil"),trunc:__name(function(){return this.clone()._trunc()},"trunc"),_trunc:__name(function(){return this.x=trunc(this.x),this.y=trunc(this.y),this},"_trunc"),distanceTo:__name(function(point){point=toPoint(point);var x=point.x-this.x,y=point.y-this.y;return Math.sqrt(x*x+y*y)},"distanceTo"),equals:__name(function(point){return point=toPoint(point),point.x===this.x&&point.y===this.y},"equals"),contains:__name(function(point){return point=toPoint(point),Math.abs(point.x)<=Math.abs(this.x)&&Math.abs(point.y)<=Math.abs(this.y)},"contains"),toString:__name(function(){return"Point("+formatNum(this.x)+", "+formatNum(this.y)+")"},"toString")};function toPoint(x,y,round){return x instanceof Point?x:isArray(x)?new Point(x[0],x[1]):x==null?x:typeof x=="object"&&"x"in x&&"y"in x?new Point(x.x,x.y):new Point(x,y,round)}__name(toPoint,"toPoint");function Bounds(a,b){if(a)for(var points=b?[a,b]:a,i=0,len=points.length;i<len;i++)this.extend(points[i])}__name(Bounds,"Bounds"),Bounds.prototype={extend:__name(function(obj){var min2,max2;if(!obj)return this;if(obj instanceof Point||typeof obj[0]=="number"||"x"in obj)min2=max2=toPoint(obj);else if(obj=toBounds(obj),min2=obj.min,max2=obj.max,!min2||!max2)return this;return!this.min&&!this.max?(this.min=min2.clone(),this.max=max2.clone()):(this.min.x=Math.min(min2.x,this.min.x),this.max.x=Math.max(max2.x,this.max.x),this.min.y=Math.min(min2.y,this.min.y),this.max.y=Math.max(max2.y,this.max.y)),this},"extend"),getCenter:__name(function(round){return toPoint((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,round)},"getCenter"),getBottomLeft:__name(function(){return toPoint(this.min.x,this.max.y)},"getBottomLeft"),getTopRight:__name(function(){return toPoint(this.max.x,this.min.y)},"getTopRight"),getTopLeft:__name(function(){return this.min},"getTopLeft"),getBottomRight:__name(function(){return this.max},"getBottomRight"),getSize:__name(function(){return this.max.subtract(this.min)},"getSize"),contains:__name(function(obj){var min,max;return typeof obj[0]=="number"||obj instanceof Point?obj=toPoint(obj):obj=toBounds(obj),obj instanceof Bounds?(min=obj.min,max=obj.max):min=max=obj,min.x>=this.min.x&&max.x<=this.max.x&&min.y>=this.min.y&&max.y<=this.max.y},"contains"),intersects:__name(function(bounds){bounds=toBounds(bounds);var min=this.min,max=this.max,min2=bounds.min,max2=bounds.max,xIntersects=max2.x>=min.x&&min2.x<=max.x,yIntersects=max2.y>=min.y&&min2.y<=max.y;return xIntersects&&yIntersects},"intersects"),overlaps:__name(function(bounds){bounds=toBounds(bounds);var min=this.min,max=this.max,min2=bounds.min,max2=bounds.max,xOverlaps=max2.x>min.x&&min2.x<max.x,yOverlaps=max2.y>min.y&&min2.y<max.y;return xOverlaps&&yOverlaps},"overlaps"),isValid:__name(function(){return!!(this.min&&this.max)},"isValid"),pad:__name(function(bufferRatio){var min=this.min,max=this.max,heightBuffer=Math.abs(min.x-max.x)*bufferRatio,widthBuffer=Math.abs(min.y-max.y)*bufferRatio;return toBounds(toPoint(min.x-heightBuffer,min.y-widthBuffer),toPoint(max.x+heightBuffer,max.y+widthBuffer))},"pad"),equals:__name(function(bounds){return bounds?(bounds=toBounds(bounds),this.min.equals(bounds.getTopLeft())&&this.max.equals(bounds.getBottomRight())):!1},"equals")};function toBounds(a,b){return!a||a instanceof Bounds?a:new Bounds(a,b)}__name(toBounds,"toBounds");function LatLngBounds(corner1,corner2){if(corner1)for(var latlngs=corner2?[corner1,corner2]:corner1,i=0,len=latlngs.length;i<len;i++)this.extend(latlngs[i])}__name(LatLngBounds,"LatLngBounds"),LatLngBounds.prototype={extend:__name(function(obj){var sw=this._southWest,ne=this._northEast,sw2,ne2;if(obj instanceof LatLng)sw2=obj,ne2=obj;else if(obj instanceof LatLngBounds){if(sw2=obj._southWest,ne2=obj._northEast,!sw2||!ne2)return this}else return obj?this.extend(toLatLng(obj)||toLatLngBounds(obj)):this;return!sw&&!ne?(this._southWest=new LatLng(sw2.lat,sw2.lng),this._northEast=new LatLng(ne2.lat,ne2.lng)):(sw.lat=Math.min(sw2.lat,sw.lat),sw.lng=Math.min(sw2.lng,sw.lng),ne.lat=Math.max(ne2.lat,ne.lat),ne.lng=Math.max(ne2.lng,ne.lng)),this},"extend"),pad:__name(function(bufferRatio){var sw=this._southWest,ne=this._northEast,heightBuffer=Math.abs(sw.lat-ne.lat)*bufferRatio,widthBuffer=Math.abs(sw.lng-ne.lng)*bufferRatio;return new LatLngBounds(new LatLng(sw.lat-heightBuffer,sw.lng-widthBuffer),new LatLng(ne.lat+heightBuffer,ne.lng+widthBuffer))},"pad"),getCenter:__name(function(){return new LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},"getCenter"),getSouthWest:__name(function(){return this._southWest},"getSouthWest"),getNorthEast:__name(function(){return this._northEast},"getNorthEast"),getNorthWest:__name(function(){return new LatLng(this.getNorth(),this.getWest())},"getNorthWest"),getSouthEast:__name(function(){return new LatLng(this.getSouth(),this.getEast())},"getSouthEast"),getWest:__name(function(){return this._southWest.lng},"getWest"),getSouth:__name(function(){return this._southWest.lat},"getSouth"),getEast:__name(function(){return this._northEast.lng},"getEast"),getNorth:__name(function(){return this._northEast.lat},"getNorth"),contains:__name(function(obj){typeof obj[0]=="number"||obj instanceof LatLng||"lat"in obj?obj=toLatLng(obj):obj=toLatLngBounds(obj);var sw=this._southWest,ne=this._northEast,sw2,ne2;return obj instanceof LatLngBounds?(sw2=obj.getSouthWest(),ne2=obj.getNorthEast()):sw2=ne2=obj,sw2.lat>=sw.lat&&ne2.lat<=ne.lat&&sw2.lng>=sw.lng&&ne2.lng<=ne.lng},"contains"),intersects:__name(function(bounds){bounds=toLatLngBounds(bounds);var sw=this._southWest,ne=this._northEast,sw2=bounds.getSouthWest(),ne2=bounds.getNorthEast(),latIntersects=ne2.lat>=sw.lat&&sw2.lat<=ne.lat,lngIntersects=ne2.lng>=sw.lng&&sw2.lng<=ne.lng;return latIntersects&&lngIntersects},"intersects"),overlaps:__name(function(bounds){bounds=toLatLngBounds(bounds);var sw=this._southWest,ne=this._northEast,sw2=bounds.getSouthWest(),ne2=bounds.getNorthEast(),latOverlaps=ne2.lat>sw.lat&&sw2.lat<ne.lat,lngOverlaps=ne2.lng>sw.lng&&sw2.lng<ne.lng;return latOverlaps&&lngOverlaps},"overlaps"),toBBoxString:__name(function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},"toBBoxString"),equals:__name(function(bounds,maxMargin){return bounds?(bounds=toLatLngBounds(bounds),this._southWest.equals(bounds.getSouthWest(),maxMargin)&&this._northEast.equals(bounds.getNorthEast(),maxMargin)):!1},"equals"),isValid:__name(function(){return!!(this._southWest&&this._northEast)},"isValid")};function toLatLngBounds(a,b){return a instanceof LatLngBounds?a:new LatLngBounds(a,b)}__name(toLatLngBounds,"toLatLngBounds");function LatLng(lat,lng,alt){if(isNaN(lat)||isNaN(lng))throw new Error("Invalid LatLng object: ("+lat+", "+lng+")");this.lat=+lat,this.lng=+lng,alt!==void 0&&(this.alt=+alt)}__name(LatLng,"LatLng"),LatLng.prototype={equals:__name(function(obj,maxMargin){if(!obj)return!1;obj=toLatLng(obj);var margin=Math.max(Math.abs(this.lat-obj.lat),Math.abs(this.lng-obj.lng));return margin<=(maxMargin===void 0?1e-9:maxMargin)},"equals"),toString:__name(function(precision){return"LatLng("+formatNum(this.lat,precision)+", "+formatNum(this.lng,precision)+")"},"toString"),distanceTo:__name(function(other){return Earth.distance(this,toLatLng(other))},"distanceTo"),wrap:__name(function(){return Earth.wrapLatLng(this)},"wrap"),toBounds:__name(function(sizeInMeters){var latAccuracy=180*sizeInMeters/40075017,lngAccuracy=latAccuracy/Math.cos(Math.PI/180*this.lat);return toLatLngBounds([this.lat-latAccuracy,this.lng-lngAccuracy],[this.lat+latAccuracy,this.lng+lngAccuracy])},"toBounds"),clone:__name(function(){return new LatLng(this.lat,this.lng,this.alt)},"clone")};function toLatLng(a,b,c){return a instanceof LatLng?a:isArray(a)&&typeof a[0]!="object"?a.length===3?new LatLng(a[0],a[1],a[2]):a.length===2?new LatLng(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new LatLng(a.lat,"lng"in a?a.lng:a.lon,a.alt):b===void 0?null:new LatLng(a,b,c)}__name(toLatLng,"toLatLng");var CRS={latLngToPoint:__name(function(latlng,zoom2){var projectedPoint=this.projection.project(latlng),scale2=this.scale(zoom2);return this.transformation._transform(projectedPoint,scale2)},"latLngToPoint"),pointToLatLng:__name(function(point,zoom2){var scale2=this.scale(zoom2),untransformedPoint=this.transformation.untransform(point,scale2);return this.projection.unproject(untransformedPoint)},"pointToLatLng"),project:__name(function(latlng){return this.projection.project(latlng)},"project"),unproject:__name(function(point){return this.projection.unproject(point)},"unproject"),scale:__name(function(zoom2){return 256*Math.pow(2,zoom2)},"scale"),zoom:__name(function(scale2){return Math.log(scale2/256)/Math.LN2},"zoom"),getProjectedBounds:__name(function(zoom2){if(this.infinite)return null;var b=this.projection.bounds,s=this.scale(zoom2),min=this.transformation.transform(b.min,s),max=this.transformation.transform(b.max,s);return new Bounds(min,max)},"getProjectedBounds"),infinite:!1,wrapLatLng:__name(function(latlng){var lng=this.wrapLng?wrapNum(latlng.lng,this.wrapLng,!0):latlng.lng,lat=this.wrapLat?wrapNum(latlng.lat,this.wrapLat,!0):latlng.lat,alt=latlng.alt;return new LatLng(lat,lng,alt)},"wrapLatLng"),wrapLatLngBounds:__name(function(bounds){var center=bounds.getCenter(),newCenter=this.wrapLatLng(center),latShift=center.lat-newCenter.lat,lngShift=center.lng-newCenter.lng;if(latShift===0&&lngShift===0)return bounds;var sw=bounds.getSouthWest(),ne=bounds.getNorthEast(),newSw=new LatLng(sw.lat-latShift,sw.lng-lngShift),newNe=new LatLng(ne.lat-latShift,ne.lng-lngShift);return new LatLngBounds(newSw,newNe)},"wrapLatLngBounds")},Earth=extend({},CRS,{wrapLng:[-180,180],R:6371e3,distance:__name(function(latlng1,latlng2){var rad=Math.PI/180,lat1=latlng1.lat*rad,lat2=latlng2.lat*rad,sinDLat=Math.sin((latlng2.lat-latlng1.lat)*rad/2),sinDLon=Math.sin((latlng2.lng-latlng1.lng)*rad/2),a=sinDLat*sinDLat+Math.cos(lat1)*Math.cos(lat2)*sinDLon*sinDLon,c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*c},"distance")}),earthRadius=6378137,SphericalMercator={R:earthRadius,MAX_LATITUDE:85.0511287798,project:__name(function(latlng){var d=Math.PI/180,max=this.MAX_LATITUDE,lat=Math.max(Math.min(max,latlng.lat),-max),sin=Math.sin(lat*d);return new Point(this.R*latlng.lng*d,this.R*Math.log((1+sin)/(1-sin))/2)},"project"),unproject:__name(function(point){var d=180/Math.PI;return new LatLng((2*Math.atan(Math.exp(point.y/this.R))-Math.PI/2)*d,point.x*d/this.R)},"unproject"),bounds:(function(){var d=earthRadius*Math.PI;return new Bounds([-d,-d],[d,d])})()};function Transformation(a,b,c,d){if(isArray(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=b,this._c=c,this._d=d}__name(Transformation,"Transformation"),Transformation.prototype={transform:__name(function(point,scale2){return this._transform(point.clone(),scale2)},"transform"),_transform:__name(function(point,scale2){return scale2=scale2||1,point.x=scale2*(this._a*point.x+this._b),point.y=scale2*(this._c*point.y+this._d),point},"_transform"),untransform:__name(function(point,scale2){return scale2=scale2||1,new Point((point.x/scale2-this._b)/this._a,(point.y/scale2-this._d)/this._c)},"untransform")};function toTransformation(a,b,c,d){return new Transformation(a,b,c,d)}__name(toTransformation,"toTransformation");var EPSG3857=extend({},Earth,{code:"EPSG:3857",projection:SphericalMercator,transformation:(function(){var scale2=.5/(Math.PI*SphericalMercator.R);return toTransformation(scale2,.5,-scale2,.5)})()}),EPSG900913=extend({},EPSG3857,{code:"EPSG:900913"});function svgCreate(name){return document.createElementNS("http://www.w3.org/2000/svg",name)}__name(svgCreate,"svgCreate");function pointsToPath(rings,closed){var str="",i,j,len,len2,points,p;for(i=0,len=rings.length;i<len;i++){for(points=rings[i],j=0,len2=points.length;j<len2;j++)p=points[j],str+=(j?"L":"M")+p.x+" "+p.y;str+=closed?Browser.svg?"z":"x":""}return str||"M0 0"}__name(pointsToPath,"pointsToPath");var style=document.documentElement.style,ie="ActiveXObject"in window,ielt9=ie&&!document.addEventListener,edge="msLaunchUri"in navigator&&!("documentMode"in document),webkit=userAgentContains("webkit"),android=userAgentContains("android"),android23=userAgentContains("android 2")||userAgentContains("android 3"),webkitVer=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),androidStock=android&&userAgentContains("Google")&&webkitVer<537&&!("AudioNode"in window),opera=!!window.opera,chrome=!edge&&userAgentContains("chrome"),gecko=userAgentContains("gecko")&&!webkit&&!opera&&!ie,safari=!chrome&&userAgentContains("safari"),phantom=userAgentContains("phantom"),opera12="OTransition"in style,win=navigator.platform.indexOf("Win")===0,ie3d=ie&&"transition"in style,webkit3d="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!android23,gecko3d="MozPerspective"in style,any3d=!window.L_DISABLE_3D&&(ie3d||webkit3d||gecko3d)&&!opera12&&!phantom,mobile=typeof orientation<"u"||userAgentContains("mobile"),mobileWebkit=mobile&&webkit,mobileWebkit3d=mobile&&webkit3d,msPointer=!window.PointerEvent&&window.MSPointerEvent,pointer=!!(window.PointerEvent||msPointer),touchNative="ontouchstart"in window||!!window.TouchEvent,touch=!window.L_NO_TOUCH&&(touchNative||pointer),mobileOpera=mobile&&opera,mobileGecko=mobile&&gecko,retina=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,passiveEvents=(function(){var supportsPassiveOption=!1;try{var opts=Object.defineProperty({},"passive",{get:__name(function(){supportsPassiveOption=!0},"get")});window.addEventListener("testPassiveEventSupport",falseFn,opts),window.removeEventListener("testPassiveEventSupport",falseFn,opts)}catch{}return supportsPassiveOption})(),canvas$1=(function(){return!!document.createElement("canvas").getContext})(),svg$1=!!(document.createElementNS&&svgCreate("svg").createSVGRect),inlineSvg=!!svg$1&&(function(){var div=document.createElement("div");return div.innerHTML="<svg/>",(div.firstChild&&div.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),vml=!svg$1&&(function(){try{var div=document.createElement("div");div.innerHTML='<v:shape adj="1"/>';var shape=div.firstChild;return shape.style.behavior="url(#default#VML)",shape&&typeof shape.adj=="object"}catch{return!1}})(),mac=navigator.platform.indexOf("Mac")===0,linux=navigator.platform.indexOf("Linux")===0;function userAgentContains(str){return navigator.userAgent.toLowerCase().indexOf(str)>=0}__name(userAgentContains,"userAgentContains");var Browser={ie,ielt9,edge,webkit,android,android23,androidStock,opera,chrome,gecko,safari,phantom,opera12,win,ie3d,webkit3d,gecko3d,any3d,mobile,mobileWebkit,mobileWebkit3d,msPointer,pointer,touch,touchNative,mobileOpera,mobileGecko,retina,passiveEvents,canvas:canvas$1,svg:svg$1,vml,inlineSvg,mac,linux},POINTER_DOWN=Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE=Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP=Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL=Browser.msPointer?"MSPointerCancel":"pointercancel",pEvent={touchstart:POINTER_DOWN,touchmove:POINTER_MOVE,touchend:POINTER_UP,touchcancel:POINTER_CANCEL},handle={touchstart:_onPointerStart,touchmove:_handlePointer,touchend:_handlePointer,touchcancel:_handlePointer},_pointers={},_pointerDocListener=!1;function addPointerListener(obj,type,handler){return type==="touchstart"&&_addPointerDocListener(),handle[type]?(handler=handle[type].bind(this,handler),obj.addEventListener(pEvent[type],handler,!1),handler):(console.warn("wrong event specified:",type),falseFn)}__name(addPointerListener,"addPointerListener");function removePointerListener(obj,type,handler){if(!pEvent[type]){console.warn("wrong event specified:",type);return}obj.removeEventListener(pEvent[type],handler,!1)}__name(removePointerListener,"removePointerListener");function _globalPointerDown(e){_pointers[e.pointerId]=e}__name(_globalPointerDown,"_globalPointerDown");function _globalPointerMove(e){_pointers[e.pointerId]&&(_pointers[e.pointerId]=e)}__name(_globalPointerMove,"_globalPointerMove");function _globalPointerUp(e){delete _pointers[e.pointerId]}__name(_globalPointerUp,"_globalPointerUp");function _addPointerDocListener(){_pointerDocListener||(document.addEventListener(POINTER_DOWN,_globalPointerDown,!0),document.addEventListener(POINTER_MOVE,_globalPointerMove,!0),document.addEventListener(POINTER_UP,_globalPointerUp,!0),document.addEventListener(POINTER_CANCEL,_globalPointerUp,!0),_pointerDocListener=!0)}__name(_addPointerDocListener,"_addPointerDocListener");function _handlePointer(handler,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){e.touches=[];for(var i in _pointers)e.touches.push(_pointers[i]);e.changedTouches=[e],handler(e)}}__name(_handlePointer,"_handlePointer");function _onPointerStart(handler,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&preventDefault(e),_handlePointer(handler,e)}__name(_onPointerStart,"_onPointerStart");function makeDblclick(event){var newEvent={},prop,i;for(i in event)prop=event[i],newEvent[i]=prop&&prop.bind?prop.bind(event):prop;return event=newEvent,newEvent.type="dblclick",newEvent.detail=2,newEvent.isTrusted=!1,newEvent._simulated=!0,newEvent}__name(makeDblclick,"makeDblclick");var delay=200;function addDoubleTapListener(obj,handler){obj.addEventListener("dblclick",handler);var last=0,detail;function simDblclick(e){if(e.detail!==1){detail=e.detail;return}if(!(e.pointerType==="mouse"||e.sourceCapabilities&&!e.sourceCapabilities.firesTouchEvents)){var path=getPropagationPath(e);if(!(path.some(function(el){return el instanceof HTMLLabelElement&&el.attributes.for})&&!path.some(function(el){return el instanceof HTMLInputElement||el instanceof HTMLSelectElement}))){var now=Date.now();now-last<=delay?(detail++,detail===2&&handler(makeDblclick(e))):detail=1,last=now}}}return __name(simDblclick,"simDblclick"),obj.addEventListener("click",simDblclick),{dblclick:handler,simDblclick}}__name(addDoubleTapListener,"addDoubleTapListener");function removeDoubleTapListener(obj,handlers){obj.removeEventListener("dblclick",handlers.dblclick),obj.removeEventListener("click",handlers.simDblclick)}__name(removeDoubleTapListener,"removeDoubleTapListener");var TRANSFORM=testProp(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),TRANSITION=testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),TRANSITION_END=TRANSITION==="webkitTransition"||TRANSITION==="OTransition"?TRANSITION+"End":"transitionend";function get(id){return typeof id=="string"?document.getElementById(id):id}__name(get,"get");function getStyle(el,style2){var value=el.style[style2]||el.currentStyle&&el.currentStyle[style2];if((!value||value==="auto")&&document.defaultView){var css=document.defaultView.getComputedStyle(el,null);value=css?css[style2]:null}return value==="auto"?null:value}__name(getStyle,"getStyle");function create$1(tagName,className,container){var el=document.createElement(tagName);return el.className=className||"",container&&container.appendChild(el),el}__name(create$1,"create$1");function remove(el){var parent=el.parentNode;parent&&parent.removeChild(el)}__name(remove,"remove");function empty(el){for(;el.firstChild;)el.removeChild(el.firstChild)}__name(empty,"empty");function toFront(el){var parent=el.parentNode;parent&&parent.lastChild!==el&&parent.appendChild(el)}__name(toFront,"toFront");function toBack(el){var parent=el.parentNode;parent&&parent.firstChild!==el&&parent.insertBefore(el,parent.firstChild)}__name(toBack,"toBack");function hasClass(el,name){if(el.classList!==void 0)return el.classList.contains(name);var className=getClass(el);return className.length>0&&new RegExp("(^|\\s)"+name+"(\\s|$)").test(className)}__name(hasClass,"hasClass");function addClass(el,name){if(el.classList!==void 0)for(var classes=splitWords(name),i=0,len=classes.length;i<len;i++)el.classList.add(classes[i]);else if(!hasClass(el,name)){var className=getClass(el);setClass(el,(className?className+" ":"")+name)}}__name(addClass,"addClass");function removeClass(el,name){el.classList!==void 0?el.classList.remove(name):setClass(el,trim((" "+getClass(el)+" ").replace(" "+name+" "," ")))}__name(removeClass,"removeClass");function setClass(el,name){el.className.baseVal===void 0?el.className=name:el.className.baseVal=name}__name(setClass,"setClass");function getClass(el){return el.correspondingElement&&(el=el.correspondingElement),el.className.baseVal===void 0?el.className:el.className.baseVal}__name(getClass,"getClass");function setOpacity(el,value){"opacity"in el.style?el.style.opacity=value:"filter"in el.style&&_setOpacityIE(el,value)}__name(setOpacity,"setOpacity");function _setOpacityIE(el,value){var filter=!1,filterName="DXImageTransform.Microsoft.Alpha";try{filter=el.filters.item(filterName)}catch{if(value===1)return}value=Math.round(value*100),filter?(filter.Enabled=value!==100,filter.Opacity=value):el.style.filter+=" progid:"+filterName+"(opacity="+value+")"}__name(_setOpacityIE,"_setOpacityIE");function testProp(props){for(var style2=document.documentElement.style,i=0;i<props.length;i++)if(props[i]in style2)return props[i];return!1}__name(testProp,"testProp");function setTransform(el,offset,scale2){var pos=offset||new Point(0,0);el.style[TRANSFORM]=(Browser.ie3d?"translate("+pos.x+"px,"+pos.y+"px)":"translate3d("+pos.x+"px,"+pos.y+"px,0)")+(scale2?" scale("+scale2+")":"")}__name(setTransform,"setTransform");function setPosition(el,point){el._leaflet_pos=point,Browser.any3d?setTransform(el,point):(el.style.left=point.x+"px",el.style.top=point.y+"px")}__name(setPosition,"setPosition");function getPosition(el){return el._leaflet_pos||new Point(0,0)}__name(getPosition,"getPosition");var disableTextSelection,enableTextSelection,_userSelect;if("onselectstart"in document)disableTextSelection=__name(function(){on(window,"selectstart",preventDefault)},"disableTextSelection"),enableTextSelection=__name(function(){off(window,"selectstart",preventDefault)},"enableTextSelection");else{var userSelectProperty=testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);disableTextSelection=__name(function(){if(userSelectProperty){var style2=document.documentElement.style;_userSelect=style2[userSelectProperty],style2[userSelectProperty]="none"}},"disableTextSelection"),enableTextSelection=__name(function(){userSelectProperty&&(document.documentElement.style[userSelectProperty]=_userSelect,_userSelect=void 0)},"enableTextSelection")}function disableImageDrag(){on(window,"dragstart",preventDefault)}__name(disableImageDrag,"disableImageDrag");function enableImageDrag(){off(window,"dragstart",preventDefault)}__name(enableImageDrag,"enableImageDrag");var _outlineElement,_outlineStyle;function preventOutline(element){for(;element.tabIndex===-1;)element=element.parentNode;element.style&&(restoreOutline(),_outlineElement=element,_outlineStyle=element.style.outlineStyle,element.style.outlineStyle="none",on(window,"keydown",restoreOutline))}__name(preventOutline,"preventOutline");function restoreOutline(){_outlineElement&&(_outlineElement.style.outlineStyle=_outlineStyle,_outlineElement=void 0,_outlineStyle=void 0,off(window,"keydown",restoreOutline))}__name(restoreOutline,"restoreOutline");function getSizedParentNode(element){do element=element.parentNode;while((!element.offsetWidth||!element.offsetHeight)&&element!==document.body);return element}__name(getSizedParentNode,"getSizedParentNode");function getScale(element){var rect=element.getBoundingClientRect();return{x:rect.width/element.offsetWidth||1,y:rect.height/element.offsetHeight||1,boundingClientRect:rect}}__name(getScale,"getScale");var DomUtil={__proto__:null,TRANSFORM,TRANSITION,TRANSITION_END,get,getStyle,create:create$1,remove,empty,toFront,toBack,hasClass,addClass,removeClass,setClass,getClass,setOpacity,testProp,setTransform,setPosition,getPosition,get disableTextSelection(){return disableTextSelection},get enableTextSelection(){return enableTextSelection},disableImageDrag,enableImageDrag,preventOutline,restoreOutline,getSizedParentNode,getScale};function on(obj,types2,fn,context){if(types2&&typeof types2=="object")for(var type in types2)addOne(obj,type,types2[type],fn);else{types2=splitWords(types2);for(var i=0,len=types2.length;i<len;i++)addOne(obj,types2[i],fn,context)}return this}__name(on,"on");var eventsKey="_leaflet_events";function off(obj,types2,fn,context){if(arguments.length===1)batchRemove(obj),delete obj[eventsKey];else if(types2&&typeof types2=="object")for(var type in types2)removeOne(obj,type,types2[type],fn);else if(types2=splitWords(types2),arguments.length===2)batchRemove(obj,function(type2){return indexOf(types2,type2)!==-1});else for(var i=0,len=types2.length;i<len;i++)removeOne(obj,types2[i],fn,context);return this}__name(off,"off");function batchRemove(obj,filterFn){for(var id in obj[eventsKey]){var type=id.split(/\d/)[0];(!filterFn||filterFn(type))&&removeOne(obj,type,null,null,id)}}__name(batchRemove,"batchRemove");var mouseSubst={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function addOne(obj,type,fn,context){var id=type+stamp(fn)+(context?"_"+stamp(context):"");if(obj[eventsKey]&&obj[eventsKey][id])return this;var handler=__name(function(e){return fn.call(context||obj,e||window.event)},"handler"),originalHandler=handler;!Browser.touchNative&&Browser.pointer&&type.indexOf("touch")===0?handler=addPointerListener(obj,type,handler):Browser.touch&&type==="dblclick"?handler=addDoubleTapListener(obj,handler):"addEventListener"in obj?type==="touchstart"||type==="touchmove"||type==="wheel"||type==="mousewheel"?obj.addEventListener(mouseSubst[type]||type,handler,Browser.passiveEvents?{passive:!1}:!1):type==="mouseenter"||type==="mouseleave"?(handler=__name(function(e){e=e||window.event,isExternalTarget(obj,e)&&originalHandler(e)},"handler"),obj.addEventListener(mouseSubst[type],handler,!1)):obj.addEventListener(type,originalHandler,!1):obj.attachEvent("on"+type,handler),obj[eventsKey]=obj[eventsKey]||{},obj[eventsKey][id]=handler}__name(addOne,"addOne");function removeOne(obj,type,fn,context,id){id=id||type+stamp(fn)+(context?"_"+stamp(context):"");var handler=obj[eventsKey]&&obj[eventsKey][id];if(!handler)return this;!Browser.touchNative&&Browser.pointer&&type.indexOf("touch")===0?removePointerListener(obj,type,handler):Browser.touch&&type==="dblclick"?removeDoubleTapListener(obj,handler):"removeEventListener"in obj?obj.removeEventListener(mouseSubst[type]||type,handler,!1):obj.detachEvent("on"+type,handler),obj[eventsKey][id]=null}__name(removeOne,"removeOne");function stopPropagation(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}__name(stopPropagation,"stopPropagation");function disableScrollPropagation(el){return addOne(el,"wheel",stopPropagation),this}__name(disableScrollPropagation,"disableScrollPropagation");function disableClickPropagation(el){return on(el,"mousedown touchstart dblclick contextmenu",stopPropagation),el._leaflet_disable_click=!0,this}__name(disableClickPropagation,"disableClickPropagation");function preventDefault(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}__name(preventDefault,"preventDefault");function stop(e){return preventDefault(e),stopPropagation(e),this}__name(stop,"stop");function getPropagationPath(ev){if(ev.composedPath)return ev.composedPath();for(var path=[],el=ev.target;el;)path.push(el),el=el.parentNode;return path}__name(getPropagationPath,"getPropagationPath");function getMousePosition(e,container){if(!container)return new Point(e.clientX,e.clientY);var scale2=getScale(container),offset=scale2.boundingClientRect;return new Point((e.clientX-offset.left)/scale2.x-container.clientLeft,(e.clientY-offset.top)/scale2.y-container.clientTop)}__name(getMousePosition,"getMousePosition");var wheelPxFactor=Browser.linux&&Browser.chrome?window.devicePixelRatio:Browser.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function getWheelDelta(e){return Browser.edge?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/wheelPxFactor:e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0}__name(getWheelDelta,"getWheelDelta");function isExternalTarget(el,e){var related=e.relatedTarget;if(!related)return!0;try{for(;related&&related!==el;)related=related.parentNode}catch{return!1}return related!==el}__name(isExternalTarget,"isExternalTarget");var DomEvent={__proto__:null,on,off,stopPropagation,disableScrollPropagation,disableClickPropagation,preventDefault,stop,getPropagationPath,getMousePosition,getWheelDelta,isExternalTarget,addListener:on,removeListener:off},PosAnimation=Evented.extend({run:__name(function(el,newPos,duration,easeLinearity){this.stop(),this._el=el,this._inProgress=!0,this._duration=duration||.25,this._easeOutPower=1/Math.max(easeLinearity||.5,.2),this._startPos=getPosition(el),this._offset=newPos.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},"run"),stop:__name(function(){this._inProgress&&(this._step(!0),this._complete())},"stop"),_animate:__name(function(){this._animId=requestAnimFrame(this._animate,this),this._step()},"_animate"),_step:__name(function(round){var elapsed=+new Date-this._startTime,duration=this._duration*1e3;elapsed<duration?this._runFrame(this._easeOut(elapsed/duration),round):(this._runFrame(1),this._complete())},"_step"),_runFrame:__name(function(progress,round){var pos=this._startPos.add(this._offset.multiplyBy(progress));round&&pos._round(),setPosition(this._el,pos),this.fire("step")},"_runFrame"),_complete:__name(function(){cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},"_complete"),_easeOut:__name(function(t){return 1-Math.pow(1-t,this._easeOutPower)},"_easeOut")}),Map=Evented.extend({options:{crs:EPSG3857,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:__name(function(id,options){options=setOptions(this,options),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(id),this._initLayout(),this._onResize=bind(this._onResize,this),this._initEvents(),options.maxBounds&&this.setMaxBounds(options.maxBounds),options.zoom!==void 0&&(this._zoom=this._limitZoom(options.zoom)),options.center&&options.zoom!==void 0&&this.setView(toLatLng(options.center),options.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=TRANSITION&&Browser.any3d&&!Browser.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),on(this._proxy,TRANSITION_END,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},"initialize"),setView:__name(function(center,zoom2,options){if(zoom2=zoom2===void 0?this._zoom:this._limitZoom(zoom2),center=this._limitCenter(toLatLng(center),zoom2,this.options.maxBounds),options=options||{},this._stop(),this._loaded&&!options.reset&&options!==!0){options.animate!==void 0&&(options.zoom=extend({animate:options.animate},options.zoom),options.pan=extend({animate:options.animate,duration:options.duration},options.pan));var moved=this._zoom!==zoom2?this._tryAnimatedZoom&&this._tryAnimatedZoom(center,zoom2,options.zoom):this._tryAnimatedPan(center,options.pan);if(moved)return clearTimeout(this._sizeTimer),this}return this._resetView(center,zoom2,options.pan&&options.pan.noMoveStart),this},"setView"),setZoom:__name(function(zoom2,options){return this._loaded?this.setView(this.getCenter(),zoom2,{zoom:options}):(this._zoom=zoom2,this)},"setZoom"),zoomIn:__name(function(delta,options){return delta=delta||(Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+delta,options)},"zoomIn"),zoomOut:__name(function(delta,options){return delta=delta||(Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-delta,options)},"zoomOut"),setZoomAround:__name(function(latlng,zoom2,options){var scale2=this.getZoomScale(zoom2),viewHalf=this.getSize().divideBy(2),containerPoint=latlng instanceof Point?latlng:this.latLngToContainerPoint(latlng),centerOffset=containerPoint.subtract(viewHalf).multiplyBy(1-1/scale2),newCenter=this.containerPointToLatLng(viewHalf.add(centerOffset));return this.setView(newCenter,zoom2,{zoom:options})},"setZoomAround"),_getBoundsCenterZoom:__name(function(bounds,options){options=options||{},bounds=bounds.getBounds?bounds.getBounds():toLatLngBounds(bounds);var paddingTL=toPoint(options.paddingTopLeft||options.padding||[0,0]),paddingBR=toPoint(options.paddingBottomRight||options.padding||[0,0]),zoom2=this.getBoundsZoom(bounds,!1,paddingTL.add(paddingBR));if(zoom2=typeof options.maxZoom=="number"?Math.min(options.maxZoom,zoom2):zoom2,zoom2===1/0)return{center:bounds.getCenter(),zoom:zoom2};var paddingOffset=paddingBR.subtract(paddingTL).divideBy(2),swPoint=this.project(bounds.getSouthWest(),zoom2),nePoint=this.project(bounds.getNorthEast(),zoom2),center=this.unproject(swPoint.add(nePoint).divideBy(2).add(paddingOffset),zoom2);return{center,zoom:zoom2}},"_getBoundsCenterZoom"),fitBounds:__name(function(bounds,options){if(bounds=toLatLngBounds(bounds),!bounds.isValid())throw new Error("Bounds are not valid.");var target=this._getBoundsCenterZoom(bounds,options);return this.setView(target.center,target.zoom,options)},"fitBounds"),fitWorld:__name(function(options){return this.fitBounds([[-90,-180],[90,180]],options)},"fitWorld"),panTo:__name(function(center,options){return this.setView(center,this._zoom,{pan:options})},"panTo"),panBy:__name(function(offset,options){if(offset=toPoint(offset).round(),options=options||{},!offset.x&&!offset.y)return this.fire("moveend");if(options.animate!==!0&&!this.getSize().contains(offset))return this._resetView(this.unproject(this.project(this.getCenter()).add(offset)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),options.noMoveStart||this.fire("movestart"),options.animate!==!1){addClass(this._mapPane,"leaflet-pan-anim");var newPos=this._getMapPanePos().subtract(offset).round();this._panAnim.run(this._mapPane,newPos,options.duration||.25,options.easeLinearity)}else this._rawPanBy(offset),this.fire("move").fire("moveend");return this},"panBy"),flyTo:__name(function(targetCenter,targetZoom,options){if(options=options||{},options.animate===!1||!Browser.any3d)return this.setView(targetCenter,targetZoom,options);this._stop();var from=this.project(this.getCenter()),to=this.project(targetCenter),size=this.getSize(),startZoom=this._zoom;targetCenter=toLatLng(targetCenter),targetZoom=targetZoom===void 0?startZoom:targetZoom;var w0=Math.max(size.x,size.y),w1=w0*this.getZoomScale(startZoom,targetZoom),u1=to.distanceTo(from)||1,rho=1.42,rho2=rho*rho;function r(i){var s1=i?-1:1,s2=i?w1:w0,t1=w1*w1-w0*w0+s1*rho2*rho2*u1*u1,b1=2*s2*rho2*u1,b=t1/b1,sq=Math.sqrt(b*b+1)-b,log=sq<1e-9?-18:Math.log(sq);return log}__name(r,"r");function sinh(n){return(Math.exp(n)-Math.exp(-n))/2}__name(sinh,"sinh");function cosh(n){return(Math.exp(n)+Math.exp(-n))/2}__name(cosh,"cosh");function tanh(n){return sinh(n)/cosh(n)}__name(tanh,"tanh");var r0=r(0);function w(s){return w0*(cosh(r0)/cosh(r0+rho*s))}__name(w,"w");function u(s){return w0*(cosh(r0)*tanh(r0+rho*s)-sinh(r0))/rho2}__name(u,"u");function easeOut(t){return 1-Math.pow(1-t,1.5)}__name(easeOut,"easeOut");var start=Date.now(),S=(r(1)-r0)/rho,duration=options.duration?1e3*options.duration:1e3*S*.8;function frame(){var t=(Date.now()-start)/duration,s=easeOut(t)*S;t<=1?(this._flyToFrame=requestAnimFrame(frame,this),this._move(this.unproject(from.add(to.subtract(from).multiplyBy(u(s)/u1)),startZoom),this.getScaleZoom(w0/w(s),startZoom),{flyTo:!0})):this._move(targetCenter,targetZoom)._moveEnd(!0)}return __name(frame,"frame"),this._moveStart(!0,options.noMoveStart),frame.call(this),this},"flyTo"),flyToBounds:__name(function(bounds,options){var target=this._getBoundsCenterZoom(bounds,options);return this.flyTo(target.center,target.zoom,options)},"flyToBounds"),setMaxBounds:__name(function(bounds){return bounds=toLatLngBounds(bounds),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),bounds.isValid()?(this.options.maxBounds=bounds,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},"setMaxBounds"),setMinZoom:__name(function(zoom2){var oldZoom=this.options.minZoom;return this.options.minZoom=zoom2,this._loaded&&oldZoom!==zoom2&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(zoom2):this},"setMinZoom"),setMaxZoom:__name(function(zoom2){var oldZoom=this.options.maxZoom;return this.options.maxZoom=zoom2,this._loaded&&oldZoom!==zoom2&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(zoom2):this},"setMaxZoom"),panInsideBounds:__name(function(bounds,options){this._enforcingBounds=!0;var center=this.getCenter(),newCenter=this._limitCenter(center,this._zoom,toLatLngBounds(bounds));return center.equals(newCenter)||this.panTo(newCenter,options),this._enforcingBounds=!1,this},"panInsideBounds"),panInside:__name(function(latlng,options){options=options||{};var paddingTL=toPoint(options.paddingTopLeft||options.padding||[0,0]),paddingBR=toPoint(options.paddingBottomRight||options.padding||[0,0]),pixelCenter=this.project(this.getCenter()),pixelPoint=this.project(latlng),pixelBounds=this.getPixelBounds(),paddedBounds=toBounds([pixelBounds.min.add(paddingTL),pixelBounds.max.subtract(paddingBR)]),paddedSize=paddedBounds.getSize();if(!paddedBounds.contains(pixelPoint)){this._enforcingBounds=!0;var centerOffset=pixelPoint.subtract(paddedBounds.getCenter()),offset=paddedBounds.extend(pixelPoint).getSize().subtract(paddedSize);pixelCenter.x+=centerOffset.x<0?-offset.x:offset.x,pixelCenter.y+=centerOffset.y<0?-offset.y:offset.y,this.panTo(this.unproject(pixelCenter),options),this._enforcingBounds=!1}return this},"panInside"),invalidateSize:__name(function(options){if(!this._loaded)return this;options=extend({animate:!1,pan:!0},options===!0?{animate:!0}:options);var oldSize=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var newSize=this.getSize(),oldCenter=oldSize.divideBy(2).round(),newCenter=newSize.divideBy(2).round(),offset=oldCenter.subtract(newCenter);return!offset.x&&!offset.y?this:(options.animate&&options.pan?this.panBy(offset):(options.pan&&this._rawPanBy(offset),this.fire("move"),options.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize,newSize}))},"invalidateSize"),stop:__name(function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},"stop"),locate:__name(function(options){if(options=this._locateOptions=extend({timeout:1e4,watch:!1},options),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var onResponse=bind(this._handleGeolocationResponse,this),onError=bind(this._handleGeolocationError,this);return options.watch?this._locationWatchId=navigator.geolocation.watchPosition(onResponse,onError,options):navigator.geolocation.getCurrentPosition(onResponse,onError,options),this},"locate"),stopLocate:__name(function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},"stopLocate"),_handleGeolocationError:__name(function(error){if(this._container._leaflet_id){var c=error.code,message=error.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+message+"."})}},"_handleGeolocationError"),_handleGeolocationResponse:__name(function(pos){if(this._container._leaflet_id){var lat=pos.coords.latitude,lng=pos.coords.longitude,latlng=new LatLng(lat,lng),bounds=latlng.toBounds(pos.coords.accuracy*2),options=this._locateOptions;if(options.setView){var zoom2=this.getBoundsZoom(bounds);this.setView(latlng,options.maxZoom?Math.min(zoom2,options.maxZoom):zoom2)}var data={latlng,bounds,timestamp:pos.timestamp};for(var i in pos.coords)typeof pos.coords[i]=="number"&&(data[i]=pos.coords[i]);this.fire("locationfound",data)}},"_handleGeolocationResponse"),addHandler:__name(function(name,HandlerClass){if(!HandlerClass)return this;var handler=this[name]=new HandlerClass(this);return this._handlers.push(handler),this.options[name]&&handler.enable(),this},"addHandler"),remove:__name(function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(cancelAnimFrame(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var i;for(i in this._layers)this._layers[i].remove();for(i in this._panes)remove(this._panes[i]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},"remove"),createPane:__name(function(name,container){var className="leaflet-pane"+(name?" leaflet-"+name.replace("Pane","")+"-pane":""),pane=create$1("div",className,container||this._mapPane);return name&&(this._panes[name]=pane),pane},"createPane"),getCenter:__name(function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},"getCenter"),getZoom:__name(function(){return this._zoom},"getZoom"),getBounds:__name(function(){var bounds=this.getPixelBounds(),sw=this.unproject(bounds.getBottomLeft()),ne=this.unproject(bounds.getTopRight());return new LatLngBounds(sw,ne)},"getBounds"),getMinZoom:__name(function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},"getMinZoom"),getMaxZoom:__name(function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},"getMaxZoom"),getBoundsZoom:__name(function(bounds,inside,padding){bounds=toLatLngBounds(bounds),padding=toPoint(padding||[0,0]);var zoom2=this.getZoom()||0,min=this.getMinZoom(),max=this.getMaxZoom(),nw=bounds.getNorthWest(),se=bounds.getSouthEast(),size=this.getSize().subtract(padding),boundsSize=toBounds(this.project(se,zoom2),this.project(nw,zoom2)).getSize(),snap=Browser.any3d?this.options.zoomSnap:1,scalex=size.x/boundsSize.x,scaley=size.y/boundsSize.y,scale2=inside?Math.max(scalex,scaley):Math.min(scalex,scaley);return zoom2=this.getScaleZoom(scale2,zoom2),snap&&(zoom2=Math.round(zoom2/(snap/100))*(snap/100),zoom2=inside?Math.ceil(zoom2/snap)*snap:Math.floor(zoom2/snap)*snap),Math.max(min,Math.min(max,zoom2))},"getBoundsZoom"),getSize:__name(function(){return(!this._size||this._sizeChanged)&&(this._size=new Point(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},"getSize"),getPixelBounds:__name(function(center,zoom2){var topLeftPoint=this._getTopLeftPoint(center,zoom2);return new Bounds(topLeftPoint,topLeftPoint.add(this.getSize()))},"getPixelBounds"),getPixelOrigin:__name(function(){return this._checkIfLoaded(),this._pixelOrigin},"getPixelOrigin"),getPixelWorldBounds:__name(function(zoom2){return this.options.crs.getProjectedBounds(zoom2===void 0?this.getZoom():zoom2)},"getPixelWorldBounds"),getPane:__name(function(pane){return typeof pane=="string"?this._panes[pane]:pane},"getPane"),getPanes:__name(function(){return this._panes},"getPanes"),getContainer:__name(function(){return this._container},"getContainer"),getZoomScale:__name(function(toZoom,fromZoom){var crs=this.options.crs;return fromZoom=fromZoom===void 0?this._zoom:fromZoom,crs.scale(toZoom)/crs.scale(fromZoom)},"getZoomScale"),getScaleZoom:__name(function(scale2,fromZoom){var crs=this.options.crs;fromZoom=fromZoom===void 0?this._zoom:fromZoom;var zoom2=crs.zoom(scale2*crs.scale(fromZoom));return isNaN(zoom2)?1/0:zoom2},"getScaleZoom"),project:__name(function(latlng,zoom2){return zoom2=zoom2===void 0?this._zoom:zoom2,this.options.crs.latLngToPoint(toLatLng(latlng),zoom2)},"project"),unproject:__name(function(point,zoom2){return zoom2=zoom2===void 0?this._zoom:zoom2,this.options.crs.pointToLatLng(toPoint(point),zoom2)},"unproject"),layerPointToLatLng:__name(function(point){var projectedPoint=toPoint(point).add(this.getPixelOrigin());return this.unproject(projectedPoint)},"layerPointToLatLng"),latLngToLayerPoint:__name(function(latlng){var projectedPoint=this.project(toLatLng(latlng))._round();return projectedPoint._subtract(this.getPixelOrigin())},"latLngToLayerPoint"),wrapLatLng:__name(function(latlng){return this.options.crs.wrapLatLng(toLatLng(latlng))},"wrapLatLng"),wrapLatLngBounds:__name(function(latlng){return this.options.crs.wrapLatLngBounds(toLatLngBounds(latlng))},"wrapLatLngBounds"),distance:__name(function(latlng1,latlng2){return this.options.crs.distance(toLatLng(latlng1),toLatLng(latlng2))},"distance"),containerPointToLayerPoint:__name(function(point){return toPoint(point).subtract(this._getMapPanePos())},"containerPointToLayerPoint"),layerPointToContainerPoint:__name(function(point){return toPoint(point).add(this._getMapPanePos())},"layerPointToContainerPoint"),containerPointToLatLng:__name(function(point){var layerPoint=this.containerPointToLayerPoint(toPoint(point));return this.layerPointToLatLng(layerPoint)},"containerPointToLatLng"),latLngToContainerPoint:__name(function(latlng){return this.layerPointToContainerPoint(this.latLngToLayerPoint(toLatLng(latlng)))},"latLngToContainerPoint"),mouseEventToContainerPoint:__name(function(e){return getMousePosition(e,this._container)},"mouseEventToContainerPoint"),mouseEventToLayerPoint:__name(function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},"mouseEventToLayerPoint"),mouseEventToLatLng:__name(function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},"mouseEventToLatLng"),_initContainer:__name(function(id){var container=this._container=get(id);if(container){if(container._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");on(container,"scroll",this._onScroll,this),this._containerId=stamp(container)},"_initContainer"),_initLayout:__name(function(){var container=this._container;this._fadeAnimated=this.options.fadeAnimation&&Browser.any3d,addClass(container,"leaflet-container"+(Browser.touch?" leaflet-touch":"")+(Browser.retina?" leaflet-retina":"")+(Browser.ielt9?" leaflet-oldie":"")+(Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var position=getStyle(container,"position");position!=="absolute"&&position!=="relative"&&position!=="fixed"&&position!=="sticky"&&(container.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},"_initLayout"),_initPanes:__name(function(){var panes=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),setPosition(this._mapPane,new Point(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(addClass(panes.markerPane,"leaflet-zoom-hide"),addClass(panes.shadowPane,"leaflet-zoom-hide"))},"_initPanes"),_resetView:__name(function(center,zoom2,noMoveStart){setPosition(this._mapPane,new Point(0,0));var loading=!this._loaded;this._loaded=!0,zoom2=this._limitZoom(zoom2),this.fire("viewprereset");var zoomChanged=this._zoom!==zoom2;this._moveStart(zoomChanged,noMoveStart)._move(center,zoom2)._moveEnd(zoomChanged),this.fire("viewreset"),loading&&this.fire("load")},"_resetView"),_moveStart:__name(function(zoomChanged,noMoveStart){return zoomChanged&&this.fire("zoomstart"),noMoveStart||this.fire("movestart"),this},"_moveStart"),_move:__name(function(center,zoom2,data,supressEvent){zoom2===void 0&&(zoom2=this._zoom);var zoomChanged=this._zoom!==zoom2;return this._zoom=zoom2,this._lastCenter=center,this._pixelOrigin=this._getNewPixelOrigin(center),supressEvent?data&&data.pinch&&this.fire("zoom",data):((zoomChanged||data&&data.pinch)&&this.fire("zoom",data),this.fire("move",data)),this},"_move"),_moveEnd:__name(function(zoomChanged){return zoomChanged&&this.fire("zoomend"),this.fire("moveend")},"_moveEnd"),_stop:__name(function(){return cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},"_stop"),_rawPanBy:__name(function(offset){setPosition(this._mapPane,this._getMapPanePos().subtract(offset))},"_rawPanBy"),_getZoomSpan:__name(function(){return this.getMaxZoom()-this.getMinZoom()},"_getZoomSpan"),_panInsideMaxBounds:__name(function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},"_panInsideMaxBounds"),_checkIfLoaded:__name(function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},"_checkIfLoaded"),_initEvents:__name(function(remove2){this._targets={},this._targets[stamp(this._container)]=this;var onOff=remove2?off:on;onOff(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&onOff(window,"resize",this._onResize,this),Browser.any3d&&this.options.transform3DLimit&&(remove2?this.off:this.on).call(this,"moveend",this._onMoveEnd)},"_initEvents"),_onResize:__name(function(){cancelAnimFrame(this._resizeRequest),this._resizeRequest=requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},"_onResize"),_onScroll:__name(function(){this._container.scrollTop=0,this._container.scrollLeft=0},"_onScroll"),_onMoveEnd:__name(function(){var pos=this._getMapPanePos();Math.max(Math.abs(pos.x),Math.abs(pos.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},"_onMoveEnd"),_findEventTargets:__name(function(e,type){for(var targets=[],target,isHover=type==="mouseout"||type==="mouseover",src=e.target||e.srcElement,dragging=!1;src;){if(target=this._targets[stamp(src)],target&&(type==="click"||type==="preclick")&&this._draggableMoved(target)){dragging=!0;break}if(target&&target.listens(type,!0)&&(isHover&&!isExternalTarget(src,e)||(targets.push(target),isHover))||src===this._container)break;src=src.parentNode}return!targets.length&&!dragging&&!isHover&&this.listens(type,!0)&&(targets=[this]),targets},"_findEventTargets"),_isClickDisabled:__name(function(el){for(;el&&el!==this._container;){if(el._leaflet_disable_click)return!0;el=el.parentNode}},"_isClickDisabled"),_handleDOMEvent:__name(function(e){var el=e.target||e.srcElement;if(!(!this._loaded||el._leaflet_disable_events||e.type==="click"&&this._isClickDisabled(el))){var type=e.type;type==="mousedown"&&preventOutline(el),this._fireDOMEvent(e,type)}},"_handleDOMEvent"),_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:__name(function(e,type,canvasTargets){if(e.type==="click"){var synth=extend({},e);synth.type="preclick",this._fireDOMEvent(synth,synth.type,canvasTargets)}var targets=this._findEventTargets(e,type);if(canvasTargets){for(var filtered=[],i=0;i<canvasTargets.length;i++)canvasTargets[i].listens(type,!0)&&filtered.push(canvasTargets[i]);targets=filtered.concat(targets)}if(targets.length){type==="contextmenu"&&preventDefault(e);var target=targets[0],data={originalEvent:e};if(e.type!=="keypress"&&e.type!=="keydown"&&e.type!=="keyup"){var isMarker=target.getLatLng&&(!target._radius||target._radius<=10);data.containerPoint=isMarker?this.latLngToContainerPoint(target.getLatLng()):this.mouseEventToContainerPoint(e),data.layerPoint=this.containerPointToLayerPoint(data.containerPoint),data.latlng=isMarker?target.getLatLng():this.layerPointToLatLng(data.layerPoint)}for(i=0;i<targets.length;i++)if(targets[i].fire(type,data,!0),data.originalEvent._stopped||targets[i].options.bubblingMouseEvents===!1&&indexOf(this._mouseEvents,type)!==-1)return}},"_fireDOMEvent"),_draggableMoved:__name(function(obj){return obj=obj.dragging&&obj.dragging.enabled()?obj:this,obj.dragging&&obj.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},"_draggableMoved"),_clearHandlers:__name(function(){for(var i=0,len=this._handlers.length;i<len;i++)this._handlers[i].disable()},"_clearHandlers"),whenReady:__name(function(callback,context){return this._loaded?callback.call(context||this,{target:this}):this.on("load",callback,context),this},"whenReady"),_getMapPanePos:__name(function(){return getPosition(this._mapPane)||new Point(0,0)},"_getMapPanePos"),_moved:__name(function(){var pos=this._getMapPanePos();return pos&&!pos.equals([0,0])},"_moved"),_getTopLeftPoint:__name(function(center,zoom2){var pixelOrigin=center&&zoom2!==void 0?this._getNewPixelOrigin(center,zoom2):this.getPixelOrigin();return pixelOrigin.subtract(this._getMapPanePos())},"_getTopLeftPoint"),_getNewPixelOrigin:__name(function(center,zoom2){var viewHalf=this.getSize()._divideBy(2);return this.project(center,zoom2)._subtract(viewHalf)._add(this._getMapPanePos())._round()},"_getNewPixelOrigin"),_latLngToNewLayerPoint:__name(function(latlng,zoom2,center){var topLeft=this._getNewPixelOrigin(center,zoom2);return this.project(latlng,zoom2)._subtract(topLeft)},"_latLngToNewLayerPoint"),_latLngBoundsToNewLayerBounds:__name(function(latLngBounds,zoom2,center){var topLeft=this._getNewPixelOrigin(center,zoom2);return toBounds([this.project(latLngBounds.getSouthWest(),zoom2)._subtract(topLeft),this.project(latLngBounds.getNorthWest(),zoom2)._subtract(topLeft),this.project(latLngBounds.getSouthEast(),zoom2)._subtract(topLeft),this.project(latLngBounds.getNorthEast(),zoom2)._subtract(topLeft)])},"_latLngBoundsToNewLayerBounds"),_getCenterLayerPoint:__name(function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},"_getCenterLayerPoint"),_getCenterOffset:__name(function(latlng){return this.latLngToLayerPoint(latlng).subtract(this._getCenterLayerPoint())},"_getCenterOffset"),_limitCenter:__name(function(center,zoom2,bounds){if(!bounds)return center;var centerPoint=this.project(center,zoom2),viewHalf=this.getSize().divideBy(2),viewBounds=new Bounds(centerPoint.subtract(viewHalf),centerPoint.add(viewHalf)),offset=this._getBoundsOffset(viewBounds,bounds,zoom2);return Math.abs(offset.x)<=1&&Math.abs(offset.y)<=1?center:this.unproject(centerPoint.add(offset),zoom2)},"_limitCenter"),_limitOffset:__name(function(offset,bounds){if(!bounds)return offset;var viewBounds=this.getPixelBounds(),newBounds=new Bounds(viewBounds.min.add(offset),viewBounds.max.add(offset));return offset.add(this._getBoundsOffset(newBounds,bounds))},"_limitOffset"),_getBoundsOffset:__name(function(pxBounds,maxBounds,zoom2){var projectedMaxBounds=toBounds(this.project(maxBounds.getNorthEast(),zoom2),this.project(maxBounds.getSouthWest(),zoom2)),minOffset=projectedMaxBounds.min.subtract(pxBounds.min),maxOffset=projectedMaxBounds.max.subtract(pxBounds.max),dx=this._rebound(minOffset.x,-maxOffset.x),dy=this._rebound(minOffset.y,-maxOffset.y);return new Point(dx,dy)},"_getBoundsOffset"),_rebound:__name(function(left,right){return left+right>0?Math.round(left-right)/2:Math.max(0,Math.ceil(left))-Math.max(0,Math.floor(right))},"_rebound"),_limitZoom:__name(function(zoom2){var min=this.getMinZoom(),max=this.getMaxZoom(),snap=Browser.any3d?this.options.zoomSnap:1;return snap&&(zoom2=Math.round(zoom2/snap)*snap),Math.max(min,Math.min(max,zoom2))},"_limitZoom"),_onPanTransitionStep:__name(function(){this.fire("move")},"_onPanTransitionStep"),_onPanTransitionEnd:__name(function(){removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},"_onPanTransitionEnd"),_tryAnimatedPan:__name(function(center,options){var offset=this._getCenterOffset(center)._trunc();return(options&&options.animate)!==!0&&!this.getSize().contains(offset)?!1:(this.panBy(offset,options),!0)},"_tryAnimatedPan"),_createAnimProxy:__name(function(){var proxy=this._proxy=create$1("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(proxy),this.on("zoomanim",function(e){var prop=TRANSFORM,transform=this._proxy.style[prop];setTransform(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),transform===this._proxy.style[prop]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},"_createAnimProxy"),_destroyAnimProxy:__name(function(){remove(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},"_destroyAnimProxy"),_animMoveEnd:__name(function(){var c=this.getCenter(),z=this.getZoom();setTransform(this._proxy,this.project(c,z),this.getZoomScale(z,1))},"_animMoveEnd"),_catchTransitionEnd:__name(function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},"_catchTransitionEnd"),_nothingToAnimate:__name(function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},"_nothingToAnimate"),_tryAnimatedZoom:__name(function(center,zoom2,options){if(this._animatingZoom)return!0;if(options=options||{},!this._zoomAnimated||options.animate===!1||this._nothingToAnimate()||Math.abs(zoom2-this._zoom)>this.options.zoomAnimationThreshold)return!1;var scale2=this.getZoomScale(zoom2),offset=this._getCenterOffset(center)._divideBy(1-1/scale2);return options.animate!==!0&&!this.getSize().contains(offset)?!1:(requestAnimFrame(function(){this._moveStart(!0,options.noMoveStart||!1)._animateZoom(center,zoom2,!0)},this),!0)},"_tryAnimatedZoom"),_animateZoom:__name(function(center,zoom2,startAnim,noUpdate){this._mapPane&&(startAnim&&(this._animatingZoom=!0,this._animateToCenter=center,this._animateToZoom=zoom2,addClass(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center,zoom:zoom2,noUpdate}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(bind(this._onZoomTransitionEnd,this),250))},"_animateZoom"),_onZoomTransitionEnd:__name(function(){this._animatingZoom&&(this._mapPane&&removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))},"_onZoomTransitionEnd")});function createMap2(id,options){return new Map(id,options)}__name(createMap2,"createMap");var Control=Class.extend({options:{position:"topright"},initialize:__name(function(options){setOptions(this,options)},"initialize"),getPosition:__name(function(){return this.options.position},"getPosition"),setPosition:__name(function(position){var map2=this._map;return map2&&map2.removeControl(this),this.options.position=position,map2&&map2.addControl(this),this},"setPosition"),getContainer:__name(function(){return this._container},"getContainer"),addTo:__name(function(map2){this.remove(),this._map=map2;var container=this._container=this.onAdd(map2),pos=this.getPosition(),corner=map2._controlCorners[pos];return addClass(container,"leaflet-control"),pos.indexOf("bottom")!==-1?corner.insertBefore(container,corner.firstChild):corner.appendChild(container),this._map.on("unload",this.remove,this),this},"addTo"),remove:__name(function(){return this._map?(remove(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},"remove"),_refocusOnMap:__name(function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()},"_refocusOnMap")}),control=__name(function(options){return new Control(options)},"control");Map.include({addControl:__name(function(control2){return control2.addTo(this),this},"addControl"),removeControl:__name(function(control2){return control2.remove(),this},"removeControl"),_initControlPos:__name(function(){var corners=this._controlCorners={},l="leaflet-",container=this._controlContainer=create$1("div",l+"control-container",this._container);function createCorner(vSide,hSide){var className=l+vSide+" "+l+hSide;corners[vSide+hSide]=create$1("div",className,container)}__name(createCorner,"createCorner"),createCorner("top","left"),createCorner("top","right"),createCorner("bottom","left"),createCorner("bottom","right")},"_initControlPos"),_clearControlPos:__name(function(){for(var i in this._controlCorners)remove(this._controlCorners[i]);remove(this._controlContainer),delete this._controlCorners,delete this._controlContainer},"_clearControlPos")});var Layers=Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:__name(function(layerA,layerB,nameA,nameB){return nameA<nameB?-1:nameB<nameA?1:0},"sortFunction")},initialize:__name(function(baseLayers,overlays,options){setOptions(this,options),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var i in baseLayers)this._addLayer(baseLayers[i],i);for(i in overlays)this._addLayer(overlays[i],i,!0)},"initialize"),onAdd:__name(function(map2){this._initLayout(),this._update(),this._map=map2,map2.on("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.on("add remove",this._onLayerChange,this);return this._container},"onAdd"),addTo:__name(function(map2){return Control.prototype.addTo.call(this,map2),this._expandIfNotCollapsed()},"addTo"),onRemove:__name(function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.off("add remove",this._onLayerChange,this)},"onRemove"),addBaseLayer:__name(function(layer,name){return this._addLayer(layer,name),this._map?this._update():this},"addBaseLayer"),addOverlay:__name(function(layer,name){return this._addLayer(layer,name,!0),this._map?this._update():this},"addOverlay"),removeLayer:__name(function(layer){layer.off("add remove",this._onLayerChange,this);var obj=this._getLayer(stamp(layer));return obj&&this._layers.splice(this._layers.indexOf(obj),1),this._map?this._update():this},"removeLayer"),expand:__name(function(){addClass(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var acceptableHeight=this._map.getSize().y-(this._container.offsetTop+50);return acceptableHeight<this._section.clientHeight?(addClass(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=acceptableHeight+"px"):removeClass(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},"expand"),collapse:__name(function(){return removeClass(this._container,"leaflet-control-layers-expanded"),this},"collapse"),_initLayout:__name(function(){var className="leaflet-control-layers",container=this._container=create$1("div",className),collapsed=this.options.collapsed;container.setAttribute("aria-haspopup",!0),disableClickPropagation(container),disableScrollPropagation(container);var section=this._section=create$1("section",className+"-list");collapsed&&(this._map.on("click",this.collapse,this),on(container,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var link=this._layersLink=create$1("a",className+"-toggle",container);link.href="#",link.title="Layers",link.setAttribute("role","button"),on(link,{keydown:__name(function(e){e.keyCode===13&&this._expandSafely()},"keydown"),click:__name(function(e){preventDefault(e),this._expandSafely()},"click")},this),collapsed||this.expand(),this._baseLayersList=create$1("div",className+"-base",section),this._separator=create$1("div",className+"-separator",section),this._overlaysList=create$1("div",className+"-overlays",section),container.appendChild(section)},"_initLayout"),_getLayer:__name(function(id){for(var i=0;i<this._layers.length;i++)if(this._layers[i]&&stamp(this._layers[i].layer)===id)return this._layers[i]},"_getLayer"),_addLayer:__name(function(layer,name,overlay){this._map&&layer.on("add remove",this._onLayerChange,this),this._layers.push({layer,name,overlay}),this.options.sortLayers&&this._layers.sort(bind(function(a,b){return this.options.sortFunction(a.layer,b.layer,a.name,b.name)},this)),this.options.autoZIndex&&layer.setZIndex&&(this._lastZIndex++,layer.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},"_addLayer"),_update:__name(function(){if(!this._container)return this;empty(this._baseLayersList),empty(this._overlaysList),this._layerControlInputs=[];var baseLayersPresent,overlaysPresent,i,obj,baseLayersCount=0;for(i=0;i<this._layers.length;i++)obj=this._layers[i],this._addItem(obj),overlaysPresent=overlaysPresent||obj.overlay,baseLayersPresent=baseLayersPresent||!obj.overlay,baseLayersCount+=obj.overlay?0:1;return this.options.hideSingleBase&&(baseLayersPresent=baseLayersPresent&&baseLayersCount>1,this._baseLayersList.style.display=baseLayersPresent?"":"none"),this._separator.style.display=overlaysPresent&&baseLayersPresent?"":"none",this},"_update"),_onLayerChange:__name(function(e){this._handlingClick||this._update();var obj=this._getLayer(stamp(e.target)),type=obj.overlay?e.type==="add"?"overlayadd":"overlayremove":e.type==="add"?"baselayerchange":null;type&&this._map.fire(type,obj)},"_onLayerChange"),_createRadioElement:__name(function(name,checked){var radioHtml='<input type="radio" class="leaflet-control-layers-selector" name="'+name+'"'+(checked?' checked="checked"':"")+"/>",radioFragment=document.createElement("div");return radioFragment.innerHTML=radioHtml,radioFragment.firstChild},"_createRadioElement"),_addItem:__name(function(obj){var label=document.createElement("label"),checked=this._map.hasLayer(obj.layer),input;obj.overlay?(input=document.createElement("input"),input.type="checkbox",input.className="leaflet-control-layers-selector",input.defaultChecked=checked):input=this._createRadioElement("leaflet-base-layers_"+stamp(this),checked),this._layerControlInputs.push(input),input.layerId=stamp(obj.layer),on(input,"click",this._onInputClick,this);var name=document.createElement("span");name.innerHTML=" "+obj.name;var holder=document.createElement("span");label.appendChild(holder),holder.appendChild(input),holder.appendChild(name);var container=obj.overlay?this._overlaysList:this._baseLayersList;return container.appendChild(label),this._checkDisabledLayers(),label},"_addItem"),_onInputClick:__name(function(){if(!this._preventClick){var inputs=this._layerControlInputs,input,layer,addedLayers=[],removedLayers=[];this._handlingClick=!0;for(var i=inputs.length-1;i>=0;i--)input=inputs[i],layer=this._getLayer(input.layerId).layer,input.checked?addedLayers.push(layer):input.checked||removedLayers.push(layer);for(i=0;i<removedLayers.length;i++)this._map.hasLayer(removedLayers[i])&&this._map.removeLayer(removedLayers[i]);for(i=0;i<addedLayers.length;i++)this._map.hasLayer(addedLayers[i])||this._map.addLayer(addedLayers[i]);this._handlingClick=!1,this._refocusOnMap()}},"_onInputClick"),_checkDisabledLayers:__name(function(){for(var inputs=this._layerControlInputs,input,layer,zoom2=this._map.getZoom(),i=inputs.length-1;i>=0;i--)input=inputs[i],layer=this._getLayer(input.layerId).layer,input.disabled=layer.options.minZoom!==void 0&&zoom2<layer.options.minZoom||layer.options.maxZoom!==void 0&&zoom2>layer.options.maxZoom},"_checkDisabledLayers"),_expandIfNotCollapsed:__name(function(){return this._map&&!this.options.collapsed&&this.expand(),this},"_expandIfNotCollapsed"),_expandSafely:__name(function(){var section=this._section;this._preventClick=!0,on(section,"click",preventDefault),this.expand();var that=this;setTimeout(function(){off(section,"click",preventDefault),that._preventClick=!1})},"_expandSafely")}),layers=__name(function(baseLayers,overlays,options){return new Layers(baseLayers,overlays,options)},"layers"),Zoom=Control.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:__name(function(map2){var zoomName="leaflet-control-zoom",container=create$1("div",zoomName+" leaflet-bar"),options=this.options;return this._zoomInButton=this._createButton(options.zoomInText,options.zoomInTitle,zoomName+"-in",container,this._zoomIn),this._zoomOutButton=this._createButton(options.zoomOutText,options.zoomOutTitle,zoomName+"-out",container,this._zoomOut),this._updateDisabled(),map2.on("zoomend zoomlevelschange",this._updateDisabled,this),container},"onAdd"),onRemove:__name(function(map2){map2.off("zoomend zoomlevelschange",this._updateDisabled,this)},"onRemove"),disable:__name(function(){return this._disabled=!0,this._updateDisabled(),this},"disable"),enable:__name(function(){return this._disabled=!1,this._updateDisabled(),this},"enable"),_zoomIn:__name(function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},"_zoomIn"),_zoomOut:__name(function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},"_zoomOut"),_createButton:__name(function(html,title,className,container,fn){var link=create$1("a",className,container);return link.innerHTML=html,link.href="#",link.title=title,link.setAttribute("role","button"),link.setAttribute("aria-label",title),disableClickPropagation(link),on(link,"click",stop),on(link,"click",fn,this),on(link,"click",this._refocusOnMap,this),link},"_createButton"),_updateDisabled:__name(function(){var map2=this._map,className="leaflet-disabled";removeClass(this._zoomInButton,className),removeClass(this._zoomOutButton,className),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||map2._zoom===map2.getMinZoom())&&(addClass(this._zoomOutButton,className),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||map2._zoom===map2.getMaxZoom())&&(addClass(this._zoomInButton,className),this._zoomInButton.setAttribute("aria-disabled","true"))},"_updateDisabled")});Map.mergeOptions({zoomControl:!0}),Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Zoom,this.addControl(this.zoomControl))});var zoom=__name(function(options){return new Zoom(options)},"zoom"),Scale=Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:__name(function(map2){var className="leaflet-control-scale",container=create$1("div",className),options=this.options;return this._addScales(options,className+"-line",container),map2.on(options.updateWhenIdle?"moveend":"move",this._update,this),map2.whenReady(this._update,this),container},"onAdd"),onRemove:__name(function(map2){map2.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},"onRemove"),_addScales:__name(function(options,className,container){options.metric&&(this._mScale=create$1("div",className,container)),options.imperial&&(this._iScale=create$1("div",className,container))},"_addScales"),_update:__name(function(){var map2=this._map,y=map2.getSize().y/2,maxMeters=map2.distance(map2.containerPointToLatLng([0,y]),map2.containerPointToLatLng([this.options.maxWidth,y]));this._updateScales(maxMeters)},"_update"),_updateScales:__name(function(maxMeters){this.options.metric&&maxMeters&&this._updateMetric(maxMeters),this.options.imperial&&maxMeters&&this._updateImperial(maxMeters)},"_updateScales"),_updateMetric:__name(function(maxMeters){var meters=this._getRoundNum(maxMeters),label=meters<1e3?meters+" m":meters/1e3+" km";this._updateScale(this._mScale,label,meters/maxMeters)},"_updateMetric"),_updateImperial:__name(function(maxMeters){var maxFeet=maxMeters*3.2808399,maxMiles,miles,feet;maxFeet>5280?(maxMiles=maxFeet/5280,miles=this._getRoundNum(maxMiles),this._updateScale(this._iScale,miles+" mi",miles/maxMiles)):(feet=this._getRoundNum(maxFeet),this._updateScale(this._iScale,feet+" ft",feet/maxFeet))},"_updateImperial"),_updateScale:__name(function(scale2,text,ratio){scale2.style.width=Math.round(this.options.maxWidth*ratio)+"px",scale2.innerHTML=text},"_updateScale"),_getRoundNum:__name(function(num){var pow10=Math.pow(10,(Math.floor(num)+"").length-1),d=num/pow10;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,pow10*d},"_getRoundNum")}),scale=__name(function(options){return new Scale(options)},"scale"),ukrainianFlag='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Attribution=Control.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Browser.inlineSvg?ukrainianFlag+" ":"")+"Leaflet</a>"},initialize:__name(function(options){setOptions(this,options),this._attributions={}},"initialize"),onAdd:__name(function(map2){map2.attributionControl=this,this._container=create$1("div","leaflet-control-attribution"),disableClickPropagation(this._container);for(var i in map2._layers)map2._layers[i].getAttribution&&this.addAttribution(map2._layers[i].getAttribution());return this._update(),map2.on("layeradd",this._addAttribution,this),this._container},"onAdd"),onRemove:__name(function(map2){map2.off("layeradd",this._addAttribution,this)},"onRemove"),_addAttribution:__name(function(ev){ev.layer.getAttribution&&(this.addAttribution(ev.layer.getAttribution()),ev.layer.once("remove",function(){this.removeAttribution(ev.layer.getAttribution())},this))},"_addAttribution"),setPrefix:__name(function(prefix){return this.options.prefix=prefix,this._update(),this},"setPrefix"),addAttribution:__name(function(text){return text?(this._attributions[text]||(this._attributions[text]=0),this._attributions[text]++,this._update(),this):this},"addAttribution"),removeAttribution:__name(function(text){return text?(this._attributions[text]&&(this._attributions[text]--,this._update()),this):this},"removeAttribution"),_update:__name(function(){if(this._map){var attribs=[];for(var i in this._attributions)this._attributions[i]&&attribs.push(i);var prefixAndAttribs=[];this.options.prefix&&prefixAndAttribs.push(this.options.prefix),attribs.length&&prefixAndAttribs.push(attribs.join(", ")),this._container.innerHTML=prefixAndAttribs.join(' <span aria-hidden="true">|</span> ')}},"_update")});Map.mergeOptions({attributionControl:!0}),Map.addInitHook(function(){this.options.attributionControl&&new Attribution().addTo(this)});var attribution2=__name(function(options){return new Attribution(options)},"attribution");Control.Layers=Layers,Control.Zoom=Zoom,Control.Scale=Scale,Control.Attribution=Attribution,control.layers=layers,control.zoom=zoom,control.scale=scale,control.attribution=attribution2;var Handler=Class.extend({initialize:__name(function(map2){this._map=map2},"initialize"),enable:__name(function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},"enable"),disable:__name(function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},"disable"),enabled:__name(function(){return!!this._enabled},"enabled")});Handler.addTo=function(map2,name){return map2.addHandler(name,this),this};var Mixin={Events},START=Browser.touch?"touchstart mousedown":"mousedown",Draggable=Evented.extend({options:{clickTolerance:3},initialize:__name(function(element,dragStartTarget,preventOutline2,options){setOptions(this,options),this._element=element,this._dragStartTarget=dragStartTarget||element,this._preventOutline=preventOutline2},"initialize"),enable:__name(function(){this._enabled||(on(this._dragStartTarget,START,this._onDown,this),this._enabled=!0)},"enable"),disable:__name(function(){this._enabled&&(Draggable._dragging===this&&this.finishDrag(!0),off(this._dragStartTarget,START,this._onDown,this),this._enabled=!1,this._moved=!1)},"disable"),_onDown:__name(function(e){if(this._enabled&&(this._moved=!1,!hasClass(this._element,"leaflet-zoom-anim"))){if(e.touches&&e.touches.length!==1){Draggable._dragging===this&&this.finishDrag();return}if(!(Draggable._dragging||e.shiftKey||e.which!==1&&e.button!==1&&!e.touches)&&(Draggable._dragging=this,this._preventOutline&&preventOutline(this._element),disableImageDrag(),disableTextSelection(),!this._moving)){this.fire("down");var first=e.touches?e.touches[0]:e,sizedParent=getSizedParentNode(this._element);this._startPoint=new Point(first.clientX,first.clientY),this._startPos=getPosition(this._element),this._parentScale=getScale(sizedParent);var mouseevent=e.type==="mousedown";on(document,mouseevent?"mousemove":"touchmove",this._onMove,this),on(document,mouseevent?"mouseup":"touchend touchcancel",this._onUp,this)}}},"_onDown"),_onMove:__name(function(e){if(this._enabled){if(e.touches&&e.touches.length>1){this._moved=!0;return}var first=e.touches&&e.touches.length===1?e.touches[0]:e,offset=new Point(first.clientX,first.clientY)._subtract(this._startPoint);!offset.x&&!offset.y||Math.abs(offset.x)+Math.abs(offset.y)<this.options.clickTolerance||(offset.x/=this._parentScale.x,offset.y/=this._parentScale.y,preventDefault(e),this._moved||(this.fire("dragstart"),this._moved=!0,addClass(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(offset),this._moving=!0,this._lastEvent=e,this._updatePosition())}},"_onMove"),_updatePosition:__name(function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),setPosition(this._element,this._newPos),this.fire("drag",e)},"_updatePosition"),_onUp:__name(function(){this._enabled&&this.finishDrag()},"_onUp"),finishDrag:__name(function(noInertia){removeClass(document.body,"leaflet-dragging"),this._lastTarget&&(removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),off(document,"mousemove touchmove",this._onMove,this),off(document,"mouseup touchend touchcancel",this._onUp,this),enableImageDrag(),enableTextSelection();var fireDragend=this._moved&&this._moving;this._moving=!1,Draggable._dragging=!1,fireDragend&&this.fire("dragend",{noInertia,distance:this._newPos.distanceTo(this._startPos)})},"finishDrag")});function clipPolygon(points,bounds,round){var clippedPoints,edges=[1,4,2,8],i,j,k,a,b,len,edge2,p;for(i=0,len=points.length;i<len;i++)points[i]._code=_getBitCode(points[i],bounds);for(k=0;k<4;k++){for(edge2=edges[k],clippedPoints=[],i=0,len=points.length,j=len-1;i<len;j=i++)a=points[i],b=points[j],a._code&edge2?b._code&edge2||(p=_getEdgeIntersection(b,a,edge2,bounds,round),p._code=_getBitCode(p,bounds),clippedPoints.push(p)):(b._code&edge2&&(p=_getEdgeIntersection(b,a,edge2,bounds,round),p._code=_getBitCode(p,bounds),clippedPoints.push(p)),clippedPoints.push(a));points=clippedPoints}return points}__name(clipPolygon,"clipPolygon");function polygonCenter(latlngs,crs){var i,j,p1,p2,f,area,x,y,center;if(!latlngs||latlngs.length===0)throw new Error("latlngs not passed");isFlat(latlngs)||(console.warn("latlngs are not flat! Only the first ring will be used"),latlngs=latlngs[0]);var centroidLatLng=toLatLng([0,0]),bounds=toLatLngBounds(latlngs),areaBounds=bounds.getNorthWest().distanceTo(bounds.getSouthWest())*bounds.getNorthEast().distanceTo(bounds.getNorthWest());areaBounds<1700&&(centroidLatLng=centroid(latlngs));var len=latlngs.length,points=[];for(i=0;i<len;i++){var latlng=toLatLng(latlngs[i]);points.push(crs.project(toLatLng([latlng.lat-centroidLatLng.lat,latlng.lng-centroidLatLng.lng])))}for(area=x=y=0,i=0,j=len-1;i<len;j=i++)p1=points[i],p2=points[j],f=p1.y*p2.x-p2.y*p1.x,x+=(p1.x+p2.x)*f,y+=(p1.y+p2.y)*f,area+=f*3;area===0?center=points[0]:center=[x/area,y/area];var latlngCenter=crs.unproject(toPoint(center));return toLatLng([latlngCenter.lat+centroidLatLng.lat,latlngCenter.lng+centroidLatLng.lng])}__name(polygonCenter,"polygonCenter");function centroid(coords){for(var latSum=0,lngSum=0,len=0,i=0;i<coords.length;i++){var latlng=toLatLng(coords[i]);latSum+=latlng.lat,lngSum+=latlng.lng,len++}return toLatLng([latSum/len,lngSum/len])}__name(centroid,"centroid");var PolyUtil={__proto__:null,clipPolygon,polygonCenter,centroid};function simplify(points,tolerance){if(!tolerance||!points.length)return points.slice();var sqTolerance=tolerance*tolerance;return points=_reducePoints(points,sqTolerance),points=_simplifyDP(points,sqTolerance),points}__name(simplify,"simplify");function pointToSegmentDistance(p,p1,p2){return Math.sqrt(_sqClosestPointOnSegment(p,p1,p2,!0))}__name(pointToSegmentDistance,"pointToSegmentDistance");function closestPointOnSegment(p,p1,p2){return _sqClosestPointOnSegment(p,p1,p2)}__name(closestPointOnSegment,"closestPointOnSegment");function _simplifyDP(points,sqTolerance){var len=points.length,ArrayConstructor=typeof Uint8Array<"u"?Uint8Array:Array,markers=new ArrayConstructor(len);markers[0]=markers[len-1]=1,_simplifyDPStep(points,markers,sqTolerance,0,len-1);var i,newPoints=[];for(i=0;i<len;i++)markers[i]&&newPoints.push(points[i]);return newPoints}__name(_simplifyDP,"_simplifyDP");function _simplifyDPStep(points,markers,sqTolerance,first,last){var maxSqDist=0,index2,i,sqDist;for(i=first+1;i<=last-1;i++)sqDist=_sqClosestPointOnSegment(points[i],points[first],points[last],!0),sqDist>maxSqDist&&(index2=i,maxSqDist=sqDist);maxSqDist>sqTolerance&&(markers[index2]=1,_simplifyDPStep(points,markers,sqTolerance,first,index2),_simplifyDPStep(points,markers,sqTolerance,index2,last))}__name(_simplifyDPStep,"_simplifyDPStep");function _reducePoints(points,sqTolerance){for(var reducedPoints=[points[0]],i=1,prev=0,len=points.length;i<len;i++)_sqDist(points[i],points[prev])>sqTolerance&&(reducedPoints.push(points[i]),prev=i);return prev<len-1&&reducedPoints.push(points[len-1]),reducedPoints}__name(_reducePoints,"_reducePoints");var _lastCode;function clipSegment(a,b,bounds,useLastCode,round){var codeA=useLastCode?_lastCode:_getBitCode(a,bounds),codeB=_getBitCode(b,bounds),codeOut,p,newCode;for(_lastCode=codeB;;){if(!(codeA|codeB))return[a,b];if(codeA&codeB)return!1;codeOut=codeA||codeB,p=_getEdgeIntersection(a,b,codeOut,bounds,round),newCode=_getBitCode(p,bounds),codeOut===codeA?(a=p,codeA=newCode):(b=p,codeB=newCode)}}__name(clipSegment,"clipSegment");function _getEdgeIntersection(a,b,code,bounds,round){var dx=b.x-a.x,dy=b.y-a.y,min=bounds.min,max=bounds.max,x,y;return code&8?(x=a.x+dx*(max.y-a.y)/dy,y=max.y):code&4?(x=a.x+dx*(min.y-a.y)/dy,y=min.y):code&2?(x=max.x,y=a.y+dy*(max.x-a.x)/dx):code&1&&(x=min.x,y=a.y+dy*(min.x-a.x)/dx),new Point(x,y,round)}__name(_getEdgeIntersection,"_getEdgeIntersection");function _getBitCode(p,bounds){var code=0;return p.x<bounds.min.x?code|=1:p.x>bounds.max.x&&(code|=2),p.y<bounds.min.y?code|=4:p.y>bounds.max.y&&(code|=8),code}__name(_getBitCode,"_getBitCode");function _sqDist(p1,p2){var dx=p2.x-p1.x,dy=p2.y-p1.y;return dx*dx+dy*dy}__name(_sqDist,"_sqDist");function _sqClosestPointOnSegment(p,p1,p2,sqDist){var x=p1.x,y=p1.y,dx=p2.x-x,dy=p2.y-y,dot=dx*dx+dy*dy,t;return dot>0&&(t=((p.x-x)*dx+(p.y-y)*dy)/dot,t>1?(x=p2.x,y=p2.y):t>0&&(x+=dx*t,y+=dy*t)),dx=p.x-x,dy=p.y-y,sqDist?dx*dx+dy*dy:new Point(x,y)}__name(_sqClosestPointOnSegment,"_sqClosestPointOnSegment");function isFlat(latlngs){return!isArray(latlngs[0])||typeof latlngs[0][0]!="object"&&typeof latlngs[0][0]<"u"}__name(isFlat,"isFlat");function _flat(latlngs){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),isFlat(latlngs)}__name(_flat,"_flat");function polylineCenter(latlngs,crs){var i,halfDist,segDist,dist2,p1,p2,ratio,center;if(!latlngs||latlngs.length===0)throw new Error("latlngs not passed");isFlat(latlngs)||(console.warn("latlngs are not flat! Only the first ring will be used"),latlngs=latlngs[0]);var centroidLatLng=toLatLng([0,0]),bounds=toLatLngBounds(latlngs),areaBounds=bounds.getNorthWest().distanceTo(bounds.getSouthWest())*bounds.getNorthEast().distanceTo(bounds.getNorthWest());areaBounds<1700&&(centroidLatLng=centroid(latlngs));var len=latlngs.length,points=[];for(i=0;i<len;i++){var latlng=toLatLng(latlngs[i]);points.push(crs.project(toLatLng([latlng.lat-centroidLatLng.lat,latlng.lng-centroidLatLng.lng])))}for(i=0,halfDist=0;i<len-1;i++)halfDist+=points[i].distanceTo(points[i+1])/2;if(halfDist===0)center=points[0];else for(i=0,dist2=0;i<len-1;i++)if(p1=points[i],p2=points[i+1],segDist=p1.distanceTo(p2),dist2+=segDist,dist2>halfDist){ratio=(dist2-halfDist)/segDist,center=[p2.x-ratio*(p2.x-p1.x),p2.y-ratio*(p2.y-p1.y)];break}var latlngCenter=crs.unproject(toPoint(center));return toLatLng([latlngCenter.lat+centroidLatLng.lat,latlngCenter.lng+centroidLatLng.lng])}__name(polylineCenter,"polylineCenter");var LineUtil={__proto__:null,simplify,pointToSegmentDistance,closestPointOnSegment,clipSegment,_getEdgeIntersection,_getBitCode,_sqClosestPointOnSegment,isFlat,_flat,polylineCenter},LonLat={project:__name(function(latlng){return new Point(latlng.lng,latlng.lat)},"project"),unproject:__name(function(point){return new LatLng(point.y,point.x)},"unproject"),bounds:new Bounds([-180,-90],[180,90])},Mercator={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Bounds([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:__name(function(latlng){var d=Math.PI/180,r=this.R,y=latlng.lat*d,tmp=this.R_MINOR/r,e=Math.sqrt(1-tmp*tmp),con=e*Math.sin(y),ts=Math.tan(Math.PI/4-y/2)/Math.pow((1-con)/(1+con),e/2);return y=-r*Math.log(Math.max(ts,1e-10)),new Point(latlng.lng*d*r,y)},"project"),unproject:__name(function(point){for(var d=180/Math.PI,r=this.R,tmp=this.R_MINOR/r,e=Math.sqrt(1-tmp*tmp),ts=Math.exp(-point.y/r),phi=Math.PI/2-2*Math.atan(ts),i=0,dphi=.1,con;i<15&&Math.abs(dphi)>1e-7;i++)con=e*Math.sin(phi),con=Math.pow((1-con)/(1+con),e/2),dphi=Math.PI/2-2*Math.atan(ts*con)-phi,phi+=dphi;return new LatLng(phi*d,point.x*d/r)},"unproject")},index={__proto__:null,LonLat,Mercator,SphericalMercator},EPSG3395=extend({},Earth,{code:"EPSG:3395",projection:Mercator,transformation:(function(){var scale2=.5/(Math.PI*Mercator.R);return toTransformation(scale2,.5,-scale2,.5)})()}),EPSG4326=extend({},Earth,{code:"EPSG:4326",projection:LonLat,transformation:toTransformation(1/180,1,-1/180,.5)}),Simple=extend({},CRS,{projection:LonLat,transformation:toTransformation(1,0,-1,0),scale:__name(function(zoom2){return Math.pow(2,zoom2)},"scale"),zoom:__name(function(scale2){return Math.log(scale2)/Math.LN2},"zoom"),distance:__name(function(latlng1,latlng2){var dx=latlng2.lng-latlng1.lng,dy=latlng2.lat-latlng1.lat;return Math.sqrt(dx*dx+dy*dy)},"distance"),infinite:!0});CRS.Earth=Earth,CRS.EPSG3395=EPSG3395,CRS.EPSG3857=EPSG3857,CRS.EPSG900913=EPSG900913,CRS.EPSG4326=EPSG4326,CRS.Simple=Simple;var Layer=Evented.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:__name(function(map2){return map2.addLayer(this),this},"addTo"),remove:__name(function(){return this.removeFrom(this._map||this._mapToAdd)},"remove"),removeFrom:__name(function(obj){return obj&&obj.removeLayer(this),this},"removeFrom"),getPane:__name(function(name){return this._map.getPane(name?this.options[name]||name:this.options.pane)},"getPane"),addInteractiveTarget:__name(function(targetEl){return this._map._targets[stamp(targetEl)]=this,this},"addInteractiveTarget"),removeInteractiveTarget:__name(function(targetEl){return delete this._map._targets[stamp(targetEl)],this},"removeInteractiveTarget"),getAttribution:__name(function(){return this.options.attribution},"getAttribution"),_layerAdd:__name(function(e){var map2=e.target;if(map2.hasLayer(this)){if(this._map=map2,this._zoomAnimated=map2._zoomAnimated,this.getEvents){var events=this.getEvents();map2.on(events,this),this.once("remove",function(){map2.off(events,this)},this)}this.onAdd(map2),this.fire("add"),map2.fire("layeradd",{layer:this})}},"_layerAdd")});Map.include({addLayer:__name(function(layer){if(!layer._layerAdd)throw new Error("The provided object is not a Layer.");var id=stamp(layer);return this._layers[id]?this:(this._layers[id]=layer,layer._mapToAdd=this,layer.beforeAdd&&layer.beforeAdd(this),this.whenReady(layer._layerAdd,layer),this)},"addLayer"),removeLayer:__name(function(layer){var id=stamp(layer);return this._layers[id]?(this._loaded&&layer.onRemove(this),delete this._layers[id],this._loaded&&(this.fire("layerremove",{layer}),layer.fire("remove")),layer._map=layer._mapToAdd=null,this):this},"removeLayer"),hasLayer:__name(function(layer){return stamp(layer)in this._layers},"hasLayer"),eachLayer:__name(function(method,context){for(var i in this._layers)method.call(context,this._layers[i]);return this},"eachLayer"),_addLayers:__name(function(layers2){layers2=layers2?isArray(layers2)?layers2:[layers2]:[];for(var i=0,len=layers2.length;i<len;i++)this.addLayer(layers2[i])},"_addLayers"),_addZoomLimit:__name(function(layer){(!isNaN(layer.options.maxZoom)||!isNaN(layer.options.minZoom))&&(this._zoomBoundLayers[stamp(layer)]=layer,this._updateZoomLevels())},"_addZoomLimit"),_removeZoomLimit:__name(function(layer){var id=stamp(layer);this._zoomBoundLayers[id]&&(delete this._zoomBoundLayers[id],this._updateZoomLevels())},"_removeZoomLimit"),_updateZoomLevels:__name(function(){var minZoom=1/0,maxZoom=-1/0,oldZoomSpan=this._getZoomSpan();for(var i in this._zoomBoundLayers){var options=this._zoomBoundLayers[i].options;minZoom=options.minZoom===void 0?minZoom:Math.min(minZoom,options.minZoom),maxZoom=options.maxZoom===void 0?maxZoom:Math.max(maxZoom,options.maxZoom)}this._layersMaxZoom=maxZoom===-1/0?void 0:maxZoom,this._layersMinZoom=minZoom===1/0?void 0:minZoom,oldZoomSpan!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)},"_updateZoomLevels")});var LayerGroup=Layer.extend({initialize:__name(function(layers2,options){setOptions(this,options),this._layers={};var i,len;if(layers2)for(i=0,len=layers2.length;i<len;i++)this.addLayer(layers2[i])},"initialize"),addLayer:__name(function(layer){var id=this.getLayerId(layer);return this._layers[id]=layer,this._map&&this._map.addLayer(layer),this},"addLayer"),removeLayer:__name(function(layer){var id=layer in this._layers?layer:this.getLayerId(layer);return this._map&&this._layers[id]&&this._map.removeLayer(this._layers[id]),delete this._layers[id],this},"removeLayer"),hasLayer:__name(function(layer){var layerId=typeof layer=="number"?layer:this.getLayerId(layer);return layerId in this._layers},"hasLayer"),clearLayers:__name(function(){return this.eachLayer(this.removeLayer,this)},"clearLayers"),invoke:__name(function(methodName){var args=Array.prototype.slice.call(arguments,1),i,layer;for(i in this._layers)layer=this._layers[i],layer[methodName]&&layer[methodName].apply(layer,args);return this},"invoke"),onAdd:__name(function(map2){this.eachLayer(map2.addLayer,map2)},"onAdd"),onRemove:__name(function(map2){this.eachLayer(map2.removeLayer,map2)},"onRemove"),eachLayer:__name(function(method,context){for(var i in this._layers)method.call(context,this._layers[i]);return this},"eachLayer"),getLayer:__name(function(id){return this._layers[id]},"getLayer"),getLayers:__name(function(){var layers2=[];return this.eachLayer(layers2.push,layers2),layers2},"getLayers"),setZIndex:__name(function(zIndex){return this.invoke("setZIndex",zIndex)},"setZIndex"),getLayerId:__name(function(layer){return stamp(layer)},"getLayerId")}),layerGroup2=__name(function(layers2,options){return new LayerGroup(layers2,options)},"layerGroup"),FeatureGroup=LayerGroup.extend({addLayer:__name(function(layer){return this.hasLayer(layer)?this:(layer.addEventParent(this),LayerGroup.prototype.addLayer.call(this,layer),this.fire("layeradd",{layer}))},"addLayer"),removeLayer:__name(function(layer){return this.hasLayer(layer)?(layer in this._layers&&(layer=this._layers[layer]),layer.removeEventParent(this),LayerGroup.prototype.removeLayer.call(this,layer),this.fire("layerremove",{layer})):this},"removeLayer"),setStyle:__name(function(style2){return this.invoke("setStyle",style2)},"setStyle"),bringToFront:__name(function(){return this.invoke("bringToFront")},"bringToFront"),bringToBack:__name(function(){return this.invoke("bringToBack")},"bringToBack"),getBounds:__name(function(){var bounds=new LatLngBounds;for(var id in this._layers){var layer=this._layers[id];bounds.extend(layer.getBounds?layer.getBounds():layer.getLatLng())}return bounds},"getBounds")}),featureGroup=__name(function(layers2,options){return new FeatureGroup(layers2,options)},"featureGroup"),Icon=Class.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:__name(function(options){setOptions(this,options)},"initialize"),createIcon:__name(function(oldIcon){return this._createIcon("icon",oldIcon)},"createIcon"),createShadow:__name(function(oldIcon){return this._createIcon("shadow",oldIcon)},"createShadow"),_createIcon:__name(function(name,oldIcon){var src=this._getIconUrl(name);if(!src){if(name==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var img=this._createImg(src,oldIcon&&oldIcon.tagName==="IMG"?oldIcon:null);return this._setIconStyles(img,name),(this.options.crossOrigin||this.options.crossOrigin==="")&&(img.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),img},"_createIcon"),_setIconStyles:__name(function(img,name){var options=this.options,sizeOption=options[name+"Size"];typeof sizeOption=="number"&&(sizeOption=[sizeOption,sizeOption]);var size=toPoint(sizeOption),anchor=toPoint(name==="shadow"&&options.shadowAnchor||options.iconAnchor||size&&size.divideBy(2,!0));img.className="leaflet-marker-"+name+" "+(options.className||""),anchor&&(img.style.marginLeft=-anchor.x+"px",img.style.marginTop=-anchor.y+"px"),size&&(img.style.width=size.x+"px",img.style.height=size.y+"px")},"_setIconStyles"),_createImg:__name(function(src,el){return el=el||document.createElement("img"),el.src=src,el},"_createImg"),_getIconUrl:__name(function(name){return Browser.retina&&this.options[name+"RetinaUrl"]||this.options[name+"Url"]},"_getIconUrl")});function icon(options){return new Icon(options)}__name(icon,"icon");var IconDefault=Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:__name(function(name){return typeof IconDefault.imagePath!="string"&&(IconDefault.imagePath=this._detectIconPath()),(this.options.imagePath||IconDefault.imagePath)+Icon.prototype._getIconUrl.call(this,name)},"_getIconUrl"),_stripUrl:__name(function(path){var strip=__name(function(str,re,idx){var match=re.exec(str);return match&&match[idx]},"strip");return path=strip(path,/^url\((['"])?(.+)\1\)$/,2),path&&strip(path,/^(.*)marker-icon\.png$/,1)},"_stripUrl"),_detectIconPath:__name(function(){var el=create$1("div","leaflet-default-icon-path",document.body),path=getStyle(el,"background-image")||getStyle(el,"backgroundImage");if(document.body.removeChild(el),path=this._stripUrl(path),path)return path;var link=document.querySelector('link[href$="leaflet.css"]');return link?link.href.substring(0,link.href.length-11-1):""},"_detectIconPath")}),MarkerDrag=Handler.extend({initialize:__name(function(marker3){this._marker=marker3},"initialize"),addHooks:__name(function(){var icon2=this._marker._icon;this._draggable||(this._draggable=new Draggable(icon2,icon2,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),addClass(icon2,"leaflet-marker-draggable")},"addHooks"),removeHooks:__name(function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&removeClass(this._marker._icon,"leaflet-marker-draggable")},"removeHooks"),moved:__name(function(){return this._draggable&&this._draggable._moved},"moved"),_adjustPan:__name(function(e){var marker3=this._marker,map2=marker3._map,speed=this._marker.options.autoPanSpeed,padding=this._marker.options.autoPanPadding,iconPos=getPosition(marker3._icon),bounds=map2.getPixelBounds(),origin=map2.getPixelOrigin(),panBounds=toBounds(bounds.min._subtract(origin).add(padding),bounds.max._subtract(origin).subtract(padding));if(!panBounds.contains(iconPos)){var movement=toPoint((Math.max(panBounds.max.x,iconPos.x)-panBounds.max.x)/(bounds.max.x-panBounds.max.x)-(Math.min(panBounds.min.x,iconPos.x)-panBounds.min.x)/(bounds.min.x-panBounds.min.x),(Math.max(panBounds.max.y,iconPos.y)-panBounds.max.y)/(bounds.max.y-panBounds.max.y)-(Math.min(panBounds.min.y,iconPos.y)-panBounds.min.y)/(bounds.min.y-panBounds.min.y)).multiplyBy(speed);map2.panBy(movement,{animate:!1}),this._draggable._newPos._add(movement),this._draggable._startPos._add(movement),setPosition(marker3._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=requestAnimFrame(this._adjustPan.bind(this,e))}},"_adjustPan"),_onDragStart:__name(function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},"_onDragStart"),_onPreDrag:__name(function(e){this._marker.options.autoPan&&(cancelAnimFrame(this._panRequest),this._panRequest=requestAnimFrame(this._adjustPan.bind(this,e)))},"_onPreDrag"),_onDrag:__name(function(e){var marker3=this._marker,shadow=marker3._shadow,iconPos=getPosition(marker3._icon),latlng=marker3._map.layerPointToLatLng(iconPos);shadow&&setPosition(shadow,iconPos),marker3._latlng=latlng,e.latlng=latlng,e.oldLatLng=this._oldLatLng,marker3.fire("move",e).fire("drag",e)},"_onDrag"),_onDragEnd:__name(function(e){cancelAnimFrame(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)},"_onDragEnd")}),Marker=Layer.extend({options:{icon:new IconDefault,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:__name(function(latlng,options){setOptions(this,options),this._latlng=toLatLng(latlng)},"initialize"),onAdd:__name(function(map2){this._zoomAnimated=this._zoomAnimated&&map2.options.markerZoomAnimation,this._zoomAnimated&&map2.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},"onAdd"),onRemove:__name(function(map2){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&map2.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},"onRemove"),getEvents:__name(function(){return{zoom:this.update,viewreset:this.update}},"getEvents"),getLatLng:__name(function(){return this._latlng},"getLatLng"),setLatLng:__name(function(latlng){var oldLatLng=this._latlng;return this._latlng=toLatLng(latlng),this.update(),this.fire("move",{oldLatLng,latlng:this._latlng})},"setLatLng"),setZIndexOffset:__name(function(offset){return this.options.zIndexOffset=offset,this.update()},"setZIndexOffset"),getIcon:__name(function(){return this.options.icon},"getIcon"),setIcon:__name(function(icon2){return this.options.icon=icon2,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},"setIcon"),getElement:__name(function(){return this._icon},"getElement"),update:__name(function(){if(this._icon&&this._map){var pos=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(pos)}return this},"update"),_initIcon:__name(function(){var options=this.options,classToAdd="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),icon2=options.icon.createIcon(this._icon),addIcon=!1;icon2!==this._icon&&(this._icon&&this._removeIcon(),addIcon=!0,options.title&&(icon2.title=options.title),icon2.tagName==="IMG"&&(icon2.alt=options.alt||"")),addClass(icon2,classToAdd),options.keyboard&&(icon2.tabIndex="0",icon2.setAttribute("role","button")),this._icon=icon2,options.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&on(icon2,"focus",this._panOnFocus,this);var newShadow=options.icon.createShadow(this._shadow),addShadow=!1;newShadow!==this._shadow&&(this._removeShadow(),addShadow=!0),newShadow&&(addClass(newShadow,classToAdd),newShadow.alt=""),this._shadow=newShadow,options.opacity<1&&this._updateOpacity(),addIcon&&this.getPane().appendChild(this._icon),this._initInteraction(),newShadow&&addShadow&&this.getPane(options.shadowPane).appendChild(this._shadow)},"_initIcon"),_removeIcon:__name(function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&off(this._icon,"focus",this._panOnFocus,this),remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},"_removeIcon"),_removeShadow:__name(function(){this._shadow&&remove(this._shadow),this._shadow=null},"_removeShadow"),_setPos:__name(function(pos){this._icon&&setPosition(this._icon,pos),this._shadow&&setPosition(this._shadow,pos),this._zIndex=pos.y+this.options.zIndexOffset,this._resetZIndex()},"_setPos"),_updateZIndex:__name(function(offset){this._icon&&(this._icon.style.zIndex=this._zIndex+offset)},"_updateZIndex"),_animateZoom:__name(function(opt){var pos=this._map._latLngToNewLayerPoint(this._latlng,opt.zoom,opt.center).round();this._setPos(pos)},"_animateZoom"),_initInteraction:__name(function(){if(this.options.interactive&&(addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),MarkerDrag)){var draggable=this.options.draggable;this.dragging&&(draggable=this.dragging.enabled(),this.dragging.disable()),this.dragging=new MarkerDrag(this),draggable&&this.dragging.enable()}},"_initInteraction"),setOpacity:__name(function(opacity){return this.options.opacity=opacity,this._map&&this._updateOpacity(),this},"setOpacity"),_updateOpacity:__name(function(){var opacity=this.options.opacity;this._icon&&setOpacity(this._icon,opacity),this._shadow&&setOpacity(this._shadow,opacity)},"_updateOpacity"),_bringToFront:__name(function(){this._updateZIndex(this.options.riseOffset)},"_bringToFront"),_resetZIndex:__name(function(){this._updateZIndex(0)},"_resetZIndex"),_panOnFocus:__name(function(){var map2=this._map;if(map2){var iconOpts=this.options.icon.options,size=iconOpts.iconSize?toPoint(iconOpts.iconSize):toPoint(0,0),anchor=iconOpts.iconAnchor?toPoint(iconOpts.iconAnchor):toPoint(0,0);map2.panInside(this._latlng,{paddingTopLeft:anchor,paddingBottomRight:size.subtract(anchor)})}},"_panOnFocus"),_getPopupAnchor:__name(function(){return this.options.icon.options.popupAnchor},"_getPopupAnchor"),_getTooltipAnchor:__name(function(){return this.options.icon.options.tooltipAnchor},"_getTooltipAnchor")});function marker2(latlng,options){return new Marker(latlng,options)}__name(marker2,"marker");var Path=Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:__name(function(map2){this._renderer=map2.getRenderer(this)},"beforeAdd"),onAdd:__name(function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},"onAdd"),onRemove:__name(function(){this._renderer._removePath(this)},"onRemove"),redraw:__name(function(){return this._map&&this._renderer._updatePath(this),this},"redraw"),setStyle:__name(function(style2){return setOptions(this,style2),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&style2&&Object.prototype.hasOwnProperty.call(style2,"weight")&&this._updateBounds()),this},"setStyle"),bringToFront:__name(function(){return this._renderer&&this._renderer._bringToFront(this),this},"bringToFront"),bringToBack:__name(function(){return this._renderer&&this._renderer._bringToBack(this),this},"bringToBack"),getElement:__name(function(){return this._path},"getElement"),_reset:__name(function(){this._project(),this._update()},"_reset"),_clickTolerance:__name(function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)},"_clickTolerance")}),CircleMarker=Path.extend({options:{fill:!0,radius:10},initialize:__name(function(latlng,options){setOptions(this,options),this._latlng=toLatLng(latlng),this._radius=this.options.radius},"initialize"),setLatLng:__name(function(latlng){var oldLatLng=this._latlng;return this._latlng=toLatLng(latlng),this.redraw(),this.fire("move",{oldLatLng,latlng:this._latlng})},"setLatLng"),getLatLng:__name(function(){return this._latlng},"getLatLng"),setRadius:__name(function(radius){return this.options.radius=this._radius=radius,this.redraw()},"setRadius"),getRadius:__name(function(){return this._radius},"getRadius"),setStyle:__name(function(options){var radius=options&&options.radius||this._radius;return Path.prototype.setStyle.call(this,options),this.setRadius(radius),this},"setStyle"),_project:__name(function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},"_project"),_updateBounds:__name(function(){var r=this._radius,r2=this._radiusY||r,w=this._clickTolerance(),p=[r+w,r2+w];this._pxBounds=new Bounds(this._point.subtract(p),this._point.add(p))},"_updateBounds"),_update:__name(function(){this._map&&this._updatePath()},"_update"),_updatePath:__name(function(){this._renderer._updateCircle(this)},"_updatePath"),_empty:__name(function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},"_empty"),_containsPoint:__name(function(p){return p.distanceTo(this._point)<=this._radius+this._clickTolerance()},"_containsPoint")});function circleMarker(latlng,options){return new CircleMarker(latlng,options)}__name(circleMarker,"circleMarker");var Circle=CircleMarker.extend({initialize:__name(function(latlng,options,legacyOptions){if(typeof options=="number"&&(options=extend({},legacyOptions,{radius:options})),setOptions(this,options),this._latlng=toLatLng(latlng),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},"initialize"),setRadius:__name(function(radius){return this._mRadius=radius,this.redraw()},"setRadius"),getRadius:__name(function(){return this._mRadius},"getRadius"),getBounds:__name(function(){var half=[this._radius,this._radiusY||this._radius];return new LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(half)),this._map.layerPointToLatLng(this._point.add(half)))},"getBounds"),setStyle:Path.prototype.setStyle,_project:__name(function(){var lng=this._latlng.lng,lat=this._latlng.lat,map2=this._map,crs=map2.options.crs;if(crs.distance===Earth.distance){var d=Math.PI/180,latR=this._mRadius/Earth.R/d,top=map2.project([lat+latR,lng]),bottom=map2.project([lat-latR,lng]),p=top.add(bottom).divideBy(2),lat2=map2.unproject(p).lat,lngR=Math.acos((Math.cos(latR*d)-Math.sin(lat*d)*Math.sin(lat2*d))/(Math.cos(lat*d)*Math.cos(lat2*d)))/d;(isNaN(lngR)||lngR===0)&&(lngR=latR/Math.cos(Math.PI/180*lat)),this._point=p.subtract(map2.getPixelOrigin()),this._radius=isNaN(lngR)?0:p.x-map2.project([lat2,lng-lngR]).x,this._radiusY=p.y-top.y}else{var latlng2=crs.unproject(crs.project(this._latlng).subtract([this._mRadius,0]));this._point=map2.latLngToLayerPoint(this._latlng),this._radius=this._point.x-map2.latLngToLayerPoint(latlng2).x}this._updateBounds()},"_project")});function circle(latlng,options,legacyOptions){return new Circle(latlng,options,legacyOptions)}__name(circle,"circle");var Polyline=Path.extend({options:{smoothFactor:1,noClip:!1},initialize:__name(function(latlngs,options){setOptions(this,options),this._setLatLngs(latlngs)},"initialize"),getLatLngs:__name(function(){return this._latlngs},"getLatLngs"),setLatLngs:__name(function(latlngs){return this._setLatLngs(latlngs),this.redraw()},"setLatLngs"),isEmpty:__name(function(){return!this._latlngs.length},"isEmpty"),closestLayerPoint:__name(function(p){for(var minDistance=1/0,minPoint=null,closest=_sqClosestPointOnSegment,p1,p2,j=0,jLen=this._parts.length;j<jLen;j++)for(var points=this._parts[j],i=1,len=points.length;i<len;i++){p1=points[i-1],p2=points[i];var sqDist=closest(p,p1,p2,!0);sqDist<minDistance&&(minDistance=sqDist,minPoint=closest(p,p1,p2))}return minPoint&&(minPoint.distance=Math.sqrt(minDistance)),minPoint},"closestLayerPoint"),getCenter:__name(function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return polylineCenter(this._defaultShape(),this._map.options.crs)},"getCenter"),getBounds:__name(function(){return this._bounds},"getBounds"),addLatLng:__name(function(latlng,latlngs){return latlngs=latlngs||this._defaultShape(),latlng=toLatLng(latlng),latlngs.push(latlng),this._bounds.extend(latlng),this.redraw()},"addLatLng"),_setLatLngs:__name(function(latlngs){this._bounds=new LatLngBounds,this._latlngs=this._convertLatLngs(latlngs)},"_setLatLngs"),_defaultShape:__name(function(){return isFlat(this._latlngs)?this._latlngs:this._latlngs[0]},"_defaultShape"),_convertLatLngs:__name(function(latlngs){for(var result=[],flat=isFlat(latlngs),i=0,len=latlngs.length;i<len;i++)flat?(result[i]=toLatLng(latlngs[i]),this._bounds.extend(result[i])):result[i]=this._convertLatLngs(latlngs[i]);return result},"_convertLatLngs"),_project:__name(function(){var pxBounds=new Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,pxBounds),this._bounds.isValid()&&pxBounds.isValid()&&(this._rawPxBounds=pxBounds,this._updateBounds())},"_project"),_updateBounds:__name(function(){var w=this._clickTolerance(),p=new Point(w,w);this._rawPxBounds&&(this._pxBounds=new Bounds([this._rawPxBounds.min.subtract(p),this._rawPxBounds.max.add(p)]))},"_updateBounds"),_projectLatlngs:__name(function(latlngs,result,projectedBounds){var flat=latlngs[0]instanceof LatLng,len=latlngs.length,i,ring;if(flat){for(ring=[],i=0;i<len;i++)ring[i]=this._map.latLngToLayerPoint(latlngs[i]),projectedBounds.extend(ring[i]);result.push(ring)}else for(i=0;i<len;i++)this._projectLatlngs(latlngs[i],result,projectedBounds)},"_projectLatlngs"),_clipPoints:__name(function(){var bounds=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(bounds))){if(this.options.noClip){this._parts=this._rings;return}var parts=this._parts,i,j,k,len,len2,segment,points;for(i=0,k=0,len=this._rings.length;i<len;i++)for(points=this._rings[i],j=0,len2=points.length;j<len2-1;j++)segment=clipSegment(points[j],points[j+1],bounds,j,!0),segment&&(parts[k]=parts[k]||[],parts[k].push(segment[0]),(segment[1]!==points[j+1]||j===len2-2)&&(parts[k].push(segment[1]),k++))}},"_clipPoints"),_simplifyPoints:__name(function(){for(var parts=this._parts,tolerance=this.options.smoothFactor,i=0,len=parts.length;i<len;i++)parts[i]=simplify(parts[i],tolerance)},"_simplifyPoints"),_update:__name(function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},"_update"),_updatePath:__name(function(){this._renderer._updatePoly(this)},"_updatePath"),_containsPoint:__name(function(p,closed){var i,j,k,len,len2,part,w=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(p))return!1;for(i=0,len=this._parts.length;i<len;i++)for(part=this._parts[i],j=0,len2=part.length,k=len2-1;j<len2;k=j++)if(!(!closed&&j===0)&&pointToSegmentDistance(p,part[k],part[j])<=w)return!0;return!1},"_containsPoint")});function polyline(latlngs,options){return new Polyline(latlngs,options)}__name(polyline,"polyline"),Polyline._flat=_flat;var Polygon=Polyline.extend({options:{fill:!0},isEmpty:__name(function(){return!this._latlngs.length||!this._latlngs[0].length},"isEmpty"),getCenter:__name(function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return polygonCenter(this._defaultShape(),this._map.options.crs)},"getCenter"),_convertLatLngs:__name(function(latlngs){var result=Polyline.prototype._convertLatLngs.call(this,latlngs),len=result.length;return len>=2&&result[0]instanceof LatLng&&result[0].equals(result[len-1])&&result.pop(),result},"_convertLatLngs"),_setLatLngs:__name(function(latlngs){Polyline.prototype._setLatLngs.call(this,latlngs),isFlat(this._latlngs)&&(this._latlngs=[this._latlngs])},"_setLatLngs"),_defaultShape:__name(function(){return isFlat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},"_defaultShape"),_clipPoints:__name(function(){var bounds=this._renderer._bounds,w=this.options.weight,p=new Point(w,w);if(bounds=new Bounds(bounds.min.subtract(p),bounds.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(bounds))){if(this.options.noClip){this._parts=this._rings;return}for(var i=0,len=this._rings.length,clipped;i<len;i++)clipped=clipPolygon(this._rings[i],bounds,!0),clipped.length&&this._parts.push(clipped)}},"_clipPoints"),_updatePath:__name(function(){this._renderer._updatePoly(this,!0)},"_updatePath"),_containsPoint:__name(function(p){var inside=!1,part,p1,p2,i,j,k,len,len2;if(!this._pxBounds||!this._pxBounds.contains(p))return!1;for(i=0,len=this._parts.length;i<len;i++)for(part=this._parts[i],j=0,len2=part.length,k=len2-1;j<len2;k=j++)p1=part[j],p2=part[k],p1.y>p.y!=p2.y>p.y&&p.x<(p2.x-p1.x)*(p.y-p1.y)/(p2.y-p1.y)+p1.x&&(inside=!inside);return inside||Polyline.prototype._containsPoint.call(this,p,!0)},"_containsPoint")});function polygon(latlngs,options){return new Polygon(latlngs,options)}__name(polygon,"polygon");var GeoJSON=FeatureGroup.extend({initialize:__name(function(geojson,options){setOptions(this,options),this._layers={},geojson&&this.addData(geojson)},"initialize"),addData:__name(function(geojson){var features=isArray(geojson)?geojson:geojson.features,i,len,feature;if(features){for(i=0,len=features.length;i<len;i++)feature=features[i],(feature.geometries||feature.geometry||feature.features||feature.coordinates)&&this.addData(feature);return this}var options=this.options;if(options.filter&&!options.filter(geojson))return this;var layer=geometryToLayer(geojson,options);return layer?(layer.feature=asFeature(geojson),layer.defaultOptions=layer.options,this.resetStyle(layer),options.onEachFeature&&options.onEachFeature(geojson,layer),this.addLayer(layer)):this},"addData"),resetStyle:__name(function(layer){return layer===void 0?this.eachLayer(this.resetStyle,this):(layer.options=extend({},layer.defaultOptions),this._setLayerStyle(layer,this.options.style),this)},"resetStyle"),setStyle:__name(function(style2){return this.eachLayer(function(layer){this._setLayerStyle(layer,style2)},this)},"setStyle"),_setLayerStyle:__name(function(layer,style2){layer.setStyle&&(typeof style2=="function"&&(style2=style2(layer.feature)),layer.setStyle(style2))},"_setLayerStyle")});function geometryToLayer(geojson,options){var geometry=geojson.type==="Feature"?geojson.geometry:geojson,coords=geometry?geometry.coordinates:null,layers2=[],pointToLayer=options&&options.pointToLayer,_coordsToLatLng=options&&options.coordsToLatLng||coordsToLatLng,latlng,latlngs,i,len;if(!coords&&!geometry)return null;switch(geometry.type){case"Point":return latlng=_coordsToLatLng(coords),_pointToLayer(pointToLayer,geojson,latlng,options);case"MultiPoint":for(i=0,len=coords.length;i<len;i++)latlng=_coordsToLatLng(coords[i]),layers2.push(_pointToLayer(pointToLayer,geojson,latlng,options));return new FeatureGroup(layers2);case"LineString":case"MultiLineString":return latlngs=coordsToLatLngs(coords,geometry.type==="LineString"?0:1,_coordsToLatLng),new Polyline(latlngs,options);case"Polygon":case"MultiPolygon":return latlngs=coordsToLatLngs(coords,geometry.type==="Polygon"?1:2,_coordsToLatLng),new Polygon(latlngs,options);case"GeometryCollection":for(i=0,len=geometry.geometries.length;i<len;i++){var geoLayer=geometryToLayer({geometry:geometry.geometries[i],type:"Feature",properties:geojson.properties},options);geoLayer&&layers2.push(geoLayer)}return new FeatureGroup(layers2);case"FeatureCollection":for(i=0,len=geometry.features.length;i<len;i++){var featureLayer=geometryToLayer(geometry.features[i],options);featureLayer&&layers2.push(featureLayer)}return new FeatureGroup(layers2);default:throw new Error("Invalid GeoJSON object.")}}__name(geometryToLayer,"geometryToLayer");function _pointToLayer(pointToLayerFn,geojson,latlng,options){return pointToLayerFn?pointToLayerFn(geojson,latlng):new Marker(latlng,options&&options.markersInheritOptions&&options)}__name(_pointToLayer,"_pointToLayer");function coordsToLatLng(coords){return new LatLng(coords[1],coords[0],coords[2])}__name(coordsToLatLng,"coordsToLatLng");function coordsToLatLngs(coords,levelsDeep,_coordsToLatLng){for(var latlngs=[],i=0,len=coords.length,latlng;i<len;i++)latlng=levelsDeep?coordsToLatLngs(coords[i],levelsDeep-1,_coordsToLatLng):(_coordsToLatLng||coordsToLatLng)(coords[i]),latlngs.push(latlng);return latlngs}__name(coordsToLatLngs,"coordsToLatLngs");function latLngToCoords(latlng,precision){return latlng=toLatLng(latlng),latlng.alt!==void 0?[formatNum(latlng.lng,precision),formatNum(latlng.lat,precision),formatNum(latlng.alt,precision)]:[formatNum(latlng.lng,precision),formatNum(latlng.lat,precision)]}__name(latLngToCoords,"latLngToCoords");function latLngsToCoords(latlngs,levelsDeep,closed,precision){for(var coords=[],i=0,len=latlngs.length;i<len;i++)coords.push(levelsDeep?latLngsToCoords(latlngs[i],isFlat(latlngs[i])?0:levelsDeep-1,closed,precision):latLngToCoords(latlngs[i],precision));return!levelsDeep&&closed&&coords.length>0&&coords.push(coords[0].slice()),coords}__name(latLngsToCoords,"latLngsToCoords");function getFeature(layer,newGeometry){return layer.feature?extend({},layer.feature,{geometry:newGeometry}):asFeature(newGeometry)}__name(getFeature,"getFeature");function asFeature(geojson){return geojson.type==="Feature"||geojson.type==="FeatureCollection"?geojson:{type:"Feature",properties:{},geometry:geojson}}__name(asFeature,"asFeature");var PointToGeoJSON={toGeoJSON:__name(function(precision){return getFeature(this,{type:"Point",coordinates:latLngToCoords(this.getLatLng(),precision)})},"toGeoJSON")};Marker.include(PointToGeoJSON),Circle.include(PointToGeoJSON),CircleMarker.include(PointToGeoJSON),Polyline.include({toGeoJSON:__name(function(precision){var multi=!isFlat(this._latlngs),coords=latLngsToCoords(this._latlngs,multi?1:0,!1,precision);return getFeature(this,{type:(multi?"Multi":"")+"LineString",coordinates:coords})},"toGeoJSON")}),Polygon.include({toGeoJSON:__name(function(precision){var holes=!isFlat(this._latlngs),multi=holes&&!isFlat(this._latlngs[0]),coords=latLngsToCoords(this._latlngs,multi?2:holes?1:0,!0,precision);return holes||(coords=[coords]),getFeature(this,{type:(multi?"Multi":"")+"Polygon",coordinates:coords})},"toGeoJSON")}),LayerGroup.include({toMultiPoint:__name(function(precision){var coords=[];return this.eachLayer(function(layer){coords.push(layer.toGeoJSON(precision).geometry.coordinates)}),getFeature(this,{type:"MultiPoint",coordinates:coords})},"toMultiPoint"),toGeoJSON:__name(function(precision){var type=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(type==="MultiPoint")return this.toMultiPoint(precision);var isGeometryCollection=type==="GeometryCollection",jsons=[];return this.eachLayer(function(layer){if(layer.toGeoJSON){var json=layer.toGeoJSON(precision);if(isGeometryCollection)jsons.push(json.geometry);else{var feature=asFeature(json);feature.type==="FeatureCollection"?jsons.push.apply(jsons,feature.features):jsons.push(feature)}}}),isGeometryCollection?getFeature(this,{geometries:jsons,type:"GeometryCollection"}):{type:"FeatureCollection",features:jsons}},"toGeoJSON")});function geoJSON(geojson,options){return new GeoJSON(geojson,options)}__name(geoJSON,"geoJSON");var geoJson=geoJSON,ImageOverlay=Layer.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:__name(function(url,bounds,options){this._url=url,this._bounds=toLatLngBounds(bounds),setOptions(this,options)},"initialize"),onAdd:__name(function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},"onAdd"),onRemove:__name(function(){remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},"onRemove"),setOpacity:__name(function(opacity){return this.options.opacity=opacity,this._image&&this._updateOpacity(),this},"setOpacity"),setStyle:__name(function(styleOpts){return styleOpts.opacity&&this.setOpacity(styleOpts.opacity),this},"setStyle"),bringToFront:__name(function(){return this._map&&toFront(this._image),this},"bringToFront"),bringToBack:__name(function(){return this._map&&toBack(this._image),this},"bringToBack"),setUrl:__name(function(url){return this._url=url,this._image&&(this._image.src=url),this},"setUrl"),setBounds:__name(function(bounds){return this._bounds=toLatLngBounds(bounds),this._map&&this._reset(),this},"setBounds"),getEvents:__name(function(){var events={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(events.zoomanim=this._animateZoom),events},"getEvents"),setZIndex:__name(function(value){return this.options.zIndex=value,this._updateZIndex(),this},"setZIndex"),getBounds:__name(function(){return this._bounds},"getBounds"),getElement:__name(function(){return this._image},"getElement"),_initImage:__name(function(){var wasElementSupplied=this._url.tagName==="IMG",img=this._image=wasElementSupplied?this._url:create$1("img");if(addClass(img,"leaflet-image-layer"),this._zoomAnimated&&addClass(img,"leaflet-zoom-animated"),this.options.className&&addClass(img,this.options.className),img.onselectstart=falseFn,img.onmousemove=falseFn,img.onload=bind(this.fire,this,"load"),img.onerror=bind(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(img.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),wasElementSupplied){this._url=img.src;return}img.src=this._url,img.alt=this.options.alt},"_initImage"),_animateZoom:__name(function(e){var scale2=this._map.getZoomScale(e.zoom),offset=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;setTransform(this._image,offset,scale2)},"_animateZoom"),_reset:__name(function(){var image=this._image,bounds=new Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),size=bounds.getSize();setPosition(image,bounds.min),image.style.width=size.x+"px",image.style.height=size.y+"px"},"_reset"),_updateOpacity:__name(function(){setOpacity(this._image,this.options.opacity)},"_updateOpacity"),_updateZIndex:__name(function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},"_updateZIndex"),_overlayOnError:__name(function(){this.fire("error");var errorUrl=this.options.errorOverlayUrl;errorUrl&&this._url!==errorUrl&&(this._url=errorUrl,this._image.src=errorUrl)},"_overlayOnError"),getCenter:__name(function(){return this._bounds.getCenter()},"getCenter")}),imageOverlay2=__name(function(url,bounds,options){return new ImageOverlay(url,bounds,options)},"imageOverlay"),VideoOverlay=ImageOverlay.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:__name(function(){var wasElementSupplied=this._url.tagName==="VIDEO",vid=this._image=wasElementSupplied?this._url:create$1("video");if(addClass(vid,"leaflet-image-layer"),this._zoomAnimated&&addClass(vid,"leaflet-zoom-animated"),this.options.className&&addClass(vid,this.options.className),vid.onselectstart=falseFn,vid.onmousemove=falseFn,vid.onloadeddata=bind(this.fire,this,"load"),wasElementSupplied){for(var sourceElements=vid.getElementsByTagName("source"),sources=[],j=0;j<sourceElements.length;j++)sources.push(sourceElements[j].src);this._url=sourceElements.length>0?sources:[vid.src];return}isArray(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(vid.style,"objectFit")&&(vid.style.objectFit="fill"),vid.autoplay=!!this.options.autoplay,vid.loop=!!this.options.loop,vid.muted=!!this.options.muted,vid.playsInline=!!this.options.playsInline;for(var i=0;i<this._url.length;i++){var source=create$1("source");source.src=this._url[i],vid.appendChild(source)}},"_initImage")});function videoOverlay(video,bounds,options){return new VideoOverlay(video,bounds,options)}__name(videoOverlay,"videoOverlay");var SVGOverlay=ImageOverlay.extend({_initImage:__name(function(){var el=this._image=this._url;addClass(el,"leaflet-image-layer"),this._zoomAnimated&&addClass(el,"leaflet-zoom-animated"),this.options.className&&addClass(el,this.options.className),el.onselectstart=falseFn,el.onmousemove=falseFn},"_initImage")});function svgOverlay(el,bounds,options){return new SVGOverlay(el,bounds,options)}__name(svgOverlay,"svgOverlay");var DivOverlay=Layer.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:__name(function(options,source){options&&(options instanceof LatLng||isArray(options))?(this._latlng=toLatLng(options),setOptions(this,source)):(setOptions(this,options),this._source=source),this.options.content&&(this._content=this.options.content)},"initialize"),openOn:__name(function(map2){return map2=arguments.length?map2:this._source._map,map2.hasLayer(this)||map2.addLayer(this),this},"openOn"),close:__name(function(){return this._map&&this._map.removeLayer(this),this},"close"),toggle:__name(function(layer){return this._map?this.close():(arguments.length?this._source=layer:layer=this._source,this._prepareOpen(),this.openOn(layer._map)),this},"toggle"),onAdd:__name(function(map2){this._zoomAnimated=map2._zoomAnimated,this._container||this._initLayout(),map2._fadeAnimated&&setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),map2._fadeAnimated&&setOpacity(this._container,1),this.bringToFront(),this.options.interactive&&(addClass(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},"onAdd"),onRemove:__name(function(map2){map2._fadeAnimated?(setOpacity(this._container,0),this._removeTimeout=setTimeout(bind(remove,void 0,this._container),200)):remove(this._container),this.options.interactive&&(removeClass(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},"onRemove"),getLatLng:__name(function(){return this._latlng},"getLatLng"),setLatLng:__name(function(latlng){return this._latlng=toLatLng(latlng),this._map&&(this._updatePosition(),this._adjustPan()),this},"setLatLng"),getContent:__name(function(){return this._content},"getContent"),setContent:__name(function(content){return this._content=content,this.update(),this},"setContent"),getElement:__name(function(){return this._container},"getElement"),update:__name(function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},"update"),getEvents:__name(function(){var events={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(events.zoomanim=this._animateZoom),events},"getEvents"),isOpen:__name(function(){return!!this._map&&this._map.hasLayer(this)},"isOpen"),bringToFront:__name(function(){return this._map&&toFront(this._container),this},"bringToFront"),bringToBack:__name(function(){return this._map&&toBack(this._container),this},"bringToBack"),_prepareOpen:__name(function(latlng){var source=this._source;if(!source._map)return!1;if(source instanceof FeatureGroup){source=null;var layers2=this._source._layers;for(var id in layers2)if(layers2[id]._map){source=layers2[id];break}if(!source)return!1;this._source=source}if(!latlng)if(source.getCenter)latlng=source.getCenter();else if(source.getLatLng)latlng=source.getLatLng();else if(source.getBounds)latlng=source.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(latlng),this._map&&this.update(),!0},"_prepareOpen"),_updateContent:__name(function(){if(this._content){var node=this._contentNode,content=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof content=="string")node.innerHTML=content;else{for(;node.hasChildNodes();)node.removeChild(node.firstChild);node.appendChild(content)}this.fire("contentupdate")}},"_updateContent"),_updatePosition:__name(function(){if(this._map){var pos=this._map.latLngToLayerPoint(this._latlng),offset=toPoint(this.options.offset),anchor=this._getAnchor();this._zoomAnimated?setPosition(this._container,pos.add(anchor)):offset=offset.add(pos).add(anchor);var bottom=this._containerBottom=-offset.y,left=this._containerLeft=-Math.round(this._containerWidth/2)+offset.x;this._container.style.bottom=bottom+"px",this._container.style.left=left+"px"}},"_updatePosition"),_getAnchor:__name(function(){return[0,0]},"_getAnchor")});Map.include({_initOverlay:__name(function(OverlayClass,content,latlng,options){var overlay=content;return overlay instanceof OverlayClass||(overlay=new OverlayClass(options).setContent(content)),latlng&&overlay.setLatLng(latlng),overlay},"_initOverlay")}),Layer.include({_initOverlay:__name(function(OverlayClass,old,content,options){var overlay=content;return overlay instanceof OverlayClass?(setOptions(overlay,options),overlay._source=this):(overlay=old&&!options?old:new OverlayClass(options,this),overlay.setContent(content)),overlay},"_initOverlay")});var Popup=DivOverlay.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:__name(function(map2){return map2=arguments.length?map2:this._source._map,!map2.hasLayer(this)&&map2._popup&&map2._popup.options.autoClose&&map2.removeLayer(map2._popup),map2._popup=this,DivOverlay.prototype.openOn.call(this,map2)},"openOn"),onAdd:__name(function(map2){DivOverlay.prototype.onAdd.call(this,map2),map2.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Path||this._source.on("preclick",stopPropagation))},"onAdd"),onRemove:__name(function(map2){DivOverlay.prototype.onRemove.call(this,map2),map2.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Path||this._source.off("preclick",stopPropagation))},"onRemove"),getEvents:__name(function(){var events=DivOverlay.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(events.preclick=this.close),this.options.keepInView&&(events.moveend=this._adjustPan),events},"getEvents"),_initLayout:__name(function(){var prefix="leaflet-popup",container=this._container=create$1("div",prefix+" "+(this.options.className||"")+" leaflet-zoom-animated"),wrapper=this._wrapper=create$1("div",prefix+"-content-wrapper",container);if(this._contentNode=create$1("div",prefix+"-content",wrapper),disableClickPropagation(container),disableScrollPropagation(this._contentNode),on(container,"contextmenu",stopPropagation),this._tipContainer=create$1("div",prefix+"-tip-container",container),this._tip=create$1("div",prefix+"-tip",this._tipContainer),this.options.closeButton){var closeButton=this._closeButton=create$1("a",prefix+"-close-button",container);closeButton.setAttribute("role","button"),closeButton.setAttribute("aria-label","Close popup"),closeButton.href="#close",closeButton.innerHTML='<span aria-hidden="true">&#215;</span>',on(closeButton,"click",function(ev){preventDefault(ev),this.close()},this)}},"_initLayout"),_updateLayout:__name(function(){var container=this._contentNode,style2=container.style;style2.width="",style2.whiteSpace="nowrap";var width=container.offsetWidth;width=Math.min(width,this.options.maxWidth),width=Math.max(width,this.options.minWidth),style2.width=width+1+"px",style2.whiteSpace="",style2.height="";var height=container.offsetHeight,maxHeight=this.options.maxHeight,scrolledClass="leaflet-popup-scrolled";maxHeight&&height>maxHeight?(style2.height=maxHeight+"px",addClass(container,scrolledClass)):removeClass(container,scrolledClass),this._containerWidth=this._container.offsetWidth},"_updateLayout"),_animateZoom:__name(function(e){var pos=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),anchor=this._getAnchor();setPosition(this._container,pos.add(anchor))},"_animateZoom"),_adjustPan:__name(function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var map2=this._map,marginBottom=parseInt(getStyle(this._container,"marginBottom"),10)||0,containerHeight=this._container.offsetHeight+marginBottom,containerWidth=this._containerWidth,layerPos=new Point(this._containerLeft,-containerHeight-this._containerBottom);layerPos._add(getPosition(this._container));var containerPos=map2.layerPointToContainerPoint(layerPos),padding=toPoint(this.options.autoPanPadding),paddingTL=toPoint(this.options.autoPanPaddingTopLeft||padding),paddingBR=toPoint(this.options.autoPanPaddingBottomRight||padding),size=map2.getSize(),dx=0,dy=0;containerPos.x+containerWidth+paddingBR.x>size.x&&(dx=containerPos.x+containerWidth-size.x+paddingBR.x),containerPos.x-dx-paddingTL.x<0&&(dx=containerPos.x-paddingTL.x),containerPos.y+containerHeight+paddingBR.y>size.y&&(dy=containerPos.y+containerHeight-size.y+paddingBR.y),containerPos.y-dy-paddingTL.y<0&&(dy=containerPos.y-paddingTL.y),(dx||dy)&&(this.options.keepInView&&(this._autopanning=!0),map2.fire("autopanstart").panBy([dx,dy]))}},"_adjustPan"),_getAnchor:__name(function(){return toPoint(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])},"_getAnchor")}),popup=__name(function(options,source){return new Popup(options,source)},"popup");Map.mergeOptions({closePopupOnClick:!0}),Map.include({openPopup:__name(function(popup2,latlng,options){return this._initOverlay(Popup,popup2,latlng,options).openOn(this),this},"openPopup"),closePopup:__name(function(popup2){return popup2=arguments.length?popup2:this._popup,popup2&&popup2.close(),this},"closePopup")}),Layer.include({bindPopup:__name(function(content,options){return this._popup=this._initOverlay(Popup,this._popup,content,options),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},"bindPopup"),unbindPopup:__name(function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},"unbindPopup"),openPopup:__name(function(latlng){return this._popup&&(this instanceof FeatureGroup||(this._popup._source=this),this._popup._prepareOpen(latlng||this._latlng)&&this._popup.openOn(this._map)),this},"openPopup"),closePopup:__name(function(){return this._popup&&this._popup.close(),this},"closePopup"),togglePopup:__name(function(){return this._popup&&this._popup.toggle(this),this},"togglePopup"),isPopupOpen:__name(function(){return this._popup?this._popup.isOpen():!1},"isPopupOpen"),setPopupContent:__name(function(content){return this._popup&&this._popup.setContent(content),this},"setPopupContent"),getPopup:__name(function(){return this._popup},"getPopup"),_openPopup:__name(function(e){if(!(!this._popup||!this._map)){stop(e);var target=e.layer||e.target;if(this._popup._source===target&&!(target instanceof Path)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng);return}this._popup._source=target,this.openPopup(e.latlng)}},"_openPopup"),_movePopup:__name(function(e){this._popup.setLatLng(e.latlng)},"_movePopup"),_onKeyPress:__name(function(e){e.originalEvent.keyCode===13&&this._openPopup(e)},"_onKeyPress")});var Tooltip=DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:__name(function(map2){DivOverlay.prototype.onAdd.call(this,map2),this.setOpacity(this.options.opacity),map2.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},"onAdd"),onRemove:__name(function(map2){DivOverlay.prototype.onRemove.call(this,map2),map2.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},"onRemove"),getEvents:__name(function(){var events=DivOverlay.prototype.getEvents.call(this);return this.options.permanent||(events.preclick=this.close),events},"getEvents"),_initLayout:__name(function(){var prefix="leaflet-tooltip",className=prefix+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=create$1("div",className),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+stamp(this))},"_initLayout"),_updateLayout:__name(function(){},"_updateLayout"),_adjustPan:__name(function(){},"_adjustPan"),_setPosition:__name(function(pos){var subX,subY,map2=this._map,container=this._container,centerPoint=map2.latLngToContainerPoint(map2.getCenter()),tooltipPoint=map2.layerPointToContainerPoint(pos),direction=this.options.direction,tooltipWidth=container.offsetWidth,tooltipHeight=container.offsetHeight,offset=toPoint(this.options.offset),anchor=this._getAnchor();direction==="top"?(subX=tooltipWidth/2,subY=tooltipHeight):direction==="bottom"?(subX=tooltipWidth/2,subY=0):direction==="center"?(subX=tooltipWidth/2,subY=tooltipHeight/2):direction==="right"?(subX=0,subY=tooltipHeight/2):direction==="left"?(subX=tooltipWidth,subY=tooltipHeight/2):tooltipPoint.x<centerPoint.x?(direction="right",subX=0,subY=tooltipHeight/2):(direction="left",subX=tooltipWidth+(offset.x+anchor.x)*2,subY=tooltipHeight/2),pos=pos.subtract(toPoint(subX,subY,!0)).add(offset).add(anchor),removeClass(container,"leaflet-tooltip-right"),removeClass(container,"leaflet-tooltip-left"),removeClass(container,"leaflet-tooltip-top"),removeClass(container,"leaflet-tooltip-bottom"),addClass(container,"leaflet-tooltip-"+direction),setPosition(container,pos)},"_setPosition"),_updatePosition:__name(function(){var pos=this._map.latLngToLayerPoint(this._latlng);this._setPosition(pos)},"_updatePosition"),setOpacity:__name(function(opacity){this.options.opacity=opacity,this._container&&setOpacity(this._container,opacity)},"setOpacity"),_animateZoom:__name(function(e){var pos=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(pos)},"_animateZoom"),_getAnchor:__name(function(){return toPoint(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])},"_getAnchor")}),tooltip=__name(function(options,source){return new Tooltip(options,source)},"tooltip");Map.include({openTooltip:__name(function(tooltip2,latlng,options){return this._initOverlay(Tooltip,tooltip2,latlng,options).openOn(this),this},"openTooltip"),closeTooltip:__name(function(tooltip2){return tooltip2.close(),this},"closeTooltip")}),Layer.include({bindTooltip:__name(function(content,options){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Tooltip,this._tooltip,content,options),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},"bindTooltip"),unbindTooltip:__name(function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},"unbindTooltip"),_initTooltipInteractions:__name(function(remove2){if(!(!remove2&&this._tooltipHandlersAdded)){var onOff=remove2?"off":"on",events={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?events.add=this._openTooltip:(events.mouseover=this._openTooltip,events.mouseout=this.closeTooltip,events.click=this._openTooltip,this._map?this._addFocusListeners():events.add=this._addFocusListeners),this._tooltip.options.sticky&&(events.mousemove=this._moveTooltip),this[onOff](events),this._tooltipHandlersAdded=!remove2}},"_initTooltipInteractions"),openTooltip:__name(function(latlng){return this._tooltip&&(this instanceof FeatureGroup||(this._tooltip._source=this),this._tooltip._prepareOpen(latlng)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},"openTooltip"),closeTooltip:__name(function(){if(this._tooltip)return this._tooltip.close()},"closeTooltip"),toggleTooltip:__name(function(){return this._tooltip&&this._tooltip.toggle(this),this},"toggleTooltip"),isTooltipOpen:__name(function(){return this._tooltip.isOpen()},"isTooltipOpen"),setTooltipContent:__name(function(content){return this._tooltip&&this._tooltip.setContent(content),this},"setTooltipContent"),getTooltip:__name(function(){return this._tooltip},"getTooltip"),_addFocusListeners:__name(function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},"_addFocusListeners"),_addFocusListenersOnLayer:__name(function(layer){var el=typeof layer.getElement=="function"&&layer.getElement();el&&(on(el,"focus",function(){this._tooltip._source=layer,this.openTooltip()},this),on(el,"blur",this.closeTooltip,this))},"_addFocusListenersOnLayer"),_setAriaDescribedByOnLayer:__name(function(layer){var el=typeof layer.getElement=="function"&&layer.getElement();el&&el.setAttribute("aria-describedby",this._tooltip._container.id)},"_setAriaDescribedByOnLayer"),_openTooltip:__name(function(e){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var that=this;this._map.once("moveend",function(){that._openOnceFlag=!1,that._openTooltip(e)});return}this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)}},"_openTooltip"),_moveTooltip:__name(function(e){var latlng=e.latlng,containerPoint,layerPoint;this._tooltip.options.sticky&&e.originalEvent&&(containerPoint=this._map.mouseEventToContainerPoint(e.originalEvent),layerPoint=this._map.containerPointToLayerPoint(containerPoint),latlng=this._map.layerPointToLatLng(layerPoint)),this._tooltip.setLatLng(latlng)},"_moveTooltip")});var DivIcon=Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:__name(function(oldIcon){var div=oldIcon&&oldIcon.tagName==="DIV"?oldIcon:document.createElement("div"),options=this.options;if(options.html instanceof Element?(empty(div),div.appendChild(options.html)):div.innerHTML=options.html!==!1?options.html:"",options.bgPos){var bgPos=toPoint(options.bgPos);div.style.backgroundPosition=-bgPos.x+"px "+-bgPos.y+"px"}return this._setIconStyles(div,"icon"),div},"createIcon"),createShadow:__name(function(){return null},"createShadow")});function divIcon(options){return new DivIcon(options)}__name(divIcon,"divIcon"),Icon.Default=IconDefault;var GridLayer=Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:__name(function(options){setOptions(this,options)},"initialize"),onAdd:__name(function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},"onAdd"),beforeAdd:__name(function(map2){map2._addZoomLimit(this)},"beforeAdd"),onRemove:__name(function(map2){this._removeAllTiles(),remove(this._container),map2._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},"onRemove"),bringToFront:__name(function(){return this._map&&(toFront(this._container),this._setAutoZIndex(Math.max)),this},"bringToFront"),bringToBack:__name(function(){return this._map&&(toBack(this._container),this._setAutoZIndex(Math.min)),this},"bringToBack"),getContainer:__name(function(){return this._container},"getContainer"),setOpacity:__name(function(opacity){return this.options.opacity=opacity,this._updateOpacity(),this},"setOpacity"),setZIndex:__name(function(zIndex){return this.options.zIndex=zIndex,this._updateZIndex(),this},"setZIndex"),isLoading:__name(function(){return this._loading},"isLoading"),redraw:__name(function(){if(this._map){this._removeAllTiles();var tileZoom=this._clampZoom(this._map.getZoom());tileZoom!==this._tileZoom&&(this._tileZoom=tileZoom,this._updateLevels()),this._update()}return this},"redraw"),getEvents:__name(function(){var events={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=throttle(this._onMoveEnd,this.options.updateInterval,this)),events.move=this._onMove),this._zoomAnimated&&(events.zoomanim=this._animateZoom),events},"getEvents"),createTile:__name(function(){return document.createElement("div")},"createTile"),getTileSize:__name(function(){var s=this.options.tileSize;return s instanceof Point?s:new Point(s,s)},"getTileSize"),_updateZIndex:__name(function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},"_updateZIndex"),_setAutoZIndex:__name(function(compare){for(var layers2=this.getPane().children,edgeZIndex=-compare(-1/0,1/0),i=0,len=layers2.length,zIndex;i<len;i++)zIndex=layers2[i].style.zIndex,layers2[i]!==this._container&&zIndex&&(edgeZIndex=compare(edgeZIndex,+zIndex));isFinite(edgeZIndex)&&(this.options.zIndex=edgeZIndex+compare(-1,1),this._updateZIndex())},"_setAutoZIndex"),_updateOpacity:__name(function(){if(this._map&&!Browser.ielt9){setOpacity(this._container,this.options.opacity);var now=+new Date,nextFrame=!1,willPrune=!1;for(var key in this._tiles){var tile=this._tiles[key];if(!(!tile.current||!tile.loaded)){var fade=Math.min(1,(now-tile.loaded)/200);setOpacity(tile.el,fade),fade<1?nextFrame=!0:(tile.active?willPrune=!0:this._onOpaqueTile(tile),tile.active=!0)}}willPrune&&!this._noPrune&&this._pruneTiles(),nextFrame&&(cancelAnimFrame(this._fadeFrame),this._fadeFrame=requestAnimFrame(this._updateOpacity,this))}},"_updateOpacity"),_onOpaqueTile:falseFn,_initContainer:__name(function(){this._container||(this._container=create$1("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},"_initContainer"),_updateLevels:__name(function(){var zoom2=this._tileZoom,maxZoom=this.options.maxZoom;if(zoom2!==void 0){for(var z in this._levels)z=Number(z),this._levels[z].el.children.length||z===zoom2?(this._levels[z].el.style.zIndex=maxZoom-Math.abs(zoom2-z),this._onUpdateLevel(z)):(remove(this._levels[z].el),this._removeTilesAtZoom(z),this._onRemoveLevel(z),delete this._levels[z]);var level=this._levels[zoom2],map2=this._map;return level||(level=this._levels[zoom2]={},level.el=create$1("div","leaflet-tile-container leaflet-zoom-animated",this._container),level.el.style.zIndex=maxZoom,level.origin=map2.project(map2.unproject(map2.getPixelOrigin()),zoom2).round(),level.zoom=zoom2,this._setZoomTransform(level,map2.getCenter(),map2.getZoom()),falseFn(level.el.offsetWidth),this._onCreateLevel(level)),this._level=level,level}},"_updateLevels"),_onUpdateLevel:falseFn,_onRemoveLevel:falseFn,_onCreateLevel:falseFn,_pruneTiles:__name(function(){if(this._map){var key,tile,zoom2=this._map.getZoom();if(zoom2>this.options.maxZoom||zoom2<this.options.minZoom){this._removeAllTiles();return}for(key in this._tiles)tile=this._tiles[key],tile.retain=tile.current;for(key in this._tiles)if(tile=this._tiles[key],tile.current&&!tile.active){var coords=tile.coords;this._retainParent(coords.x,coords.y,coords.z,coords.z-5)||this._retainChildren(coords.x,coords.y,coords.z,coords.z+2)}for(key in this._tiles)this._tiles[key].retain||this._removeTile(key)}},"_pruneTiles"),_removeTilesAtZoom:__name(function(zoom2){for(var key in this._tiles)this._tiles[key].coords.z===zoom2&&this._removeTile(key)},"_removeTilesAtZoom"),_removeAllTiles:__name(function(){for(var key in this._tiles)this._removeTile(key)},"_removeAllTiles"),_invalidateAll:__name(function(){for(var z in this._levels)remove(this._levels[z].el),this._onRemoveLevel(Number(z)),delete this._levels[z];this._removeAllTiles(),this._tileZoom=void 0},"_invalidateAll"),_retainParent:__name(function(x,y,z,minZoom){var x2=Math.floor(x/2),y2=Math.floor(y/2),z2=z-1,coords2=new Point(+x2,+y2);coords2.z=+z2;var key=this._tileCoordsToKey(coords2),tile=this._tiles[key];return tile&&tile.active?(tile.retain=!0,!0):(tile&&tile.loaded&&(tile.retain=!0),z2>minZoom?this._retainParent(x2,y2,z2,minZoom):!1)},"_retainParent"),_retainChildren:__name(function(x,y,z,maxZoom){for(var i=2*x;i<2*x+2;i++)for(var j=2*y;j<2*y+2;j++){var coords=new Point(i,j);coords.z=z+1;var key=this._tileCoordsToKey(coords),tile=this._tiles[key];if(tile&&tile.active){tile.retain=!0;continue}else tile&&tile.loaded&&(tile.retain=!0);z+1<maxZoom&&this._retainChildren(i,j,z+1,maxZoom)}},"_retainChildren"),_resetView:__name(function(e){var animating=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),animating,animating)},"_resetView"),_animateZoom:__name(function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},"_animateZoom"),_clampZoom:__name(function(zoom2){var options=this.options;return options.minNativeZoom!==void 0&&zoom2<options.minNativeZoom?options.minNativeZoom:options.maxNativeZoom!==void 0&&options.maxNativeZoom<zoom2?options.maxNativeZoom:zoom2},"_clampZoom"),_setView:__name(function(center,zoom2,noPrune,noUpdate){var tileZoom=Math.round(zoom2);this.options.maxZoom!==void 0&&tileZoom>this.options.maxZoom||this.options.minZoom!==void 0&&tileZoom<this.options.minZoom?tileZoom=void 0:tileZoom=this._clampZoom(tileZoom);var tileZoomChanged=this.options.updateWhenZooming&&tileZoom!==this._tileZoom;(!noUpdate||tileZoomChanged)&&(this._tileZoom=tileZoom,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),tileZoom!==void 0&&this._update(center),noPrune||this._pruneTiles(),this._noPrune=!!noPrune),this._setZoomTransforms(center,zoom2)},"_setView"),_setZoomTransforms:__name(function(center,zoom2){for(var i in this._levels)this._setZoomTransform(this._levels[i],center,zoom2)},"_setZoomTransforms"),_setZoomTransform:__name(function(level,center,zoom2){var scale2=this._map.getZoomScale(zoom2,level.zoom),translate=level.origin.multiplyBy(scale2).subtract(this._map._getNewPixelOrigin(center,zoom2)).round();Browser.any3d?setTransform(level.el,translate,scale2):setPosition(level.el,translate)},"_setZoomTransform"),_resetGrid:__name(function(){var map2=this._map,crs=map2.options.crs,tileSize=this._tileSize=this.getTileSize(),tileZoom=this._tileZoom,bounds=this._map.getPixelWorldBounds(this._tileZoom);bounds&&(this._globalTileRange=this._pxBoundsToTileRange(bounds)),this._wrapX=crs.wrapLng&&!this.options.noWrap&&[Math.floor(map2.project([0,crs.wrapLng[0]],tileZoom).x/tileSize.x),Math.ceil(map2.project([0,crs.wrapLng[1]],tileZoom).x/tileSize.y)],this._wrapY=crs.wrapLat&&!this.options.noWrap&&[Math.floor(map2.project([crs.wrapLat[0],0],tileZoom).y/tileSize.x),Math.ceil(map2.project([crs.wrapLat[1],0],tileZoom).y/tileSize.y)]},"_resetGrid"),_onMoveEnd:__name(function(){!this._map||this._map._animatingZoom||this._update()},"_onMoveEnd"),_getTiledPixelBounds:__name(function(center){var map2=this._map,mapZoom=map2._animatingZoom?Math.max(map2._animateToZoom,map2.getZoom()):map2.getZoom(),scale2=map2.getZoomScale(mapZoom,this._tileZoom),pixelCenter=map2.project(center,this._tileZoom).floor(),halfSize=map2.getSize().divideBy(scale2*2);return new Bounds(pixelCenter.subtract(halfSize),pixelCenter.add(halfSize))},"_getTiledPixelBounds"),_update:__name(function(center){var map2=this._map;if(map2){var zoom2=this._clampZoom(map2.getZoom());if(center===void 0&&(center=map2.getCenter()),this._tileZoom!==void 0){var pixelBounds=this._getTiledPixelBounds(center),tileRange=this._pxBoundsToTileRange(pixelBounds),tileCenter=tileRange.getCenter(),queue=[],margin=this.options.keepBuffer,noPruneRange=new Bounds(tileRange.getBottomLeft().subtract([margin,-margin]),tileRange.getTopRight().add([margin,-margin]));if(!(isFinite(tileRange.min.x)&&isFinite(tileRange.min.y)&&isFinite(tileRange.max.x)&&isFinite(tileRange.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var key in this._tiles){var c=this._tiles[key].coords;(c.z!==this._tileZoom||!noPruneRange.contains(new Point(c.x,c.y)))&&(this._tiles[key].current=!1)}if(Math.abs(zoom2-this._tileZoom)>1){this._setView(center,zoom2);return}for(var j=tileRange.min.y;j<=tileRange.max.y;j++)for(var i=tileRange.min.x;i<=tileRange.max.x;i++){var coords=new Point(i,j);if(coords.z=this._tileZoom,!!this._isValidTile(coords)){var tile=this._tiles[this._tileCoordsToKey(coords)];tile?tile.current=!0:queue.push(coords)}}if(queue.sort(function(a,b){return a.distanceTo(tileCenter)-b.distanceTo(tileCenter)}),queue.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var fragment=document.createDocumentFragment();for(i=0;i<queue.length;i++)this._addTile(queue[i],fragment);this._level.el.appendChild(fragment)}}}},"_update"),_isValidTile:__name(function(coords){var crs=this._map.options.crs;if(!crs.infinite){var bounds=this._globalTileRange;if(!crs.wrapLng&&(coords.x<bounds.min.x||coords.x>bounds.max.x)||!crs.wrapLat&&(coords.y<bounds.min.y||coords.y>bounds.max.y))return!1}if(!this.options.bounds)return!0;var tileBounds=this._tileCoordsToBounds(coords);return toLatLngBounds(this.options.bounds).overlaps(tileBounds)},"_isValidTile"),_keyToBounds:__name(function(key){return this._tileCoordsToBounds(this._keyToTileCoords(key))},"_keyToBounds"),_tileCoordsToNwSe:__name(function(coords){var map2=this._map,tileSize=this.getTileSize(),nwPoint=coords.scaleBy(tileSize),sePoint=nwPoint.add(tileSize),nw=map2.unproject(nwPoint,coords.z),se=map2.unproject(sePoint,coords.z);return[nw,se]},"_tileCoordsToNwSe"),_tileCoordsToBounds:__name(function(coords){var bp=this._tileCoordsToNwSe(coords),bounds=new LatLngBounds(bp[0],bp[1]);return this.options.noWrap||(bounds=this._map.wrapLatLngBounds(bounds)),bounds},"_tileCoordsToBounds"),_tileCoordsToKey:__name(function(coords){return coords.x+":"+coords.y+":"+coords.z},"_tileCoordsToKey"),_keyToTileCoords:__name(function(key){var k=key.split(":"),coords=new Point(+k[0],+k[1]);return coords.z=+k[2],coords},"_keyToTileCoords"),_removeTile:__name(function(key){var tile=this._tiles[key];tile&&(remove(tile.el),delete this._tiles[key],this.fire("tileunload",{tile:tile.el,coords:this._keyToTileCoords(key)}))},"_removeTile"),_initTile:__name(function(tile){addClass(tile,"leaflet-tile");var tileSize=this.getTileSize();tile.style.width=tileSize.x+"px",tile.style.height=tileSize.y+"px",tile.onselectstart=falseFn,tile.onmousemove=falseFn,Browser.ielt9&&this.options.opacity<1&&setOpacity(tile,this.options.opacity)},"_initTile"),_addTile:__name(function(coords,container){var tilePos=this._getTilePos(coords),key=this._tileCoordsToKey(coords),tile=this.createTile(this._wrapCoords(coords),bind(this._tileReady,this,coords));this._initTile(tile),this.createTile.length<2&&requestAnimFrame(bind(this._tileReady,this,coords,null,tile)),setPosition(tile,tilePos),this._tiles[key]={el:tile,coords,current:!0},container.appendChild(tile),this.fire("tileloadstart",{tile,coords})},"_addTile"),_tileReady:__name(function(coords,err,tile){err&&this.fire("tileerror",{error:err,tile,coords});var key=this._tileCoordsToKey(coords);tile=this._tiles[key],tile&&(tile.loaded=+new Date,this._map._fadeAnimated?(setOpacity(tile.el,0),cancelAnimFrame(this._fadeFrame),this._fadeFrame=requestAnimFrame(this._updateOpacity,this)):(tile.active=!0,this._pruneTiles()),err||(addClass(tile.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:tile.el,coords})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Browser.ielt9||!this._map._fadeAnimated?requestAnimFrame(this._pruneTiles,this):setTimeout(bind(this._pruneTiles,this),250)))},"_tileReady"),_getTilePos:__name(function(coords){return coords.scaleBy(this.getTileSize()).subtract(this._level.origin)},"_getTilePos"),_wrapCoords:__name(function(coords){var newCoords=new Point(this._wrapX?wrapNum(coords.x,this._wrapX):coords.x,this._wrapY?wrapNum(coords.y,this._wrapY):coords.y);return newCoords.z=coords.z,newCoords},"_wrapCoords"),_pxBoundsToTileRange:__name(function(bounds){var tileSize=this.getTileSize();return new Bounds(bounds.min.unscaleBy(tileSize).floor(),bounds.max.unscaleBy(tileSize).ceil().subtract([1,1]))},"_pxBoundsToTileRange"),_noTilesToLoad:__name(function(){for(var key in this._tiles)if(!this._tiles[key].loaded)return!1;return!0},"_noTilesToLoad")});function gridLayer(options){return new GridLayer(options)}__name(gridLayer,"gridLayer");var TileLayer=GridLayer.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:__name(function(url,options){this._url=url,options=setOptions(this,options),options.detectRetina&&Browser.retina&&options.maxZoom>0?(options.tileSize=Math.floor(options.tileSize/2),options.zoomReverse?(options.zoomOffset--,options.minZoom=Math.min(options.maxZoom,options.minZoom+1)):(options.zoomOffset++,options.maxZoom=Math.max(options.minZoom,options.maxZoom-1)),options.minZoom=Math.max(0,options.minZoom)):options.zoomReverse?options.minZoom=Math.min(options.maxZoom,options.minZoom):options.maxZoom=Math.max(options.minZoom,options.maxZoom),typeof options.subdomains=="string"&&(options.subdomains=options.subdomains.split("")),this.on("tileunload",this._onTileRemove)},"initialize"),setUrl:__name(function(url,noRedraw){return this._url===url&&noRedraw===void 0&&(noRedraw=!0),this._url=url,noRedraw||this.redraw(),this},"setUrl"),createTile:__name(function(coords,done){var tile=document.createElement("img");return on(tile,"load",bind(this._tileOnLoad,this,done,tile)),on(tile,"error",bind(this._tileOnError,this,done,tile)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(tile.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(tile.referrerPolicy=this.options.referrerPolicy),tile.alt="",tile.src=this.getTileUrl(coords),tile},"createTile"),getTileUrl:__name(function(coords){var data={r:Browser.retina?"@2x":"",s:this._getSubdomain(coords),x:coords.x,y:coords.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var invertedY=this._globalTileRange.max.y-coords.y;this.options.tms&&(data.y=invertedY),data["-y"]=invertedY}return template(this._url,extend(data,this.options))},"getTileUrl"),_tileOnLoad:__name(function(done,tile){Browser.ielt9?setTimeout(bind(done,this,null,tile),0):done(null,tile)},"_tileOnLoad"),_tileOnError:__name(function(done,tile,e){var errorUrl=this.options.errorTileUrl;errorUrl&&tile.getAttribute("src")!==errorUrl&&(tile.src=errorUrl),done(e,tile)},"_tileOnError"),_onTileRemove:__name(function(e){e.tile.onload=null},"_onTileRemove"),_getZoomForUrl:__name(function(){var zoom2=this._tileZoom,maxZoom=this.options.maxZoom,zoomReverse=this.options.zoomReverse,zoomOffset=this.options.zoomOffset;return zoomReverse&&(zoom2=maxZoom-zoom2),zoom2+zoomOffset},"_getZoomForUrl"),_getSubdomain:__name(function(tilePoint){var index2=Math.abs(tilePoint.x+tilePoint.y)%this.options.subdomains.length;return this.options.subdomains[index2]},"_getSubdomain"),_abortLoading:__name(function(){var i,tile;for(i in this._tiles)if(this._tiles[i].coords.z!==this._tileZoom&&(tile=this._tiles[i].el,tile.onload=falseFn,tile.onerror=falseFn,!tile.complete)){tile.src=emptyImageUrl;var coords=this._tiles[i].coords;remove(tile),delete this._tiles[i],this.fire("tileabort",{tile,coords})}},"_abortLoading"),_removeTile:__name(function(key){var tile=this._tiles[key];if(tile)return tile.el.setAttribute("src",emptyImageUrl),GridLayer.prototype._removeTile.call(this,key)},"_removeTile"),_tileReady:__name(function(coords,err,tile){if(!(!this._map||tile&&tile.getAttribute("src")===emptyImageUrl))return GridLayer.prototype._tileReady.call(this,coords,err,tile)},"_tileReady")});function tileLayer2(url,options){return new TileLayer(url,options)}__name(tileLayer2,"tileLayer");var TileLayerWMS=TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:__name(function(url,options){this._url=url;var wmsParams=extend({},this.defaultWmsParams);for(var i in options)i in this.options||(wmsParams[i]=options[i]);options=setOptions(this,options);var realRetina=options.detectRetina&&Browser.retina?2:1,tileSize=this.getTileSize();wmsParams.width=tileSize.x*realRetina,wmsParams.height=tileSize.y*realRetina,this.wmsParams=wmsParams},"initialize"),onAdd:__name(function(map2){this._crs=this.options.crs||map2.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var projectionKey=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[projectionKey]=this._crs.code,TileLayer.prototype.onAdd.call(this,map2)},"onAdd"),getTileUrl:__name(function(coords){var tileBounds=this._tileCoordsToNwSe(coords),crs=this._crs,bounds=toBounds(crs.project(tileBounds[0]),crs.project(tileBounds[1])),min=bounds.min,max=bounds.max,bbox=(this._wmsVersion>=1.3&&this._crs===EPSG4326?[min.y,min.x,max.y,max.x]:[min.x,min.y,max.x,max.y]).join(","),url=TileLayer.prototype.getTileUrl.call(this,coords);return url+getParamString(this.wmsParams,url,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+bbox},"getTileUrl"),setParams:__name(function(params,noRedraw){return extend(this.wmsParams,params),noRedraw||this.redraw(),this},"setParams")});function tileLayerWMS(url,options){return new TileLayerWMS(url,options)}__name(tileLayerWMS,"tileLayerWMS"),TileLayer.WMS=TileLayerWMS,tileLayer2.wms=tileLayerWMS;var Renderer=Layer.extend({options:{padding:.1},initialize:__name(function(options){setOptions(this,options),stamp(this),this._layers=this._layers||{}},"initialize"),onAdd:__name(function(){this._container||(this._initContainer(),addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},"onAdd"),onRemove:__name(function(){this.off("update",this._updatePaths,this),this._destroyContainer()},"onRemove"),getEvents:__name(function(){var events={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(events.zoomanim=this._onAnimZoom),events},"getEvents"),_onAnimZoom:__name(function(ev){this._updateTransform(ev.center,ev.zoom)},"_onAnimZoom"),_onZoom:__name(function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},"_onZoom"),_updateTransform:__name(function(center,zoom2){var scale2=this._map.getZoomScale(zoom2,this._zoom),viewHalf=this._map.getSize().multiplyBy(.5+this.options.padding),currentCenterPoint=this._map.project(this._center,zoom2),topLeftOffset=viewHalf.multiplyBy(-scale2).add(currentCenterPoint).subtract(this._map._getNewPixelOrigin(center,zoom2));Browser.any3d?setTransform(this._container,topLeftOffset,scale2):setPosition(this._container,topLeftOffset)},"_updateTransform"),_reset:__name(function(){this._update(),this._updateTransform(this._center,this._zoom);for(var id in this._layers)this._layers[id]._reset()},"_reset"),_onZoomEnd:__name(function(){for(var id in this._layers)this._layers[id]._project()},"_onZoomEnd"),_updatePaths:__name(function(){for(var id in this._layers)this._layers[id]._update()},"_updatePaths"),_update:__name(function(){var p=this.options.padding,size=this._map.getSize(),min=this._map.containerPointToLayerPoint(size.multiplyBy(-p)).round();this._bounds=new Bounds(min,min.add(size.multiplyBy(1+p*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},"_update")}),Canvas=Renderer.extend({options:{tolerance:0},getEvents:__name(function(){var events=Renderer.prototype.getEvents.call(this);return events.viewprereset=this._onViewPreReset,events},"getEvents"),_onViewPreReset:__name(function(){this._postponeUpdatePaths=!0},"_onViewPreReset"),onAdd:__name(function(){Renderer.prototype.onAdd.call(this),this._draw()},"onAdd"),_initContainer:__name(function(){var container=this._container=document.createElement("canvas");on(container,"mousemove",this._onMouseMove,this),on(container,"click dblclick mousedown mouseup contextmenu",this._onClick,this),on(container,"mouseout",this._handleMouseOut,this),container._leaflet_disable_events=!0,this._ctx=container.getContext("2d")},"_initContainer"),_destroyContainer:__name(function(){cancelAnimFrame(this._redrawRequest),delete this._ctx,remove(this._container),off(this._container),delete this._container},"_destroyContainer"),_updatePaths:__name(function(){if(!this._postponeUpdatePaths){var layer;this._redrawBounds=null;for(var id in this._layers)layer=this._layers[id],layer._update();this._redraw()}},"_updatePaths"),_update:__name(function(){if(!(this._map._animatingZoom&&this._bounds)){Renderer.prototype._update.call(this);var b=this._bounds,container=this._container,size=b.getSize(),m=Browser.retina?2:1;setPosition(container,b.min),container.width=m*size.x,container.height=m*size.y,container.style.width=size.x+"px",container.style.height=size.y+"px",Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-b.min.x,-b.min.y),this.fire("update")}},"_update"),_reset:__name(function(){Renderer.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},"_reset"),_initPath:__name(function(layer){this._updateDashArray(layer),this._layers[stamp(layer)]=layer;var order=layer._order={layer,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=order),this._drawLast=order,this._drawFirst=this._drawFirst||this._drawLast},"_initPath"),_addPath:__name(function(layer){this._requestRedraw(layer)},"_addPath"),_removePath:__name(function(layer){var order=layer._order,next=order.next,prev=order.prev;next?next.prev=prev:this._drawLast=prev,prev?prev.next=next:this._drawFirst=next,delete layer._order,delete this._layers[stamp(layer)],this._requestRedraw(layer)},"_removePath"),_updatePath:__name(function(layer){this._extendRedrawBounds(layer),layer._project(),layer._update(),this._requestRedraw(layer)},"_updatePath"),_updateStyle:__name(function(layer){this._updateDashArray(layer),this._requestRedraw(layer)},"_updateStyle"),_updateDashArray:__name(function(layer){if(typeof layer.options.dashArray=="string"){var parts=layer.options.dashArray.split(/[, ]+/),dashArray=[],dashValue,i;for(i=0;i<parts.length;i++){if(dashValue=Number(parts[i]),isNaN(dashValue))return;dashArray.push(dashValue)}layer.options._dashArray=dashArray}else layer.options._dashArray=layer.options.dashArray},"_updateDashArray"),_requestRedraw:__name(function(layer){this._map&&(this._extendRedrawBounds(layer),this._redrawRequest=this._redrawRequest||requestAnimFrame(this._redraw,this))},"_requestRedraw"),_extendRedrawBounds:__name(function(layer){if(layer._pxBounds){var padding=(layer.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Bounds,this._redrawBounds.extend(layer._pxBounds.min.subtract([padding,padding])),this._redrawBounds.extend(layer._pxBounds.max.add([padding,padding]))}},"_extendRedrawBounds"),_redraw:__name(function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},"_redraw"),_clear:__name(function(){var bounds=this._redrawBounds;if(bounds){var size=bounds.getSize();this._ctx.clearRect(bounds.min.x,bounds.min.y,size.x,size.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},"_clear"),_draw:__name(function(){var layer,bounds=this._redrawBounds;if(this._ctx.save(),bounds){var size=bounds.getSize();this._ctx.beginPath(),this._ctx.rect(bounds.min.x,bounds.min.y,size.x,size.y),this._ctx.clip()}this._drawing=!0;for(var order=this._drawFirst;order;order=order.next)layer=order.layer,(!bounds||layer._pxBounds&&layer._pxBounds.intersects(bounds))&&layer._updatePath();this._drawing=!1,this._ctx.restore()},"_draw"),_updatePoly:__name(function(layer,closed){if(this._drawing){var i,j,len2,p,parts=layer._parts,len=parts.length,ctx=this._ctx;if(len){for(ctx.beginPath(),i=0;i<len;i++){for(j=0,len2=parts[i].length;j<len2;j++)p=parts[i][j],ctx[j?"lineTo":"moveTo"](p.x,p.y);closed&&ctx.closePath()}this._fillStroke(ctx,layer)}}},"_updatePoly"),_updateCircle:__name(function(layer){if(!(!this._drawing||layer._empty())){var p=layer._point,ctx=this._ctx,r=Math.max(Math.round(layer._radius),1),s=(Math.max(Math.round(layer._radiusY),1)||r)/r;s!==1&&(ctx.save(),ctx.scale(1,s)),ctx.beginPath(),ctx.arc(p.x,p.y/s,r,0,Math.PI*2,!1),s!==1&&ctx.restore(),this._fillStroke(ctx,layer)}},"_updateCircle"),_fillStroke:__name(function(ctx,layer){var options=layer.options;options.fill&&(ctx.globalAlpha=options.fillOpacity,ctx.fillStyle=options.fillColor||options.color,ctx.fill(options.fillRule||"evenodd")),options.stroke&&options.weight!==0&&(ctx.setLineDash&&ctx.setLineDash(layer.options&&layer.options._dashArray||[]),ctx.globalAlpha=options.opacity,ctx.lineWidth=options.weight,ctx.strokeStyle=options.color,ctx.lineCap=options.lineCap,ctx.lineJoin=options.lineJoin,ctx.stroke())},"_fillStroke"),_onClick:__name(function(e){for(var point=this._map.mouseEventToLayerPoint(e),layer,clickedLayer,order=this._drawFirst;order;order=order.next)layer=order.layer,layer.options.interactive&&layer._containsPoint(point)&&(!(e.type==="click"||e.type==="preclick")||!this._map._draggableMoved(layer))&&(clickedLayer=layer);this._fireEvent(clickedLayer?[clickedLayer]:!1,e)},"_onClick"),_onMouseMove:__name(function(e){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var point=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,point)}},"_onMouseMove"),_handleMouseOut:__name(function(e){var layer=this._hoveredLayer;layer&&(removeClass(this._container,"leaflet-interactive"),this._fireEvent([layer],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},"_handleMouseOut"),_handleMouseHover:__name(function(e,point){if(!this._mouseHoverThrottled){for(var layer,candidateHoveredLayer,order=this._drawFirst;order;order=order.next)layer=order.layer,layer.options.interactive&&layer._containsPoint(point)&&(candidateHoveredLayer=layer);candidateHoveredLayer!==this._hoveredLayer&&(this._handleMouseOut(e),candidateHoveredLayer&&(addClass(this._container,"leaflet-interactive"),this._fireEvent([candidateHoveredLayer],e,"mouseover"),this._hoveredLayer=candidateHoveredLayer)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,e),this._mouseHoverThrottled=!0,setTimeout(bind(function(){this._mouseHoverThrottled=!1},this),32)}},"_handleMouseHover"),_fireEvent:__name(function(layers2,e,type){this._map._fireDOMEvent(e,type||e.type,layers2)},"_fireEvent"),_bringToFront:__name(function(layer){var order=layer._order;if(order){var next=order.next,prev=order.prev;if(next)next.prev=prev;else return;prev?prev.next=next:next&&(this._drawFirst=next),order.prev=this._drawLast,this._drawLast.next=order,order.next=null,this._drawLast=order,this._requestRedraw(layer)}},"_bringToFront"),_bringToBack:__name(function(layer){var order=layer._order;if(order){var next=order.next,prev=order.prev;if(prev)prev.next=next;else return;next?next.prev=prev:prev&&(this._drawLast=prev),order.prev=null,order.next=this._drawFirst,this._drawFirst.prev=order,this._drawFirst=order,this._requestRedraw(layer)}},"_bringToBack")});function canvas(options){return Browser.canvas?new Canvas(options):null}__name(canvas,"canvas");var vmlCreate=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(name){return document.createElement("<lvml:"+name+' class="lvml">')}}catch{}return function(name){return document.createElement("<"+name+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),vmlMixin={_initContainer:__name(function(){this._container=create$1("div","leaflet-vml-container")},"_initContainer"),_update:__name(function(){this._map._animatingZoom||(Renderer.prototype._update.call(this),this.fire("update"))},"_update"),_initPath:__name(function(layer){var container=layer._container=vmlCreate("shape");addClass(container,"leaflet-vml-shape "+(this.options.className||"")),container.coordsize="1 1",layer._path=vmlCreate("path"),container.appendChild(layer._path),this._updateStyle(layer),this._layers[stamp(layer)]=layer},"_initPath"),_addPath:__name(function(layer){var container=layer._container;this._container.appendChild(container),layer.options.interactive&&layer.addInteractiveTarget(container)},"_addPath"),_removePath:__name(function(layer){var container=layer._container;remove(container),layer.removeInteractiveTarget(container),delete this._layers[stamp(layer)]},"_removePath"),_updateStyle:__name(function(layer){var stroke=layer._stroke,fill=layer._fill,options=layer.options,container=layer._container;container.stroked=!!options.stroke,container.filled=!!options.fill,options.stroke?(stroke||(stroke=layer._stroke=vmlCreate("stroke")),container.appendChild(stroke),stroke.weight=options.weight+"px",stroke.color=options.color,stroke.opacity=options.opacity,options.dashArray?stroke.dashStyle=isArray(options.dashArray)?options.dashArray.join(" "):options.dashArray.replace(/( *, *)/g," "):stroke.dashStyle="",stroke.endcap=options.lineCap.replace("butt","flat"),stroke.joinstyle=options.lineJoin):stroke&&(container.removeChild(stroke),layer._stroke=null),options.fill?(fill||(fill=layer._fill=vmlCreate("fill")),container.appendChild(fill),fill.color=options.fillColor||options.color,fill.opacity=options.fillOpacity):fill&&(container.removeChild(fill),layer._fill=null)},"_updateStyle"),_updateCircle:__name(function(layer){var p=layer._point.round(),r=Math.round(layer._radius),r2=Math.round(layer._radiusY||r);this._setPath(layer,layer._empty()?"M0 0":"AL "+p.x+","+p.y+" "+r+","+r2+" 0,"+65535*360)},"_updateCircle"),_setPath:__name(function(layer,path){layer._path.v=path},"_setPath"),_bringToFront:__name(function(layer){toFront(layer._container)},"_bringToFront"),_bringToBack:__name(function(layer){toBack(layer._container)},"_bringToBack")},create=Browser.vml?vmlCreate:svgCreate,SVG=Renderer.extend({_initContainer:__name(function(){this._container=create("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=create("g"),this._container.appendChild(this._rootGroup)},"_initContainer"),_destroyContainer:__name(function(){remove(this._container),off(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},"_destroyContainer"),_update:__name(function(){if(!(this._map._animatingZoom&&this._bounds)){Renderer.prototype._update.call(this);var b=this._bounds,size=b.getSize(),container=this._container;(!this._svgSize||!this._svgSize.equals(size))&&(this._svgSize=size,container.setAttribute("width",size.x),container.setAttribute("height",size.y)),setPosition(container,b.min),container.setAttribute("viewBox",[b.min.x,b.min.y,size.x,size.y].join(" ")),this.fire("update")}},"_update"),_initPath:__name(function(layer){var path=layer._path=create("path");layer.options.className&&addClass(path,layer.options.className),layer.options.interactive&&addClass(path,"leaflet-interactive"),this._updateStyle(layer),this._layers[stamp(layer)]=layer},"_initPath"),_addPath:__name(function(layer){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(layer._path),layer.addInteractiveTarget(layer._path)},"_addPath"),_removePath:__name(function(layer){remove(layer._path),layer.removeInteractiveTarget(layer._path),delete this._layers[stamp(layer)]},"_removePath"),_updatePath:__name(function(layer){layer._project(),layer._update()},"_updatePath"),_updateStyle:__name(function(layer){var path=layer._path,options=layer.options;path&&(options.stroke?(path.setAttribute("stroke",options.color),path.setAttribute("stroke-opacity",options.opacity),path.setAttribute("stroke-width",options.weight),path.setAttribute("stroke-linecap",options.lineCap),path.setAttribute("stroke-linejoin",options.lineJoin),options.dashArray?path.setAttribute("stroke-dasharray",options.dashArray):path.removeAttribute("stroke-dasharray"),options.dashOffset?path.setAttribute("stroke-dashoffset",options.dashOffset):path.removeAttribute("stroke-dashoffset")):path.setAttribute("stroke","none"),options.fill?(path.setAttribute("fill",options.fillColor||options.color),path.setAttribute("fill-opacity",options.fillOpacity),path.setAttribute("fill-rule",options.fillRule||"evenodd")):path.setAttribute("fill","none"))},"_updateStyle"),_updatePoly:__name(function(layer,closed){this._setPath(layer,pointsToPath(layer._parts,closed))},"_updatePoly"),_updateCircle:__name(function(layer){var p=layer._point,r=Math.max(Math.round(layer._radius),1),r2=Math.max(Math.round(layer._radiusY),1)||r,arc="a"+r+","+r2+" 0 1,0 ",d=layer._empty()?"M0 0":"M"+(p.x-r)+","+p.y+arc+r*2+",0 "+arc+-r*2+",0 ";this._setPath(layer,d)},"_updateCircle"),_setPath:__name(function(layer,path){layer._path.setAttribute("d",path)},"_setPath"),_bringToFront:__name(function(layer){toFront(layer._path)},"_bringToFront"),_bringToBack:__name(function(layer){toBack(layer._path)},"_bringToBack")});Browser.vml&&SVG.include(vmlMixin);function svg(options){return Browser.svg||Browser.vml?new SVG(options):null}__name(svg,"svg"),Map.include({getRenderer:__name(function(layer){var renderer=layer.options.renderer||this._getPaneRenderer(layer.options.pane)||this.options.renderer||this._renderer;return renderer||(renderer=this._renderer=this._createRenderer()),this.hasLayer(renderer)||this.addLayer(renderer),renderer},"getRenderer"),_getPaneRenderer:__name(function(name){if(name==="overlayPane"||name===void 0)return!1;var renderer=this._paneRenderers[name];return renderer===void 0&&(renderer=this._createRenderer({pane:name}),this._paneRenderers[name]=renderer),renderer},"_getPaneRenderer"),_createRenderer:__name(function(options){return this.options.preferCanvas&&canvas(options)||svg(options)},"_createRenderer")});var Rectangle=Polygon.extend({initialize:__name(function(latLngBounds,options){Polygon.prototype.initialize.call(this,this._boundsToLatLngs(latLngBounds),options)},"initialize"),setBounds:__name(function(latLngBounds){return this.setLatLngs(this._boundsToLatLngs(latLngBounds))},"setBounds"),_boundsToLatLngs:__name(function(latLngBounds){return latLngBounds=toLatLngBounds(latLngBounds),[latLngBounds.getSouthWest(),latLngBounds.getNorthWest(),latLngBounds.getNorthEast(),latLngBounds.getSouthEast()]},"_boundsToLatLngs")});function rectangle2(latLngBounds,options){return new Rectangle(latLngBounds,options)}__name(rectangle2,"rectangle"),SVG.create=create,SVG.pointsToPath=pointsToPath,GeoJSON.geometryToLayer=geometryToLayer,GeoJSON.coordsToLatLng=coordsToLatLng,GeoJSON.coordsToLatLngs=coordsToLatLngs,GeoJSON.latLngToCoords=latLngToCoords,GeoJSON.latLngsToCoords=latLngsToCoords,GeoJSON.getFeature=getFeature,GeoJSON.asFeature=asFeature,Map.mergeOptions({boxZoom:!0});var BoxZoom=Handler.extend({initialize:__name(function(map2){this._map=map2,this._container=map2._container,this._pane=map2._panes.overlayPane,this._resetStateTimeout=0,map2.on("unload",this._destroy,this)},"initialize"),addHooks:__name(function(){on(this._container,"mousedown",this._onMouseDown,this)},"addHooks"),removeHooks:__name(function(){off(this._container,"mousedown",this._onMouseDown,this)},"removeHooks"),moved:__name(function(){return this._moved},"moved"),_destroy:__name(function(){remove(this._pane),delete this._pane},"_destroy"),_resetState:__name(function(){this._resetStateTimeout=0,this._moved=!1},"_resetState"),_clearDeferredResetState:__name(function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},"_clearDeferredResetState"),_onMouseDown:__name(function(e){if(!e.shiftKey||e.which!==1&&e.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),disableTextSelection(),disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(e),on(document,{contextmenu:stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},"_onMouseDown"),_onMouseMove:__name(function(e){this._moved||(this._moved=!0,this._box=create$1("div","leaflet-zoom-box",this._container),addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var bounds=new Bounds(this._point,this._startPoint),size=bounds.getSize();setPosition(this._box,bounds.min),this._box.style.width=size.x+"px",this._box.style.height=size.y+"px"},"_onMouseMove"),_finish:__name(function(){this._moved&&(remove(this._box),removeClass(this._container,"leaflet-crosshair")),enableTextSelection(),enableImageDrag(),off(document,{contextmenu:stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},"_finish"),_onMouseUp:__name(function(e){if(!(e.which!==1&&e.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(bind(this._resetState,this),0);var bounds=new LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(bounds).fire("boxzoomend",{boxZoomBounds:bounds})}},"_onMouseUp"),_onKeyDown:__name(function(e){e.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())},"_onKeyDown")});Map.addInitHook("addHandler","boxZoom",BoxZoom),Map.mergeOptions({doubleClickZoom:!0});var DoubleClickZoom=Handler.extend({addHooks:__name(function(){this._map.on("dblclick",this._onDoubleClick,this)},"addHooks"),removeHooks:__name(function(){this._map.off("dblclick",this._onDoubleClick,this)},"removeHooks"),_onDoubleClick:__name(function(e){var map2=this._map,oldZoom=map2.getZoom(),delta=map2.options.zoomDelta,zoom2=e.originalEvent.shiftKey?oldZoom-delta:oldZoom+delta;map2.options.doubleClickZoom==="center"?map2.setZoom(zoom2):map2.setZoomAround(e.containerPoint,zoom2)},"_onDoubleClick")});Map.addInitHook("addHandler","doubleClickZoom",DoubleClickZoom),Map.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Drag=Handler.extend({addHooks:__name(function(){if(!this._draggable){var map2=this._map;this._draggable=new Draggable(map2._mapPane,map2._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),map2.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),map2.on("zoomend",this._onZoomEnd,this),map2.whenReady(this._onZoomEnd,this))}addClass(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},"addHooks"),removeHooks:__name(function(){removeClass(this._map._container,"leaflet-grab"),removeClass(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},"removeHooks"),moved:__name(function(){return this._draggable&&this._draggable._moved},"moved"),moving:__name(function(){return this._draggable&&this._draggable._moving},"moving"),_onDragStart:__name(function(){var map2=this._map;if(map2._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var bounds=toLatLngBounds(this._map.options.maxBounds);this._offsetLimit=toBounds(this._map.latLngToContainerPoint(bounds.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(bounds.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;map2.fire("movestart").fire("dragstart"),map2.options.inertia&&(this._positions=[],this._times=[])},"_onDragStart"),_onDrag:__name(function(e){if(this._map.options.inertia){var time=this._lastTime=+new Date,pos=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(pos),this._times.push(time),this._prunePositions(time)}this._map.fire("move",e).fire("drag",e)},"_onDrag"),_prunePositions:__name(function(time){for(;this._positions.length>1&&time-this._times[0]>50;)this._positions.shift(),this._times.shift()},"_prunePositions"),_onZoomEnd:__name(function(){var pxCenter=this._map.getSize().divideBy(2),pxWorldCenter=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=pxWorldCenter.subtract(pxCenter).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},"_onZoomEnd"),_viscousLimit:__name(function(value,threshold){return value-(value-threshold)*this._viscosity},"_viscousLimit"),_onPreDragLimit:__name(function(){if(!(!this._viscosity||!this._offsetLimit)){var offset=this._draggable._newPos.subtract(this._draggable._startPos),limit=this._offsetLimit;offset.x<limit.min.x&&(offset.x=this._viscousLimit(offset.x,limit.min.x)),offset.y<limit.min.y&&(offset.y=this._viscousLimit(offset.y,limit.min.y)),offset.x>limit.max.x&&(offset.x=this._viscousLimit(offset.x,limit.max.x)),offset.y>limit.max.y&&(offset.y=this._viscousLimit(offset.y,limit.max.y)),this._draggable._newPos=this._draggable._startPos.add(offset)}},"_onPreDragLimit"),_onPreDragWrap:__name(function(){var worldWidth=this._worldWidth,halfWidth=Math.round(worldWidth/2),dx=this._initialWorldOffset,x=this._draggable._newPos.x,newX1=(x-halfWidth+dx)%worldWidth+halfWidth-dx,newX2=(x+halfWidth+dx)%worldWidth-halfWidth-dx,newX=Math.abs(newX1+dx)<Math.abs(newX2+dx)?newX1:newX2;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=newX},"_onPreDragWrap"),_onDragEnd:__name(function(e){var map2=this._map,options=map2.options,noInertia=!options.inertia||e.noInertia||this._times.length<2;if(map2.fire("dragend",e),noInertia)map2.fire("moveend");else{this._prunePositions(+new Date);var direction=this._lastPos.subtract(this._positions[0]),duration=(this._lastTime-this._times[0])/1e3,ease=options.easeLinearity,speedVector=direction.multiplyBy(ease/duration),speed=speedVector.distanceTo([0,0]),limitedSpeed=Math.min(options.inertiaMaxSpeed,speed),limitedSpeedVector=speedVector.multiplyBy(limitedSpeed/speed),decelerationDuration=limitedSpeed/(options.inertiaDeceleration*ease),offset=limitedSpeedVector.multiplyBy(-decelerationDuration/2).round();!offset.x&&!offset.y?map2.fire("moveend"):(offset=map2._limitOffset(offset,map2.options.maxBounds),requestAnimFrame(function(){map2.panBy(offset,{duration:decelerationDuration,easeLinearity:ease,noMoveStart:!0,animate:!0})}))}},"_onDragEnd")});Map.addInitHook("addHandler","dragging",Drag),Map.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Keyboard=Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:__name(function(map2){this._map=map2,this._setPanDelta(map2.options.keyboardPanDelta),this._setZoomDelta(map2.options.zoomDelta)},"initialize"),addHooks:__name(function(){var container=this._map._container;container.tabIndex<=0&&(container.tabIndex="0"),on(container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},"addHooks"),removeHooks:__name(function(){this._removeHooks(),off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},"removeHooks"),_onMouseDown:__name(function(){if(!this._focused){var body=document.body,docEl=document.documentElement,top=body.scrollTop||docEl.scrollTop,left=body.scrollLeft||docEl.scrollLeft;this._map._container.focus(),window.scrollTo(left,top)}},"_onMouseDown"),_onFocus:__name(function(){this._focused=!0,this._map.fire("focus")},"_onFocus"),_onBlur:__name(function(){this._focused=!1,this._map.fire("blur")},"_onBlur"),_setPanDelta:__name(function(panDelta){var keys=this._panKeys={},codes=this.keyCodes,i,len;for(i=0,len=codes.left.length;i<len;i++)keys[codes.left[i]]=[-1*panDelta,0];for(i=0,len=codes.right.length;i<len;i++)keys[codes.right[i]]=[panDelta,0];for(i=0,len=codes.down.length;i<len;i++)keys[codes.down[i]]=[0,panDelta];for(i=0,len=codes.up.length;i<len;i++)keys[codes.up[i]]=[0,-1*panDelta]},"_setPanDelta"),_setZoomDelta:__name(function(zoomDelta){var keys=this._zoomKeys={},codes=this.keyCodes,i,len;for(i=0,len=codes.zoomIn.length;i<len;i++)keys[codes.zoomIn[i]]=zoomDelta;for(i=0,len=codes.zoomOut.length;i<len;i++)keys[codes.zoomOut[i]]=-zoomDelta},"_setZoomDelta"),_addHooks:__name(function(){on(document,"keydown",this._onKeyDown,this)},"_addHooks"),_removeHooks:__name(function(){off(document,"keydown",this._onKeyDown,this)},"_removeHooks"),_onKeyDown:__name(function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var key=e.keyCode,map2=this._map,offset;if(key in this._panKeys){if(!map2._panAnim||!map2._panAnim._inProgress)if(offset=this._panKeys[key],e.shiftKey&&(offset=toPoint(offset).multiplyBy(3)),map2.options.maxBounds&&(offset=map2._limitOffset(toPoint(offset),map2.options.maxBounds)),map2.options.worldCopyJump){var newLatLng=map2.wrapLatLng(map2.unproject(map2.project(map2.getCenter()).add(offset)));map2.panTo(newLatLng)}else map2.panBy(offset)}else if(key in this._zoomKeys)map2.setZoom(map2.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[key]);else if(key===27&&map2._popup&&map2._popup.options.closeOnEscapeKey)map2.closePopup();else return;stop(e)}},"_onKeyDown")});Map.addInitHook("addHandler","keyboard",Keyboard),Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ScrollWheelZoom=Handler.extend({addHooks:__name(function(){on(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},"addHooks"),removeHooks:__name(function(){off(this._map._container,"wheel",this._onWheelScroll,this)},"removeHooks"),_onWheelScroll:__name(function(e){var delta=getWheelDelta(e),debounce=this._map.options.wheelDebounceTime;this._delta+=delta,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var left=Math.max(debounce-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(bind(this._performZoom,this),left),stop(e)},"_onWheelScroll"),_performZoom:__name(function(){var map2=this._map,zoom2=map2.getZoom(),snap=this._map.options.zoomSnap||0;map2._stop();var d2=this._delta/(this._map.options.wheelPxPerZoomLevel*4),d3=4*Math.log(2/(1+Math.exp(-Math.abs(d2))))/Math.LN2,d4=snap?Math.ceil(d3/snap)*snap:d3,delta=map2._limitZoom(zoom2+(this._delta>0?d4:-d4))-zoom2;this._delta=0,this._startTime=null,delta&&(map2.options.scrollWheelZoom==="center"?map2.setZoom(zoom2+delta):map2.setZoomAround(this._lastMousePos,zoom2+delta))},"_performZoom")});Map.addInitHook("addHandler","scrollWheelZoom",ScrollWheelZoom);var tapHoldDelay=600;Map.mergeOptions({tapHold:Browser.touchNative&&Browser.safari&&Browser.mobile,tapTolerance:15});var TapHold=Handler.extend({addHooks:__name(function(){on(this._map._container,"touchstart",this._onDown,this)},"addHooks"),removeHooks:__name(function(){off(this._map._container,"touchstart",this._onDown,this)},"removeHooks"),_onDown:__name(function(e){if(clearTimeout(this._holdTimeout),e.touches.length===1){var first=e.touches[0];this._startPos=this._newPos=new Point(first.clientX,first.clientY),this._holdTimeout=setTimeout(bind(function(){this._cancel(),this._isTapValid()&&(on(document,"touchend",preventDefault),on(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",first))},this),tapHoldDelay),on(document,"touchend touchcancel contextmenu",this._cancel,this),on(document,"touchmove",this._onMove,this)}},"_onDown"),_cancelClickPrevent:__name(function cancelClickPrevent(){off(document,"touchend",preventDefault),off(document,"touchend touchcancel",cancelClickPrevent)},"cancelClickPrevent"),_cancel:__name(function(){clearTimeout(this._holdTimeout),off(document,"touchend touchcancel contextmenu",this._cancel,this),off(document,"touchmove",this._onMove,this)},"_cancel"),_onMove:__name(function(e){var first=e.touches[0];this._newPos=new Point(first.clientX,first.clientY)},"_onMove"),_isTapValid:__name(function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},"_isTapValid"),_simulateEvent:__name(function(type,e){var simulatedEvent=new MouseEvent(type,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});simulatedEvent._simulated=!0,e.target.dispatchEvent(simulatedEvent)},"_simulateEvent")});Map.addInitHook("addHandler","tapHold",TapHold),Map.mergeOptions({touchZoom:Browser.touch,bounceAtZoomLimits:!0});var TouchZoom=Handler.extend({addHooks:__name(function(){addClass(this._map._container,"leaflet-touch-zoom"),on(this._map._container,"touchstart",this._onTouchStart,this)},"addHooks"),removeHooks:__name(function(){removeClass(this._map._container,"leaflet-touch-zoom"),off(this._map._container,"touchstart",this._onTouchStart,this)},"removeHooks"),_onTouchStart:__name(function(e){var map2=this._map;if(!(!e.touches||e.touches.length!==2||map2._animatingZoom||this._zooming)){var p1=map2.mouseEventToContainerPoint(e.touches[0]),p2=map2.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=map2.getSize()._divideBy(2),this._startLatLng=map2.containerPointToLatLng(this._centerPoint),map2.options.touchZoom!=="center"&&(this._pinchStartLatLng=map2.containerPointToLatLng(p1.add(p2)._divideBy(2))),this._startDist=p1.distanceTo(p2),this._startZoom=map2.getZoom(),this._moved=!1,this._zooming=!0,map2._stop(),on(document,"touchmove",this._onTouchMove,this),on(document,"touchend touchcancel",this._onTouchEnd,this),preventDefault(e)}},"_onTouchStart"),_onTouchMove:__name(function(e){if(!(!e.touches||e.touches.length!==2||!this._zooming)){var map2=this._map,p1=map2.mouseEventToContainerPoint(e.touches[0]),p2=map2.mouseEventToContainerPoint(e.touches[1]),scale2=p1.distanceTo(p2)/this._startDist;if(this._zoom=map2.getScaleZoom(scale2,this._startZoom),!map2.options.bounceAtZoomLimits&&(this._zoom<map2.getMinZoom()&&scale2<1||this._zoom>map2.getMaxZoom()&&scale2>1)&&(this._zoom=map2._limitZoom(this._zoom)),map2.options.touchZoom==="center"){if(this._center=this._startLatLng,scale2===1)return}else{var delta=p1._add(p2)._divideBy(2)._subtract(this._centerPoint);if(scale2===1&&delta.x===0&&delta.y===0)return;this._center=map2.unproject(map2.project(this._pinchStartLatLng,this._zoom).subtract(delta),this._zoom)}this._moved||(map2._moveStart(!0,!1),this._moved=!0),cancelAnimFrame(this._animRequest);var moveFn=bind(map2._move,map2,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=requestAnimFrame(moveFn,this,!0),preventDefault(e)}},"_onTouchMove"),_onTouchEnd:__name(function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,cancelAnimFrame(this._animRequest),off(document,"touchmove",this._onTouchMove,this),off(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))},"_onTouchEnd")});Map.addInitHook("addHandler","touchZoom",TouchZoom),Map.BoxZoom=BoxZoom,Map.DoubleClickZoom=DoubleClickZoom,Map.Drag=Drag,Map.Keyboard=Keyboard,Map.ScrollWheelZoom=ScrollWheelZoom,Map.TapHold=TapHold,Map.TouchZoom=TouchZoom,exports$12.Bounds=Bounds,exports$12.Browser=Browser,exports$12.CRS=CRS,exports$12.Canvas=Canvas,exports$12.Circle=Circle,exports$12.CircleMarker=CircleMarker,exports$12.Class=Class,exports$12.Control=Control,exports$12.DivIcon=DivIcon,exports$12.DivOverlay=DivOverlay,exports$12.DomEvent=DomEvent,exports$12.DomUtil=DomUtil,exports$12.Draggable=Draggable,exports$12.Evented=Evented,exports$12.FeatureGroup=FeatureGroup,exports$12.GeoJSON=GeoJSON,exports$12.GridLayer=GridLayer,exports$12.Handler=Handler,exports$12.Icon=Icon,exports$12.ImageOverlay=ImageOverlay,exports$12.LatLng=LatLng,exports$12.LatLngBounds=LatLngBounds,exports$12.Layer=Layer,exports$12.LayerGroup=LayerGroup,exports$12.LineUtil=LineUtil,exports$12.Map=Map,exports$12.Marker=Marker,exports$12.Mixin=Mixin,exports$12.Path=Path,exports$12.Point=Point,exports$12.PolyUtil=PolyUtil,exports$12.Polygon=Polygon,exports$12.Polyline=Polyline,exports$12.Popup=Popup,exports$12.PosAnimation=PosAnimation,exports$12.Projection=index,exports$12.Rectangle=Rectangle,exports$12.Renderer=Renderer,exports$12.SVG=SVG,exports$12.SVGOverlay=SVGOverlay,exports$12.TileLayer=TileLayer,exports$12.Tooltip=Tooltip,exports$12.Transformation=Transformation,exports$12.Util=Util,exports$12.VideoOverlay=VideoOverlay,exports$12.bind=bind,exports$12.bounds=toBounds,exports$12.canvas=canvas,exports$12.circle=circle,exports$12.circleMarker=circleMarker,exports$12.control=control,exports$12.divIcon=divIcon,exports$12.extend=extend,exports$12.featureGroup=featureGroup,exports$12.geoJSON=geoJSON,exports$12.geoJson=geoJson,exports$12.gridLayer=gridLayer,exports$12.icon=icon,exports$12.imageOverlay=imageOverlay2,exports$12.latLng=toLatLng,exports$12.latLngBounds=toLatLngBounds,exports$12.layerGroup=layerGroup2,exports$12.map=createMap2,exports$12.marker=marker2,exports$12.point=toPoint,exports$12.polygon=polygon,exports$12.polyline=polyline,exports$12.popup=popup,exports$12.rectangle=rectangle2,exports$12.setOptions=setOptions,exports$12.stamp=stamp,exports$12.svg=svg,exports$12.svgOverlay=svgOverlay,exports$12.tileLayer=tileLayer2,exports$12.tooltip=tooltip,exports$12.transformation=toTransformation,exports$12.version=version,exports$12.videoOverlay=videoOverlay;var oldL=window.L;exports$12.noConflict=function(){return window.L=oldL,this},window.L=exports$12}))})(leafletSrc$1,leafletSrc$1.exports)),leafletSrc$1.exports}__name(requireLeafletSrc,"requireLeafletSrc");var map={},hasRequiredMap;function requireMap(){if(hasRequiredMap)return map;hasRequiredMap=1,Object.defineProperty(map,"__esModule",{value:!0}),map.Map=void 0;const _Map=class _Map{constructor(leafletMap){Object.defineProperty(this,"leafletMap",{enumerable:!0,configurable:!0,writable:!0,value:leafletMap}),Object.defineProperty(this,"listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this.setupListeners()}addListener(event,callback){return this.listeners[event]||(this.listeners[event]=[]),this.listeners[event].push(callback),this}flyTo(latlng,zoom=null){return this.getMap().flyTo(latlng,zoom??this.getZoom()),this}getZoom(){return this.getMap().getZoom()}setZoom(zoom){return this.getMap().setZoom(zoom),this}getCenter(){return this.getMap().getCenter()}setView(latlng,zoom){return this.getMap().setView(latlng,zoom),this}getMap(){return this.leafletMap}getAddable(){return this.getMap()}invalidateSize(){return this.getMap().invalidateSize(),this}setupListeners(){["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","preclick"].forEach(event=>{this.getMap().on(event,e=>{var _a2;(_a2=this.listeners[event])===null||_a2===void 0||_a2.forEach(callback=>{var _a3,_b;callback({originalEvent:(_a3=e?.originalEvent)!==null&&_a3!==void 0?_a3:null,latLng:(_b=e.latlng)!==null&&_b!==void 0?_b:null})})})})}};__name(_Map,"Map");let Map=_Map;return map.Map=Map,map}__name(requireMap,"requireMap");var hasRequiredCreateMap;function requireCreateMap(){if(hasRequiredCreateMap)return createMap;hasRequiredCreateMap=1;var __importDefault=createMap&&createMap.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(createMap,"__esModule",{value:!0}),createMap.CreateMap=void 0;const leaflet_1=__importDefault(requireLeafletSrc()),map_1=requireMap(),_CreateMap=class _CreateMap{constructor(options){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:options})}create(){var _a2,_b,_c,_d,_e;const map2=leaflet_1.default.map(this.options.id,{scrollWheelZoom:(_a2=this.options.scrollWheelZoom)!==null&&_a2!==void 0?_a2:!1,keyboard:(_b=this.options.keyboard)!==null&&_b!==void 0?_b:!1,center:(_c=this.options.center)!==null&&_c!==void 0?_c:{lat:59.32932,lng:18.06858},zoom:(_d=this.options.zoom)!==null&&_d!==void 0?_d:16,zoomControl:(_e=this.options.zoomControl)!==null&&_e!==void 0?_e:!0,attributionControl:!1});return new map_1.Map(map2)}};__name(_CreateMap,"CreateMap");let CreateMap=_CreateMap;return createMap.CreateMap=CreateMap,createMap}__name(requireCreateMap,"requireCreateMap");var createMapInterface={},hasRequiredCreateMapInterface;function requireCreateMapInterface(){return hasRequiredCreateMapInterface||(hasRequiredCreateMapInterface=1,Object.defineProperty(createMapInterface,"__esModule",{value:!0})),createMapInterface}__name(requireCreateMapInterface,"requireCreateMapInterface");var mapInterface={},hasRequiredMapInterface;function requireMapInterface(){return hasRequiredMapInterface||(hasRequiredMapInterface=1,Object.defineProperty(mapInterface,"__esModule",{value:!0})),mapInterface}__name(requireMapInterface,"requireMapInterface");var createTileLayer={},tileLayer={},hasRequiredTileLayer;function requireTileLayer(){if(hasRequiredTileLayer)return tileLayer;hasRequiredTileLayer=1,Object.defineProperty(tileLayer,"__esModule",{value:!0}),tileLayer.TileLayer=void 0;const _TileLayer=class _TileLayer{constructor(tileLayer2){Object.defineProperty(this,"tileLayer",{enumerable:!0,configurable:!0,writable:!0,value:tileLayer2})}addTo(addable){return this.getTileLayer().addTo(addable.getAddable()),this}removeTileLayer(){return this.getTileLayer().remove(),this}setUrl(url){return this.getTileLayer().setUrl(url),this}getTileLayer(){return this.tileLayer}};__name(_TileLayer,"TileLayer");let TileLayer=_TileLayer;return tileLayer.TileLayer=TileLayer,tileLayer}__name(requireTileLayer,"requireTileLayer");var hasRequiredCreateTileLayer;function requireCreateTileLayer(){if(hasRequiredCreateTileLayer)return createTileLayer;hasRequiredCreateTileLayer=1;var __importDefault=createTileLayer&&createTileLayer.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(createTileLayer,"__esModule",{value:!0}),createTileLayer.CreateTileLayer=void 0;const leaflet_1=__importDefault(requireLeafletSrc()),tileLayer_1=requireTileLayer(),_CreateTileLayer=class _CreateTileLayer{constructor(){}create(tileLayerOptions={}){var _a2,_b,_c,_d,_e,_f;const tileLayer2=leaflet_1.default.tileLayer((_a2=tileLayerOptions.url)!==null&&_a2!==void 0?_a2:"",{maxZoom:(_b=tileLayerOptions.maxZoom)!==null&&_b!==void 0?_b:18,minZoom:(_c=tileLayerOptions.minZoom)!==null&&_c!==void 0?_c:0,tileSize:(_d=tileLayerOptions.tileSize)!==null&&_d!==void 0?_d:256,opacity:(_e=tileLayerOptions.opacity)!==null&&_e!==void 0?_e:1,className:(_f=tileLayerOptions.className)!==null&&_f!==void 0?_f:""});return new tileLayer_1.TileLayer(tileLayer2)}};__name(_CreateTileLayer,"CreateTileLayer");let CreateTileLayer=_CreateTileLayer;return createTileLayer.CreateTileLayer=CreateTileLayer,createTileLayer}__name(requireCreateTileLayer,"requireCreateTileLayer");var createTileLayerInterface={},hasRequiredCreateTileLayerInterface;function requireCreateTileLayerInterface(){return hasRequiredCreateTileLayerInterface||(hasRequiredCreateTileLayerInterface=1,Object.defineProperty(createTileLayerInterface,"__esModule",{value:!0})),createTileLayerInterface}__name(requireCreateTileLayerInterface,"requireCreateTileLayerInterface");var tileLayerInterface={},hasRequiredTileLayerInterface;function requireTileLayerInterface(){return hasRequiredTileLayerInterface||(hasRequiredTileLayerInterface=1,Object.defineProperty(tileLayerInterface,"__esModule",{value:!0})),tileLayerInterface}__name(requireTileLayerInterface,"requireTileLayerInterface");var createLayerGroup={},layerGroup={},hasRequiredLayerGroup;function requireLayerGroup(){if(hasRequiredLayerGroup)return layerGroup;hasRequiredLayerGroup=1,Object.defineProperty(layerGroup,"__esModule",{value:!0}),layerGroup.LayerGroup=void 0;const _LayerGroup=class _LayerGroup{constructor(leafletLayer){Object.defineProperty(this,"leafletLayer",{enumerable:!0,configurable:!0,writable:!0,value:leafletLayer})}removeLayerGroup(){return this.getLayerGroup().remove(),this}removeLayerGroupFrom(addable){return this.getLayerGroup().removeFrom(addable.getAddable()),this}addTo(addable){return this.getLayerGroup().addTo(addable.getAddable()),this}getAddable(){return this.getLayerGroup()}getLayerGroup(){return this.leafletLayer}};__name(_LayerGroup,"LayerGroup");let LayerGroup=_LayerGroup;return layerGroup.LayerGroup=LayerGroup,layerGroup}__name(requireLayerGroup,"requireLayerGroup");var hasRequiredCreateLayerGroup;function requireCreateLayerGroup(){if(hasRequiredCreateLayerGroup)return createLayerGroup;hasRequiredCreateLayerGroup=1;var __importDefault=createLayerGroup&&createLayerGroup.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(createLayerGroup,"__esModule",{value:!0}),createLayerGroup.CreateLayerGroup=void 0;const leaflet_1=__importDefault(requireLeafletSrc()),layerGroup_1=requireLayerGroup(),_CreateLayerGroup=class _CreateLayerGroup{constructor(){}create(){const layer=leaflet_1.default.layerGroup();return new layerGroup_1.LayerGroup(layer)}};__name(_CreateLayerGroup,"CreateLayerGroup");let CreateLayerGroup=_CreateLayerGroup;return createLayerGroup.CreateLayerGroup=CreateLayerGroup,createLayerGroup}__name(requireCreateLayerGroup,"requireCreateLayerGroup");var createLayerGroupInterface={},hasRequiredCreateLayerGroupInterface;function requireCreateLayerGroupInterface(){return hasRequiredCreateLayerGroupInterface||(hasRequiredCreateLayerGroupInterface=1,Object.defineProperty(createLayerGroupInterface,"__esModule",{value:!0})),createLayerGroupInterface}__name(requireCreateLayerGroupInterface,"requireCreateLayerGroupInterface");var layerGroupInterface={},hasRequiredLayerGroupInterface;function requireLayerGroupInterface(){return hasRequiredLayerGroupInterface||(hasRequiredLayerGroupInterface=1,Object.defineProperty(layerGroupInterface,"__esModule",{value:!0})),layerGroupInterface}__name(requireLayerGroupInterface,"requireLayerGroupInterface");var createRectangle={},rectangle={},hasRequiredRectangle;function requireRectangle(){if(hasRequiredRectangle)return rectangle;hasRequiredRectangle=1;var __importDefault=rectangle&&rectangle.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(rectangle,"__esModule",{value:!0}),rectangle.Rectangle=void 0;const leaflet_1=__importDefault(requireLeafletSrc()),_Rectangle=class _Rectangle{constructor(leafletRectangle){Object.defineProperty(this,"leafletRectangle",{enumerable:!0,configurable:!0,writable:!0,value:leafletRectangle}),Object.defineProperty(this,"listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this.setupListeners()}setPosition(latLngBoundsObject){const southWest=leaflet_1.default.latLng(latLngBoundsObject.southWest.lat,latLngBoundsObject.southWest.lng),northEast=leaflet_1.default.latLng(latLngBoundsObject.northEast.lat,latLngBoundsObject.northEast.lng),bounds=leaflet_1.default.latLngBounds(southWest,northEast);return this.getRectangle().setBounds(bounds),this}getPosition(){const bounds=this.getRectangle().getBounds();return{southWest:{lat:bounds.getSouthWest().lat,lng:bounds.getSouthWest().lng},northEast:{lat:bounds.getNorthEast().lat,lng:bounds.getNorthEast().lng}}}addTo(addable){return this.getRectangle().addTo(addable.getAddable()),this}addListener(event,callback){return this.listeners[event]||(this.listeners[event]=[]),this.listeners[event].push(callback),this}removeRectangle(){return this.getRectangle().remove(),this}getRectangle(){return this.leafletRectangle}setupListeners(){["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","preclick","drag"].forEach(event=>{this.getRectangle().on(event,e=>{var _a2;(_a2=this.listeners[event])===null||_a2===void 0||_a2.forEach(callback=>{var _a3,_b;callback({originalEvent:(_a3=e?.originalEvent)!==null&&_a3!==void 0?_a3:null,latLng:(_b=e.latlng)!==null&&_b!==void 0?_b:null})})})})}};__name(_Rectangle,"Rectangle");let Rectangle=_Rectangle;return rectangle.Rectangle=Rectangle,rectangle}__name(requireRectangle,"requireRectangle");var hasRequiredCreateRectangle;function requireCreateRectangle(){if(hasRequiredCreateRectangle)return createRectangle;hasRequiredCreateRectangle=1;var __importDefault=createRectangle&&createRectangle.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(createRectangle,"__esModule",{value:!0}),createRectangle.CreateRectangle=void 0;const leaflet_1=__importDefault(requireLeafletSrc()),rectangle_1=requireRectangle(),_CreateRectangle=class _CreateRectangle{create(latLngBounds,rectangleOptions={}){const rectangle2=leaflet_1.default.rectangle([[latLngBounds.southWest.lat,latLngBounds.southWest.lng],[latLngBounds.northEast.lat,latLngBounds.northEast.lng]],rectangleOptions);return new rectangle_1.Rectangle(rectangle2)}};__name(_CreateRectangle,"CreateRectangle");let CreateRectangle=_CreateRectangle;return createRectangle.CreateRectangle=CreateRectangle,createRectangle}__name(requireCreateRectangle,"requireCreateRectangle");var createRectangleInterface={},hasRequiredCreateRectangleInterface;function requireCreateRectangleInterface(){return hasRequiredCreateRectangleInterface||(hasRequiredCreateRectangleInterface=1,Object.defineProperty(createRectangleInterface,"__esModule",{value:!0})),createRectangleInterface}__name(requireCreateRectangleInterface,"requireCreateRectangleInterface");var rectangleInterface={},hasRequiredRectangleInterface;function requireRectangleInterface(){return hasRequiredRectangleInterface||(hasRequiredRectangleInterface=1,Object.defineProperty(rectangleInterface,"__esModule",{value:!0})),rectangleInterface}__name(requireRectangleInterface,"requireRectangleInterface");var createMarker={},marker={},hasRequiredMarker;function requireMarker(){if(hasRequiredMarker)return marker;hasRequiredMarker=1;var __importDefault=marker&&marker.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(marker,"__esModule",{value:!0}),marker.Marker=void 0;const leaflet_1=__importDefault(requireLeafletSrc()),_Marker=class _Marker{constructor(marker2){Object.defineProperty(this,"marker",{enumerable:!0,configurable:!0,writable:!0,value:marker2}),Object.defineProperty(this,"listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this.setupListeners()}addTo(addable){return this.getMarker().addTo(addable.getAddable()),this}addListener(event,callback){return this.listeners[event]||(this.listeners[event]=[]),this.listeners[event].push(callback),this}setPosition(position){return this.marker.setLatLng(position),this}getPosition(){return this.marker.getLatLng()}removeMarker(){return this.getMarker().remove(),this}getMarker(){return this.marker}getElement(){return this.marker.getElement()}setIcon(iconOptions){return this.marker.setIcon(leaflet_1.default.divIcon(iconOptions)),this}isPopupOpen(){return this.marker.isPopupOpen()}setupListeners(){return["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","preclick","drag","dragend","dragstart","popupopen","popupclose"].forEach(event=>{this.marker.on(event,e=>{var _a2;(_a2=this.listeners[event])===null||_a2===void 0||_a2.forEach(callback=>{var _a3,_b;callback({originalEvent:(_a3=e?.originalEvent)!==null&&_a3!==void 0?_a3:null,latLng:(_b=e.latlng)!==null&&_b!==void 0?_b:this.getPosition()})})})}),this}};__name(_Marker,"Marker");let Marker=_Marker;return marker.Marker=Marker,marker}__name(requireMarker,"requireMarker");var hasRequiredCreateMarker;function requireCreateMarker(){if(hasRequiredCreateMarker)return createMarker;hasRequiredCreateMarker=1;var __importDefault=createMarker&&createMarker.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(createMarker,"__esModule",{value:!0}),createMarker.CreateMarker=void 0;const leaflet_1=__importDefault(requireLeafletSrc()),marker_1=requireMarker(),_CreateMarker=class _CreateMarker{constructor(){}create(markerOptions,tooltipOptions=null){var _a2,_b,_c,_d,_e,_f,_g,_h,_j;const icon=leaflet_1.default.divIcon({className:(_a2=markerOptions.className)!==null&&_a2!==void 0?_a2:"",html:markerOptions.html,iconSize:(_b=markerOptions.iconSize)!==null&&_b!==void 0?_b:[24,24],iconAnchor:(_c=markerOptions.iconAnchor)!==null&&_c!==void 0?_c:[24,24]}),marker2=leaflet_1.default.marker(markerOptions.position,{icon,draggable:(_d=markerOptions.draggable)!==null&&_d!==void 0?_d:!1});return tooltipOptions&&marker2.bindPopup(tooltipOptions.content,{closeButton:(_e=tooltipOptions.closeButton)!==null&&_e!==void 0?_e:!0,maxHeight:(_f=tooltipOptions.maxHeight)!==null&&_f!==void 0?_f:100,maxWidth:(_g=tooltipOptions.maxWidth)!==null&&_g!==void 0?_g:250,className:(_h=tooltipOptions.className)!==null&&_h!==void 0?_h:"",offset:(_j=tooltipOptions.offset)!==null&&_j!==void 0?_j:[0,7]}),new marker_1.Marker(marker2)}};__name(_CreateMarker,"CreateMarker");let CreateMarker=_CreateMarker;return createMarker.CreateMarker=CreateMarker,createMarker}__name(requireCreateMarker,"requireCreateMarker");var createMarkerInterface={},hasRequiredCreateMarkerInterface;function requireCreateMarkerInterface(){return hasRequiredCreateMarkerInterface||(hasRequiredCreateMarkerInterface=1,Object.defineProperty(createMarkerInterface,"__esModule",{value:!0})),createMarkerInterface}__name(requireCreateMarkerInterface,"requireCreateMarkerInterface");var markerInterface={},hasRequiredMarkerInterface;function requireMarkerInterface(){return hasRequiredMarkerInterface||(hasRequiredMarkerInterface=1,Object.defineProperty(markerInterface,"__esModule",{value:!0})),markerInterface}__name(requireMarkerInterface,"requireMarkerInterface");var createImageOverlay={},imageOverlay={},hasRequiredImageOverlay;function requireImageOverlay(){if(hasRequiredImageOverlay)return imageOverlay;hasRequiredImageOverlay=1;var __importDefault=imageOverlay&&imageOverlay.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(imageOverlay,"__esModule",{value:!0}),imageOverlay.ImageOverlay=void 0;const leaflet_1=__importDefault(requireLeafletSrc()),_ImageOverlay=class _ImageOverlay{constructor(leafletOverlay){Object.defineProperty(this,"leafletOverlay",{enumerable:!0,configurable:!0,writable:!0,value:leafletOverlay}),Object.defineProperty(this,"listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this.setupListeners()}addListener(event,callback){return this.listeners[event]||(this.listeners[event]=[]),this.listeners[event].push(callback),this}addTo(addable){return this.getImageOverlay().addTo(addable.getAddable()),this}setPosition(latLngBounds){const southWest=leaflet_1.default.latLng(latLngBounds.southWest.lat,latLngBounds.southWest.lng),northEast=leaflet_1.default.latLng(latLngBounds.northEast.lat,latLngBounds.northEast.lng),bounds=leaflet_1.default.latLngBounds(southWest,northEast);return this.getImageOverlay().setBounds(bounds),this}getPosition(){const bounds=this.getImageOverlay().getBounds();return{southWest:{lat:bounds.getSouthWest().lat,lng:bounds.getSouthWest().lng},northEast:{lat:bounds.getNorthEast().lat,lng:bounds.getNorthEast().lng}}}getCenter(){const center=this.getImageOverlay().getBounds().getCenter();return{lat:center.lat,lng:center.lng}}setOpacity(opacity){return this.getImageOverlay().setOpacity(opacity),this}removeImageOverlay(){return this.getImageOverlay().remove(),this}getElement(){return this.getImageOverlay().getElement()}getImageOverlay(){return this.leafletOverlay}setupListeners(){["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove"].forEach(event=>{this.getImageOverlay().on(event,e=>{var _a2;(_a2=this.listeners[event])===null||_a2===void 0||_a2.forEach(callback=>{var _a3,_b;callback({originalEvent:(_a3=e?.originalEvent)!==null&&_a3!==void 0?_a3:null,latLng:(_b=e.latlng)!==null&&_b!==void 0?_b:this.getPosition()})})})})}};__name(_ImageOverlay,"ImageOverlay");let ImageOverlay=_ImageOverlay;return imageOverlay.ImageOverlay=ImageOverlay,imageOverlay}__name(requireImageOverlay,"requireImageOverlay");var hasRequiredCreateImageOverlay;function requireCreateImageOverlay(){if(hasRequiredCreateImageOverlay)return createImageOverlay;hasRequiredCreateImageOverlay=1;var __importDefault=createImageOverlay&&createImageOverlay.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(createImageOverlay,"__esModule",{value:!0}),createImageOverlay.CreateImageOverlay=void 0;const imageOverlay_1=requireImageOverlay(),leaflet_1=__importDefault(requireLeafletSrc()),_CreateImageOverlay=class _CreateImageOverlay{create(imageOverlayOptions){const url=imageOverlayOptions.url,latLngBounds=[[imageOverlayOptions.bounds.southWest.lat,imageOverlayOptions.bounds.southWest.lng],[imageOverlayOptions.bounds.northEast.lat,imageOverlayOptions.bounds.northEast.lng]],imageOverlay2=leaflet_1.default.imageOverlay(url,latLngBounds,imageOverlayOptions);return new imageOverlay_1.ImageOverlay(imageOverlay2)}};__name(_CreateImageOverlay,"CreateImageOverlay");let CreateImageOverlay=_CreateImageOverlay;return createImageOverlay.CreateImageOverlay=CreateImageOverlay,createImageOverlay}__name(requireCreateImageOverlay,"requireCreateImageOverlay");var createImageOverlayInterface={},hasRequiredCreateImageOverlayInterface;function requireCreateImageOverlayInterface(){return hasRequiredCreateImageOverlayInterface||(hasRequiredCreateImageOverlayInterface=1,Object.defineProperty(createImageOverlayInterface,"__esModule",{value:!0})),createImageOverlayInterface}__name(requireCreateImageOverlayInterface,"requireCreateImageOverlayInterface");var imageOverlayInterface={},hasRequiredImageOverlayInterface;function requireImageOverlayInterface(){return hasRequiredImageOverlayInterface||(hasRequiredImageOverlayInterface=1,Object.defineProperty(imageOverlayInterface,"__esModule",{value:!0})),imageOverlayInterface}__name(requireImageOverlayInterface,"requireImageOverlayInterface");var createAttribution={},attribution={},hasRequiredAttribution;function requireAttribution(){if(hasRequiredAttribution)return attribution;hasRequiredAttribution=1,Object.defineProperty(attribution,"__esModule",{value:!0}),attribution.Attribution=void 0;const _Attribution=class _Attribution{constructor(leafletAttribution){Object.defineProperty(this,"leafletAttribution",{enumerable:!0,configurable:!0,writable:!0,value:leafletAttribution})}addAttribution(attributionText){return this.getAttribution().addAttribution(attributionText),this}setPrefix(prefix){return this.getAttribution().setPrefix(prefix),this}removePrefix(){return this.getAttribution().setPrefix(!1),this}addTo(mapInterface2){return this.getAttribution().addTo(mapInterface2.getAddable()),this}setPosition(position){return this.getAttribution().setPosition(position),this}removeAttribution(){return this.getAttribution().remove(),this}getAttribution(){return this.leafletAttribution}};__name(_Attribution,"Attribution");let Attribution=_Attribution;return attribution.Attribution=Attribution,attribution}__name(requireAttribution,"requireAttribution");var hasRequiredCreateAttribution;function requireCreateAttribution(){if(hasRequiredCreateAttribution)return createAttribution;hasRequiredCreateAttribution=1;var __importDefault=createAttribution&&createAttribution.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(createAttribution,"__esModule",{value:!0}),createAttribution.CreateAttribution=void 0;const leaflet_1=__importDefault(requireLeafletSrc()),attribution_1=requireAttribution(),_CreateAttribution=class _CreateAttribution{constructor(){}create(attributionOptions={}){var _a2,_b;const attribution2=leaflet_1.default.control.attribution({position:(_a2=attributionOptions.position)!==null&&_a2!==void 0?_a2:"bottomleft",prefix:(_b=attributionOptions.prefix)!==null&&_b!==void 0?_b:!1});return new attribution_1.Attribution(attribution2)}};__name(_CreateAttribution,"CreateAttribution");let CreateAttribution=_CreateAttribution;return createAttribution.CreateAttribution=CreateAttribution,createAttribution}__name(requireCreateAttribution,"requireCreateAttribution");var createAttributionInterface={},hasRequiredCreateAttributionInterface;function requireCreateAttributionInterface(){return hasRequiredCreateAttributionInterface||(hasRequiredCreateAttributionInterface=1,Object.defineProperty(createAttributionInterface,"__esModule",{value:!0})),createAttributionInterface}__name(requireCreateAttributionInterface,"requireCreateAttributionInterface");var attributionInterface={},hasRequiredAttributionInterface;function requireAttributionInterface(){return hasRequiredAttributionInterface||(hasRequiredAttributionInterface=1,Object.defineProperty(attributionInterface,"__esModule",{value:!0})),attributionInterface}__name(requireAttributionInterface,"requireAttributionInterface");var createSearch={},api={},hasRequiredApi;function requireApi(){if(hasRequiredApi)return api;hasRequiredApi=1,Object.defineProperty(api,"__esModule",{value:!0}),api.SearchApi=void 0;const _SearchApi=class _SearchApi{constructor(){Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"searchParam",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"searchListeners",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"searchResults",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"searching",{enumerable:!0,configurable:!0,writable:!0,value:!1})}search(question){if(this.apiUrl===null||this.searchParam===null)throw new Error("API URL and search parameter must be set before searching.");if(this.searchResults[question])return Promise.resolve(this.searchResults[question]);if(question.length<1)return this.searchListeners.forEach(callback=>callback([])),Promise.resolve([]);const url=new URL(this.apiUrl);return url.searchParams.set(this.searchParam,question),this.searching=!0,fetch(url.toString()).then(response=>response.json()).then(data=>{const modifiedData=this.searchListeners.reduce((currentData,callback)=>callback(currentData),data);return this.searchResults[question]=modifiedData,modifiedData}).catch(error=>(console.error("Error:",error),Promise.resolve([]))).finally(()=>{this.searching=!1})}addSearchResponseCallback(callback){return this.searchListeners.push(callback),this}isSearching(){return this.searching}setSearchParam(searchParam){return this.searchParam=searchParam,this}setApiUrl(url){return this.apiUrl=new URL(url),this}};__name(_SearchApi,"SearchApi");let SearchApi=_SearchApi;return api.SearchApi=SearchApi,api}__name(requireApi,"requireApi");var search={},hasRequiredSearch;function requireSearch(){if(hasRequiredSearch)return search;hasRequiredSearch=1,Object.defineProperty(search,"__esModule",{value:!0}),search.Search=void 0;const _Search=class _Search{constructor(apiInstance,searchUi2){Object.defineProperty(this,"apiInstance",{enumerable:!0,configurable:!0,writable:!0,value:apiInstance}),Object.defineProperty(this,"searchUi",{enumerable:!0,configurable:!0,writable:!0,value:searchUi2}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:""})}addSearchResponseCallback(searchEventCallback){return this.apiInstance.addSearchResponseCallback(searchEventCallback),this}addListItemListener(searchEventCallback){return this.searchUi.addListItemListener(searchEventCallback),this}setApiUrl(url){return this.apiInstance.setApiUrl(url),this}setSearchListItems(items){return this.searchUi.setSearchListItems(items),this}search(question){return this.apiInstance.search(question)}setSearchParam(searchParam){return this.apiInstance.setSearchParam(searchParam),this}addTo(map2){return this.searchUi.addTo(map2),this}removeSearch(){return this.searchUi.removeSearch(),this}getInput(){return this.searchUi.getInput()}getResetButton(){return this.searchUi.getResetButton()}showSpinner(){return this.searchUi.showSpinner(),this}hideSpinner(){return this.searchUi.hideSpinner(),this}showResetButton(){return this.searchUi.showResetButton(),this}hideResetButton(){return this.searchUi.hideResetButton(),this}isSearching(){return this.apiInstance.isSearching()}setValue(value){return this.searchUi.setValue(value),this}getTitleFromPlaceSchema(place){return this.searchUi.getTitleFromPlaceSchema(place)}getContainer(){return this.searchUi.getContainer()}};__name(_Search,"Search");let Search=_Search;return search.Search=Search,search}__name(requireSearch,"requireSearch");var searchUi={},hasRequiredSearchUi;function requireSearchUi(){if(hasRequiredSearchUi)return searchUi;hasRequiredSearchUi=1;var __importDefault=searchUi&&searchUi.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(searchUi,"__esModule",{value:!0}),searchUi.SearchUi=void 0;const leaflet_1=__importDefault(requireLeafletSrc()),_SearchUi=class _SearchUi{constructor(searchOptions,searchApi){Object.defineProperty(this,"searchOptions",{enumerable:!0,configurable:!0,writable:!0,value:searchOptions}),Object.defineProperty(this,"searchApi",{enumerable:!0,configurable:!0,writable:!0,value:searchApi}),Object.defineProperty(this,"searchContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"input",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resetButton",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"itemClickListeners",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"currentValue",{enumerable:!0,configurable:!0,writable:!0,value:""})}listenForInput(){var _a2;const debouncedSearch=this.debounce(value=>{this.showSpinner(),this.searchApi.search(value).then(data=>{this.hideSpinner(),this.setSearchListItems(data)})},500);(_a2=this.getInput())===null||_a2===void 0||_a2.addEventListener("input",e=>{const input=e.target;this.currentValue=input.value,this.currentValue.length>0?this.showResetButton():this.hideResetButton(),debouncedSearch(input.value)})}addListItemListener(searchEventCallback){return this.itemClickListeners.push(searchEventCallback),this}setSearchListItems(items){var _a2;const listContainer=this.getList();if(!listContainer)throw new Error("List container not found");return items===null?(listContainer.innerHTML="",this):(items.length<1&&this.currentValue.length>0?listContainer.innerHTML=`<li>${(_a2=this.searchOptions.noResultsText)!==null&&_a2!==void 0?_a2:"No items found."}</li>`:listContainer.innerHTML="",items.forEach(item=>{const listItem=this.createListItem(item);listItem.addEventListener("click",()=>{this.itemClickListeners.forEach(listener=>listener(item)),this.input&&(this.input.value=this.getTitleFromPlaceSchema(item),this.input.focus()),this.getList().innerHTML=""}),listContainer.appendChild(listItem)}),this)}createListItem(item){const title=this.getTitleFromPlaceSchema(item),li=document.createElement("li");return li.innerHTML=`<span>${title}</span>`,li}getTitleFromPlaceSchema(item){var _a2,_b;if(!item.address)return(_a2=item.name)!==null&&_a2!==void 0?_a2:"";if(typeof item.address!="object")return item.address;if("name"in item.address)return item.address.name;const address=[];return item.name&&address.push(item.name),"streetAddress"in item.address&&address.push(item.address.streetAddress),"addressLocality"in item.address&&address.push(item.address.addressLocality),"addressRegion"in item.address&&address.push(item.address.addressRegion),"postalCode"in item.address&&address.push(item.address.postalCode),"addressCountry"in item.address&&address.push(item.address.addressCountry),address.length>0?address.join(", "):(_b=item.name)!==null&&_b!==void 0?_b:""}addTo(map2){var _a2,_b,_c;const container=document.createElement("div");container.className=`openstreetmap__search ${this.searchOptions.className||""}`,container.innerHTML=`
            <div class="openstreetmap__search-container">
                <input type="text" placeholder="${(_a2=this.searchOptions.placeholder)!==null&&_a2!==void 0?_a2:"Search location..."}" />
                <span class="openstreetmap__search-spinner" data-js-search-spinner="true"></span>
                <span class="openstreetmap__search-reset" data-js-search-reset="true" role="button" aria-label="${(_b=this.searchOptions.resetButtonLabel)!==null&&_b!==void 0?_b:"Reset search"}">&#10005;</span>
            </div>
            <ul></ul>
        `;const controlContainer=(_c=map2.getAddable().getContainer())===null||_c===void 0?void 0:_c.querySelector(".leaflet-control-container");return controlContainer?.appendChild(container),this.searchContainer=container,leaflet_1.default.DomEvent.disableClickPropagation(this.getContainer()),leaflet_1.default.DomEvent.disableScrollPropagation(this.getContainer()),this.listenForInput(),this.listenForResetButton(),this}removeSearch(){var _a2;return(_a2=this.getContainer())===null||_a2===void 0||_a2.remove(),this.searchContainer=void 0,this.list=void 0,this.input=void 0,this}listenForResetButton(){var _a2;(_a2=this.getResetButton())===null||_a2===void 0||_a2.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.getResetButton().style.display="none",this.getList()&&(this.getList().innerHTML=""),this.getInput()&&(this.getInput().value="",this.getInput().focus())})}hideSpinner(){return this.getSpinner()?(this.getSpinner().style.display="none",this):this}showSpinner(){return this.getSpinner()?(this.getSpinner().style.display="inline-block",this):this}hideResetButton(){return this.getResetButton()?(this.getResetButton().style.display="none",this):this}showResetButton(){return this.getResetButton()?(this.getResetButton().style.display="block",this):this}setValue(value){return this.currentValue=value,this.getInput()&&(this.getInput().value=value),this}getContainer(){return this.searchContainer}getSpinner(){var _a2,_b;return this.spinner||(this.spinner=(_b=(_a2=this.getContainer())===null||_a2===void 0?void 0:_a2.querySelector("[data-js-search-spinner]"))!==null&&_b!==void 0?_b:void 0),this.spinner}getResetButton(){var _a2,_b;return this.resetButton||(this.resetButton=(_b=(_a2=this.getContainer())===null||_a2===void 0?void 0:_a2.querySelector("[data-js-search-reset]"))!==null&&_b!==void 0?_b:void 0),this.resetButton}getInput(){var _a2,_b;return this.input||(this.input=(_b=(_a2=this.getContainer())===null||_a2===void 0?void 0:_a2.querySelector("input"))!==null&&_b!==void 0?_b:void 0),this.input}getList(){var _a2,_b;return this.list||(this.list=(_b=(_a2=this.getContainer())===null||_a2===void 0?void 0:_a2.querySelector("ul"))!==null&&_b!==void 0?_b:void 0),this.list}debounce(func,wait){let timeout;return(...args)=>{clearTimeout(timeout),timeout=window.setTimeout(()=>func(...args),wait)}}};__name(_SearchUi,"SearchUi");let SearchUi=_SearchUi;return searchUi.SearchUi=SearchUi,searchUi}__name(requireSearchUi,"requireSearchUi");var hasRequiredCreateSearch;function requireCreateSearch(){if(hasRequiredCreateSearch)return createSearch;hasRequiredCreateSearch=1,Object.defineProperty(createSearch,"__esModule",{value:!0}),createSearch.CreateSearch=void 0;const api_1=requireApi(),search_1=requireSearch(),searchUi_1=requireSearchUi(),_CreateSearch=class _CreateSearch{constructor(){}create(searchOptions={}){const searchApi=new api_1.SearchApi;return new search_1.Search(searchApi,new searchUi_1.SearchUi(searchOptions,searchApi))}};__name(_CreateSearch,"CreateSearch");let CreateSearch=_CreateSearch;return createSearch.CreateSearch=CreateSearch,createSearch}__name(requireCreateSearch,"requireCreateSearch");var createSearchInterface={},hasRequiredCreateSearchInterface;function requireCreateSearchInterface(){return hasRequiredCreateSearchInterface||(hasRequiredCreateSearchInterface=1,Object.defineProperty(createSearchInterface,"__esModule",{value:!0})),createSearchInterface}__name(requireCreateSearchInterface,"requireCreateSearchInterface");var searchInterface={},hasRequiredSearchInterface;function requireSearchInterface(){return hasRequiredSearchInterface||(hasRequiredSearchInterface=1,Object.defineProperty(searchInterface,"__esModule",{value:!0})),searchInterface}__name(requireSearchInterface,"requireSearchInterface");var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,(function(exports$1){var __createBinding=dist&&dist.__createBinding||(Object.create?(function(o,m,k,k2){k2===void 0&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable))&&(desc={enumerable:!0,get:__name(function(){return m[k]},"get")}),Object.defineProperty(o,k2,desc)}):(function(o,m,k,k2){k2===void 0&&(k2=k),o[k2]=m[k]})),__exportStar=dist&&dist.__exportStar||function(m,exports$12){for(var p in m)p!=="default"&&!Object.prototype.hasOwnProperty.call(exports$12,p)&&__createBinding(exports$12,m,p)};Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.Search=exports$1.CreateSearch=exports$1.Attribution=exports$1.CreateAttribution=exports$1.ImageOverlay=exports$1.CreateImageOverlay=exports$1.Marker=exports$1.CreateMarker=exports$1.Rectangle=exports$1.CreateRectangle=exports$1.LayerGroup=exports$1.CreateLayerGroup=exports$1.TileLayer=exports$1.CreateTileLayer=exports$1.Map=exports$1.CreateMap=exports$1.TilesHelper=void 0,__exportStar(requireTypes(),exports$1),__exportStar(requireEventListenerInterface(),exports$1),__exportStar(requireAddableInterface(),exports$1),__exportStar(requireAddToInterface(),exports$1);var TilesHelper_1=requireTilesHelper();Object.defineProperty(exports$1,"TilesHelper",{enumerable:!0,get:__name(function(){return TilesHelper_1.TilesHelper},"get")}),__exportStar(requireTilesHelperInterface(),exports$1);var createMap_1=requireCreateMap();Object.defineProperty(exports$1,"CreateMap",{enumerable:!0,get:__name(function(){return createMap_1.CreateMap},"get")});var map_1=requireMap();Object.defineProperty(exports$1,"Map",{enumerable:!0,get:__name(function(){return map_1.Map},"get")}),__exportStar(requireCreateMapInterface(),exports$1),__exportStar(requireMapInterface(),exports$1);var createTileLayer_1=requireCreateTileLayer();Object.defineProperty(exports$1,"CreateTileLayer",{enumerable:!0,get:__name(function(){return createTileLayer_1.CreateTileLayer},"get")});var tileLayer_1=requireTileLayer();Object.defineProperty(exports$1,"TileLayer",{enumerable:!0,get:__name(function(){return tileLayer_1.TileLayer},"get")}),__exportStar(requireCreateTileLayerInterface(),exports$1),__exportStar(requireTileLayerInterface(),exports$1);var createLayerGroup_1=requireCreateLayerGroup();Object.defineProperty(exports$1,"CreateLayerGroup",{enumerable:!0,get:__name(function(){return createLayerGroup_1.CreateLayerGroup},"get")});var layerGroup_1=requireLayerGroup();Object.defineProperty(exports$1,"LayerGroup",{enumerable:!0,get:__name(function(){return layerGroup_1.LayerGroup},"get")}),__exportStar(requireCreateLayerGroupInterface(),exports$1),__exportStar(requireLayerGroupInterface(),exports$1);var createRectangle_1=requireCreateRectangle();Object.defineProperty(exports$1,"CreateRectangle",{enumerable:!0,get:__name(function(){return createRectangle_1.CreateRectangle},"get")});var rectangle_1=requireRectangle();Object.defineProperty(exports$1,"Rectangle",{enumerable:!0,get:__name(function(){return rectangle_1.Rectangle},"get")}),__exportStar(requireCreateRectangleInterface(),exports$1),__exportStar(requireRectangleInterface(),exports$1);var createMarker_1=requireCreateMarker();Object.defineProperty(exports$1,"CreateMarker",{enumerable:!0,get:__name(function(){return createMarker_1.CreateMarker},"get")});var marker_1=requireMarker();Object.defineProperty(exports$1,"Marker",{enumerable:!0,get:__name(function(){return marker_1.Marker},"get")}),__exportStar(requireCreateMarkerInterface(),exports$1),__exportStar(requireMarkerInterface(),exports$1);var createImageOverlay_1=requireCreateImageOverlay();Object.defineProperty(exports$1,"CreateImageOverlay",{enumerable:!0,get:__name(function(){return createImageOverlay_1.CreateImageOverlay},"get")});var imageOverlay_1=requireImageOverlay();Object.defineProperty(exports$1,"ImageOverlay",{enumerable:!0,get:__name(function(){return imageOverlay_1.ImageOverlay},"get")}),__exportStar(requireCreateImageOverlayInterface(),exports$1),__exportStar(requireImageOverlayInterface(),exports$1);var createAttribution_1=requireCreateAttribution();Object.defineProperty(exports$1,"CreateAttribution",{enumerable:!0,get:__name(function(){return createAttribution_1.CreateAttribution},"get")});var attribution_1=requireAttribution();Object.defineProperty(exports$1,"Attribution",{enumerable:!0,get:__name(function(){return attribution_1.Attribution},"get")}),__exportStar(requireCreateAttributionInterface(),exports$1),__exportStar(requireAttributionInterface(),exports$1);var createSearch_1=requireCreateSearch();Object.defineProperty(exports$1,"CreateSearch",{enumerable:!0,get:__name(function(){return createSearch_1.CreateSearch},"get")});var search_1=requireSearch();Object.defineProperty(exports$1,"Search",{enumerable:!0,get:__name(function(){return search_1.Search},"get")}),__exportStar(requireCreateSearchInterface(),exports$1),__exportStar(requireSearchInterface(),exports$1)})(dist)),dist}__name(requireDist,"requireDist");var distExports=requireDist();const _Openstreetmap=class _Openstreetmap{constructor(fetchPlaceFromLatLng,createPlaceFromLatLng,modularityFrontendFormData2,modularityFrontendFormLang2,parent,id,lat,lng,zoom){this.fetchPlaceFromLatLng=fetchPlaceFromLatLng,this.createPlaceFromLatLng=createPlaceFromLatLng,this.modularityFrontendFormData=modularityFrontendFormData2,this.modularityFrontendFormLang=modularityFrontendFormLang2,this.parent=parent,this.id=id,this.lat=lat,this.lng=lng,this.zoom=zoom}search;marker=null;map;createMarker;markerMovedListeners=[];fetching=!1;currentPlace=null;init(){this.map=new distExports.CreateMap({id:this.id,center:{lat:this.lat,lng:this.lng},zoom:this.zoom}).create(),this.createMarker=new distExports.CreateMarker;const tiles=new distExports.TilesHelper().getDefaultTiles("default");new distExports.CreateAttribution().create().setPrefix(tiles.attribution).addTo(this.map),new distExports.CreateTileLayer().create().setUrl(tiles.url).addTo(this.map),this.search=new distExports.CreateSearch().create({noResultsText:this.modularityFrontendFormLang.noResultsFound??"No items found.",placeholder:this.modularityFrontendFormLang.searchPlaceholder??"Search location..."}).setApiUrl(this.modularityFrontendFormData.placeSearchApiUrl).setSearchParam("q").addTo(this.map).addListItemListener(e=>this.handleListItemClick(e)),setTimeout(()=>{this.map.invalidateSize()},100),this.map.addListener("click",e=>this.handleClick(e)),this.setResetButtonClickListener()}getMap(){return this.map}hasPlaceData(){return this.currentPlace!==null}getMarker(){return this.marker??null}isFetchingPlace(){return this.fetching}addMarkerMovedListener(callback){this.markerMovedListeners.push(callback)}handleClick(e){if(!e.latLng){console.error("No latLng found in event data");return}if(!e.originalEvent){console.error("No originalEvent found in event data");return}e.originalEvent.target&&e.originalEvent.target.classList.contains("mod-frontend-form__openstreetmap")&&this.addOrMoveMarker(e.latLng)}setResetButtonClickListener(){this.search.getResetButton()?.addEventListener("click",()=>{this.marker?.removeMarker(),this.marker=null,this.currentPlace=null,this.callMarkerMovedListeners()})}handleListItemClick(item){const latLng={lat:item.latitude??0,lng:item.longitude??0};this.addOrMoveMarker(latLng,item),this.map.flyTo(latLng,15)}addOrMoveMarker(latLng,placeObject=null){this.marker?this.marker.setPosition(latLng):(this.marker=this.createMarker.create({html:this.getIconHtml(),position:latLng}),this.marker.addTo(this.map)),this.maybeFetchPlace(latLng,placeObject)}callMarkerMovedListeners(){this.markerMovedListeners.forEach(callback=>{callback(this.currentPlace)})}async maybeFetchPlace(latLng,placeObject=null){if(placeObject){this.currentPlace=placeObject,this.callMarkerMovedListeners(),this.updateSearchInput();return}this.fetching=!0,this.search.getInput()&&(this.search.setValue((this.modularityFrontendFormLang.loading??"Loading")+"..."),this.search.showSpinner());try{this.currentPlace=await this.fetchPlaceFromLatLng.fetch(latLng.lat,latLng.lng),this.currentPlace&&this.callMarkerMovedListeners(),this.updateSearchInput()}catch(error){this.currentPlace=this.createPlaceFromLatLng.create(latLng),this.callMarkerMovedListeners(),this.updateSearchInput(),console.warn("Failed to fetch place:",error)}finally{this.fetching=!1}}updateSearchInput(){this.search.getInput()&&this.currentPlace&&(this.search.setSearchListItems(null),this.search.getInput().value=this.search.getTitleFromPlaceSchema(this.currentPlace),this.search.showResetButton(),this.search.hideSpinner(),setTimeout(()=>{this.search.getInput().scrollLeft=0},0))}getIconHtml(){return'<span data-material-symbol="location_on" class="mod-frontend-form__openstreetmap-icon material-symbols material-symbols-rounded material-symbols-sharp material-symbols-outlined material-symbols--filled"></span>'}};__name(_Openstreetmap,"Openstreetmap");let Openstreetmap=_Openstreetmap;const _FetchPlaceFromLatLng=class _FetchPlaceFromLatLng{constructor(modularityFrontendFormData2){this.modularityFrontendFormData=modularityFrontendFormData2}async fetch(lat,lng){const url=`${this.modularityFrontendFormData.placeSearchApiUrl}?lat=${lat}&lng=${lng}&reverse=true`,response=await fetch(url);if(!response.ok)throw new Error("Network response was not ok");return await response.json()}};__name(_FetchPlaceFromLatLng,"FetchPlaceFromLatLng");let FetchPlaceFromLatLng=_FetchPlaceFromLatLng;const _CreateFallbackPlaceObject=class _CreateFallbackPlaceObject{create(latLng){return{"@type":"Place",latitude:latLng.lat,longitude:latLng.lng,address:{"@type":"PostalAddress",streetAddress:`${latLng.lat}, ${latLng.lng}`,name:`${latLng.lat}, ${latLng.lng}`,addressCountry:"",addressLocality:"",addressRegion:"",postalCode:""}}}};__name(_CreateFallbackPlaceObject,"CreateFallbackPlaceObject");let CreateFallbackPlaceObject=_CreateFallbackPlaceObject;const _OpenstreetmapFactory=class _OpenstreetmapFactory{static createOpenstreetmap(openstreetmapContainer,modularityFrontendFormData2,modularityFrontendFormLang2){if(!modularityFrontendFormData2.placeSearchApiUrl)return console.error("OpenstreetmapFactory: Missing place search API URL"),null;const map2=openstreetmapContainer.querySelector("[data-js-openstreetmap]");if(!map2)return console.error("OpenstreetmapFactory: Missing map element."),null;const id=map2.id,zoom=map2.dataset.jsZoom??"14",lat=map2.dataset.jsLat,lng=map2.dataset.jsLng;return id&&zoom&&lat&&lng?new Openstreetmap(new FetchPlaceFromLatLng(modularityFrontendFormData2),new CreateFallbackPlaceObject,modularityFrontendFormData2,modularityFrontendFormLang2,openstreetmapContainer,id,parseFloat(lat),parseFloat(lng),parseInt(zoom)):(console.error("OpenstreetmapFactory: Missing required data attributes."),null)}};__name(_OpenstreetmapFactory,"OpenstreetmapFactory");let OpenstreetmapFactory=_OpenstreetmapFactory;const _MapValidator=class _MapValidator{constructor(modularityFrontendFormLang2){this.modularityFrontendFormLang=modularityFrontendFormLang2}map;init(parent){this.map=parent}isInvalid(){return this.map.isRequired()&&!this.map.hasValue()?this:!1}getFailedValidationMessage(){return this.modularityFrontendFormLang.errorMap??"Please choose a place on the map."}};__name(_MapValidator,"MapValidator");let MapValidator=_MapValidator;const _GoogleMapFactory=class _GoogleMapFactory{static create(field,name,unstructuredConditions,modularityFrontendFormData2,modularityFrontendFormLang2,notices,stepId){const openstreetmapInstance=OpenstreetmapFactory.createOpenstreetmap(field,modularityFrontendFormData2,modularityFrontendFormLang2),hiddenField=field.querySelector("[data-js-google-map-hidden-field]");return openstreetmapInstance?hiddenField?new GoogleMap(field,hiddenField,openstreetmapInstance,name,new GoogleMapConditionValidator,new GoogleMapConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new MapValidator(modularityFrontendFormLang2)]),new GoogleMapValueLoader):(console.error("Failed to find hidden input field needed for Google map field."),NullFieldFactory.create(field,"googleMap",name,unstructuredConditions,notices,stepId)):(console.error("Failed to create map instance"),NullFieldFactory.create(field,"googleMap",name,unstructuredConditions,notices,stepId))}};__name(_GoogleMapFactory,"GoogleMapFactory");let GoogleMapFactory=_GoogleMapFactory;const _MessageConditionsHandler=class _MessageConditionsHandler{constructor(unstructuredConditions){this.unstructuredConditions=unstructuredConditions}parent=null;conditions=[];isDisabled=!1;init(parent,conditionsBuilder){this.parent=parent,this.conditions=conditionsBuilder.build(this.unstructuredConditions)}updateDisabled(disabled){this.parent&&this.isDisabled!==disabled&&(this.isDisabled=disabled,this.parent.getFieldContainer().classList.toggle("u-display--none",disabled))}validate(){let isValid=!1;for(const condition of this.getConditions())if(condition.validate()){isValid=!0;break}this.updateDisabled(!isValid)}getIsDisabled(){return this.isDisabled}getConditions(){return this.conditions}addValueChangeListener(field){}checkConditions(){}};__name(_MessageConditionsHandler,"MessageConditionsHandler");let MessageConditionsHandler=_MessageConditionsHandler;const _MessageValueLoader=class _MessageValueLoader{load(value){}};__name(_MessageValueLoader,"MessageValueLoader");let MessageValueLoader=_MessageValueLoader;const _Message=class _Message{constructor(field,name,conditionValidator,conditionsHandler,validator,loader=new MessageValueLoader){this.field=field,this.name=name,this.conditionValidator=conditionValidator,this.conditionsHandler=conditionsHandler,this.validator=validator,this.loader=loader}init(conditionBuilder){this.conditionsHandler.init(this,conditionBuilder),this.conditionValidator.init(this),this.validator.init(this)}getName(){return this.name}getConditionsHandler(){return this.conditionsHandler}getConditionValidator(){return this.conditionValidator}getValidator(){return this.validator}hasValue(){return!0}isRequired(){return!1}getValueLoader(){return this.loader}getFieldContainer(){return this.field}};__name(_Message,"Message");let Message=_Message;const _MessageFactory=class _MessageFactory{static create(field,name,unstructuredConditions,notices,stepId){return new Message(field,name,new NullFieldConditionValidator,new MessageConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[]))}};__name(_MessageFactory,"MessageFactory");let MessageFactory=_MessageFactory;const _BasicConditionsHandler=class _BasicConditionsHandler{constructor(unstructuredConditions){this.unstructuredConditions=unstructuredConditions}fieldsObject={};parent=null;conditions=[];isDisabled=!1;init(parent,conditionsBuilder){this.parent=parent,this.conditions=conditionsBuilder.build(this.unstructuredConditions)}updateDisabled(disabled){this.parent&&this.isDisabled!==disabled&&(this.isDisabled=disabled,this.parent.getFieldContainer().classList.toggle("u-display--none",disabled),this.parent.getField().disabled=disabled,this.checkConditions())}validate(){let isValid=!1;for(const condition of this.getConditions())if(condition.validate()){isValid=!0;break}this.updateDisabled(!isValid)}getIsDisabled(){return this.isDisabled}getConditions(){return this.conditions}addValueChangeListener(field){this.fieldsObject[field.getName()]=field}checkConditions(){for(const fieldName in this.fieldsObject)this.fieldsObject[fieldName].getConditionsHandler().validate()}};__name(_BasicConditionsHandler,"BasicConditionsHandler");let BasicConditionsHandler=_BasicConditionsHandler;const _HtmlValidator=class _HtmlValidator{basic;init(basic){this.basic=basic}isInvalid(){return this.basic.getField().checkValidity()?!1:this}getFailedValidationMessage(){return this.basic.getField().validationMessage}};__name(_HtmlValidator,"HtmlValidator");let HtmlValidator=_HtmlValidator;const _SelectConditionValidator=class _SelectConditionValidator{parent=null;init(parent){this.parent=parent}validate(condition){const selected=this.parent?.getSelectedOptions()||[];switch(condition.operator){case"==":case"=":case"===":case"==contains":return selected.includes(condition.value);case"!=":case"!==":case"!=contains":return!selected.includes(condition.value);case"==empty":return selected.length===0;case"!=empty":return selected.length>0;default:return console.error("Invalid operator:",condition.operator),!1}}};__name(_SelectConditionValidator,"SelectConditionValidator");let SelectConditionValidator=_SelectConditionValidator;const _SelectValueLoader=class _SelectValueLoader{parent;init(parent){this.parent=parent}load(value){if(!value||value===null||value===void 0)return;const values=this.convertValueToArrayWithStrings(value);this.parent.getOptions().forEach(option=>{values.includes(option.value)?option.selected=!0:option.selected=!1}),this.parent.getField().dispatchEvent(new Event("change"))}convertValueToArrayWithStrings(value){let values=[];return Array.isArray(value)?values=value.map(val=>String(val)):values=[String(value)],values}};__name(_SelectValueLoader,"SelectValueLoader");let SelectValueLoader=_SelectValueLoader;const _Select=class _Select{constructor(field,select,options,name,conditionValidator,conditionsHandler,validator,loader=new SelectValueLoader){this.field=field,this.select=select,this.options=options,this.name=name,this.conditionValidator=conditionValidator,this.conditionsHandler=conditionsHandler,this.validator=validator,this.loader=loader}required=!1;init(conditionBuilder){this.required=this.getField().required,this.conditionsHandler.init(this,conditionBuilder),this.conditionValidator.init(this),this.validator.init(this),this.loader.init(this),this.listenForChanges()}getName(){return this.name}getConditionsHandler(){return this.conditionsHandler}getConditionValidator(){return this.conditionValidator}getValidator(){return this.validator}getFieldContainer(){return this.field}getField(){return this.select}getOptions(){return this.options}hasValue(){return this.getSelectedOptions().length>0}isRequired(){return this.required}getSelectedOptions(){return[...this.getOptions()].filter(option=>option.selected).map(option=>option.value)}getValueLoader(){return this.loader}listenForChanges(){this.getField().addEventListener("change",()=>{this.getValidator().validate(),this.conditionsHandler.checkConditions()}),this.getField().addEventListener("blur",()=>{this.getValidator().validate()})}};__name(_Select,"Select");let Select=_Select;const _SelectFactory=class _SelectFactory{static create(field,name,unstructuredConditions,notices,stepId){const select=field.querySelector("select"),options=select?.querySelectorAll("option");return!options||options.length===0?(console.error("Select field is missing select element or options"),NullFieldFactory.create(field,"select",name,unstructuredConditions,notices,stepId)):new Select(field,select,options,name,new SelectConditionValidator,new BasicConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator]))}};__name(_SelectFactory,"SelectFactory");let SelectFactory=_SelectFactory;const _CheckboxValueLoader=class _CheckboxValueLoader{parent;init(parent){this.parent=parent}load(value){if(!value||value===null||value===void 0)return;const values=this.convertValueToArrayWithStrings(value);this.parent.getChoices().forEach(choice=>{values.includes(choice.value)?choice.checked=!0:choice.checked=!1})}convertValueToArrayWithStrings(value){let values=[];return Array.isArray(value)?values=value.map(val=>String(val)):values=[String(value)],values}};__name(_CheckboxValueLoader,"CheckboxValueLoader");let CheckboxValueLoader=_CheckboxValueLoader;const _Checkbox=class _Checkbox{constructor(field,choices,name,conditionValidator,conditionsHandler,validator,loader=new CheckboxValueLoader){this.field=field,this.choices=choices,this.name=name,this.conditionValidator=conditionValidator,this.conditionsHandler=conditionsHandler,this.validator=validator,this.loader=loader}required=!1;init(conditionBuilder){this.required=this.getFieldContainer().hasAttribute("data-js-required"),this.conditionsHandler.init(this,conditionBuilder),this.conditionValidator.init(this),this.validator.init(this),this.loader.init(this),this.listenForChanges()}getName(){return this.name}getValidator(){return this.validator}getConditionsHandler(){return this.conditionsHandler}getConditionValidator(){return this.conditionValidator}getChoices(){return this.choices}isRequired(){return this.required}hasValue(){return this.getSelectedChoices().length>0}getValueLoader(){return this.loader}getSelectedChoices(){return[...this.getChoices()].filter(choice=>choice.checked).map(choice=>choice.value)}getFieldContainer(){return this.field}listenForChanges(){this.choices.forEach(choice=>{choice.addEventListener("change",()=>{this.conditionsHandler.checkConditions(),this.validator.validate()})})}};__name(_Checkbox,"Checkbox");let Checkbox=_Checkbox;const _CheckboxConditionsHandler=class _CheckboxConditionsHandler{constructor(unstructuredConditions){this.unstructuredConditions=unstructuredConditions}fieldsObject={};parent=null;conditions=[];isDisabled=!1;init(parent,conditionsBuilder){this.parent=parent,this.conditions=conditionsBuilder.build(this.unstructuredConditions)}updateDisabled(disabled){this.isDisabled!==disabled&&(this.isDisabled=disabled,this.parent?.getChoices().forEach((checkbox,index)=>{index===0&&this.parent?.getFieldContainer().classList.toggle("u-display--none",disabled),checkbox.disabled=disabled}),this.checkConditions())}validate(){let isValid=!1;for(const condition of this.getConditions())if(condition.validate()){isValid=!0;break}this.updateDisabled(!isValid)}getIsDisabled(){return this.isDisabled}getConditions(){return this.conditions}addValueChangeListener(field){this.fieldsObject[field.getName()]=field}checkConditions(){for(const fieldName in this.fieldsObject)this.fieldsObject[fieldName].getConditionsHandler().validate()}};__name(_CheckboxConditionsHandler,"CheckboxConditionsHandler");let CheckboxConditionsHandler=_CheckboxConditionsHandler;const _CheckboxConditionValidator=class _CheckboxConditionValidator{parent=null;init(parent){this.parent=parent}validate(condition){const selected=this.parent?.getSelectedChoices()??[];switch(condition.operator){case"==":case"=":case"===":case"==contains":return selected.includes(condition.value);case"!=":case"!==":case"!=contains":return!selected.includes(condition.value);case"==empty":return selected.length===0;case"!=empty":return selected.length>0;case">":return selected.some(selectedValue=>Number(selectedValue)>Number(condition.value));case"<":return selected.some(selectedValue=>Number(selectedValue)<Number(condition.value));default:return console.error("Invalid operator:",condition.operator),!1}}};__name(_CheckboxConditionValidator,"CheckboxConditionValidator");let CheckboxConditionValidator=_CheckboxConditionValidator;const _Required=class _Required{constructor(modularityFrontendFormLang2){this.modularityFrontendFormLang=modularityFrontendFormLang2}checkbox;init(checkbox){this.checkbox=checkbox}isInvalid(){return this.checkbox.isRequired()&&!this.checkbox.hasValue()?this:!1}getFailedValidationMessage(){return this.modularityFrontendFormLang.atLeastOneValueIsRequired??"At least one value is required."}};__name(_Required,"Required");let Required=_Required;const _CheckboxFactory=class _CheckboxFactory{static create(field,name,unstructuredConditions,notices,stepId,modularityFrontendFormLang2){const choices=field.querySelectorAll('input[type="checkbox"]');return choices.length===0?(console.error("Checkbox field is missing input elements"),NullFieldFactory.create(field,"checkbox",name,unstructuredConditions,notices,stepId)):new Checkbox(field,choices,name,new CheckboxConditionValidator,new CheckboxConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new Required(modularityFrontendFormLang2)]))}};__name(_CheckboxFactory,"CheckboxFactory");let CheckboxFactory=_CheckboxFactory;const _BasicValueLoader=class _BasicValueLoader{parent;init(parent){this.parent=parent}load(value){this.parent.getField().value=value}};__name(_BasicValueLoader,"BasicValueLoader");let BasicValueLoader=_BasicValueLoader;const _Basic=class _Basic{constructor(field,input,name,conditionValidator,conditionsHandler,validator,loader=new BasicValueLoader){this.field=field,this.input=input,this.name=name,this.conditionValidator=conditionValidator,this.conditionsHandler=conditionsHandler,this.validator=validator,this.loader=loader}required=!1;hasBeenFilled=!1;init(conditionBuilder){this.required=this.getField().hasAttribute("required"),this.conditionsHandler.init(this,conditionBuilder),this.conditionValidator.init(this),this.validator.init(this),this.loader.init(this),this.listenForChanges()}getName(){return this.name}getConditionsHandler(){return this.conditionsHandler}getConditionValidator(){return this.conditionValidator}getValidator(){return this.validator}getFieldContainer(){return this.field}hasValue(){return this.getField().value.length>0}isRequired(){return this.required}getField(){return this.input}getValueLoader(){return this.loader}listenForChanges(){this.getField().addEventListener("input",()=>{this.getConditionsHandler().checkConditions(),this.hasBeenFilled&&this.getValidator().validate()}),this.getField().addEventListener("blur",()=>{this.hasBeenFilled=!0,this.getValidator().validate()})}};__name(_Basic,"Basic");let Basic=_Basic;const _FileConditionsHandler=class _FileConditionsHandler{constructor(unstructuredConditions){this.unstructuredConditions=unstructuredConditions}fieldsObject={};parent=null;conditions=[];isDisabled=!1;init(parent,conditionsBuilder){this.parent=parent,this.conditions=conditionsBuilder.build(this.unstructuredConditions)}updateDisabled(disable){this.parent&&this.isDisabled!==disable&&(this.isDisabled=disable,this.parent.getFieldContainer().classList.toggle("u-display--none",disable),this.parent.getField().disabled=disable,this.checkConditions())}validate(){let isValid=!1;for(const condition of this.getConditions())if(condition.validate()){isValid=!0;break}this.updateDisabled(!isValid)}getIsDisabled(){return this.isDisabled}getConditions(){return this.conditions}addValueChangeListener(field){this.fieldsObject[field.getName()]=field}checkConditions(){for(const fieldName in this.fieldsObject)this.fieldsObject[fieldName].getConditionsHandler().validate()}};__name(_FileConditionsHandler,"FileConditionsHandler");let FileConditionsHandler=_FileConditionsHandler;const _FileConditionValidator=class _FileConditionValidator{parent=null;init(parent){this.parent=parent}validate(condition){if(!this.parent?.getField().files)return console.error("No files found in input element"),!1;const value=this.parent.getField().files.length>0;switch(condition.operator){case"==":case"=":case"===":case"!=empty":case"==contains":return value===!0;case"!=":case"!==":case"==empty":case"!=contains":return value===!1;default:return console.error("Invalid operator:",condition.operator),!1}}};__name(_FileConditionValidator,"FileConditionValidator");let FileConditionValidator=_FileConditionValidator;function createFileInputFakeFile(file,input){window.addFakeFileToInput({name:file.name,type:file.type||"image/jpeg",id:file.id,url:file.url,size:file.size},input)}__name(createFileInputFakeFile,"createFileInputFakeFile");const _FileValueLoader=class _FileValueLoader{parent;init(parent){this.parent=parent}load(value){!value||Array.isArray(value)===!1||value.length===0||value.forEach(item=>{!item.id||!item.url||createFileInputFakeFile(item,this.parent.getField())})}};__name(_FileValueLoader,"FileValueLoader");let FileValueLoader=_FileValueLoader;const _FileFactory=class _FileFactory{static create(field,name,unstructuredConditions,notices,stepId){const input=field.querySelector('input[type="file"]');return input?new Basic(field,input,name,new FileConditionValidator,new FileConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator]),new FileValueLoader):(console.error('Input field is not an input element with type "file"'),NullFieldFactory.create(field,"file",name,unstructuredConditions,notices,stepId))}};__name(_FileFactory,"FileFactory");let FileFactory=_FileFactory;const _BasicConditionValidator=class _BasicConditionValidator{parent=null;init(parent){this.parent=parent}validate(condition){const value=this.parent?.getField().value??"";switch(condition.operator){case"==":case"=":case"===":return value===condition.value;case"!=":case"!==":return value!==condition.value;case"==empty":return value.length===0;case"!=empty":return value.length>0;case"==contains":return value.includes(condition.value);case"!=contains":return!value.includes(condition.value);case">":return Number(value)>Number(condition.value);case"<":return Number(value)<Number(condition.value);default:return console.error("Invalid operator:",condition.operator),!1}}};__name(_BasicConditionValidator,"BasicConditionValidator");let BasicConditionValidator=_BasicConditionValidator;const _TextFactory=class _TextFactory{static create(field,name,unstructuredConditions,notices,stepId){const input=field.querySelector('input[type="text"]');return input?new Basic(field,input,name,new BasicConditionValidator,new BasicConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator])):(console.error("Text field is missing input element."),NullFieldFactory.create(field,"text",name,unstructuredConditions,notices,stepId))}};__name(_TextFactory,"TextFactory");let TextFactory=_TextFactory;const _EmailFactory=class _EmailFactory{static create(field,name,unstructuredConditions,notices,stepId){const input=field.querySelector('input[type="email"]');return input?new Basic(field,input,name,new BasicConditionValidator,new BasicConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator])):(console.error("Email field is missing input element."),NullFieldFactory.create(field,"email",name,unstructuredConditions,notices,stepId))}};__name(_EmailFactory,"EmailFactory");let EmailFactory=_EmailFactory;const _UrlFactory=class _UrlFactory{static create(field,name,unstructuredConditions,notices,stepId){const input=field.querySelector('input[type="url"]');return input?new Basic(field,input,name,new BasicConditionValidator,new BasicConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator])):(console.error("Url field is missing input element."),NullFieldFactory.create(field,"url",name,unstructuredConditions,notices,stepId))}};__name(_UrlFactory,"UrlFactory");let UrlFactory=_UrlFactory;const _DateFactory=class _DateFactory{static create(field,name,unstructuredConditions,notices,stepId){const input=field.querySelector('input[type="date"]');return input?new Basic(field,input,name,new BasicConditionValidator,new BasicConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator])):(console.error("Date field is missing input element."),NullFieldFactory.create(field,"date",name,unstructuredConditions,notices,stepId))}};__name(_DateFactory,"DateFactory");let DateFactory=_DateFactory;const _TimeFactory=class _TimeFactory{static create(field,name,unstructuredConditions,notices,stepId){const input=field.querySelector('input[type="time"]');return input?new Basic(field,input,name,new BasicConditionValidator,new BasicConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator])):(console.error("Time field is missing input element."),NullFieldFactory.create(field,"time",name,unstructuredConditions,notices,stepId))}};__name(_TimeFactory,"TimeFactory");let TimeFactory=_TimeFactory;const _NumberFactory=class _NumberFactory{static create(field,name,unstructuredConditions,notices,stepId){const input=field.querySelector('input[type="number"]');return input?new Basic(field,input,name,new BasicConditionValidator,new BasicConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator])):(console.error("Number field is missing input element."),NullFieldFactory.create(field,"number",name,unstructuredConditions,notices,stepId))}};__name(_NumberFactory,"NumberFactory");let NumberFactory=_NumberFactory;const _ImageValueLoader=class _ImageValueLoader{parent;init(parent){this.parent=parent}load(value){!value||Array.isArray(value)===!1||value.length===0||value.forEach(item=>{!item.id||!item.url||createFileInputFakeFile(item,this.parent.getField())})}};__name(_ImageValueLoader,"ImageValueLoader");let ImageValueLoader=_ImageValueLoader;const _ImageFactory=class _ImageFactory{static create(field,name,unstructuredConditions,notices,stepId){const input=field.querySelector('input[type="file"]');return input?new Basic(field,input,name,new FileConditionValidator,new FileConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator]),new ImageValueLoader):(console.error('Image field is not an input element with type "file"'),NullFieldFactory.create(field,"input",name,unstructuredConditions,notices,stepId))}};__name(_ImageFactory,"ImageFactory");let ImageFactory=_ImageFactory;const _TrueFalseFactory=class _TrueFalseFactory{static create(field,name,unstructuredConditions,notices,stepId){const choices=field.querySelectorAll('input[type="radio"]');return choices.length===0?(console.error("Radio field is missing input elements"),NullFieldFactory.create(field,"radio",name,unstructuredConditions,notices,stepId)):new Radio(field,choices,name,new RadioConditionValidator,new RadioConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[]))}};__name(_TrueFalseFactory,"TrueFalseFactory");let TrueFalseFactory=_TrueFalseFactory;const _TextAreaValueLoader=class _TextAreaValueLoader{parent;init(parent){this.parent=parent}load(value){this.parent.getField().value=value??""}};__name(_TextAreaValueLoader,"TextAreaValueLoader");let TextAreaValueLoader=_TextAreaValueLoader;const _TextArea=class _TextArea{constructor(field,input,name,conditionValidator,conditionsHandler,validator,loader=new TextAreaValueLoader){this.field=field,this.input=input,this.name=name,this.conditionValidator=conditionValidator,this.conditionsHandler=conditionsHandler,this.validator=validator,this.loader=loader}required=!1;hasBeenFilled=!1;init(conditionBuilder){this.required=this.getField().hasAttribute("required"),this.conditionsHandler.init(this,conditionBuilder),this.conditionValidator.init(this),this.validator.init(this),this.loader.init(this),this.listenForChanges()}getName(){return this.name}getConditionsHandler(){return this.conditionsHandler}getConditionValidator(){return this.conditionValidator}getValidator(){return this.validator}getFieldContainer(){return this.field}hasValue(){return this.getField().value.length>0}isRequired(){return this.required}getField(){return this.input}getValueLoader(){return this.loader}listenForChanges(){this.getField().addEventListener("input",()=>{this.getConditionsHandler().checkConditions(),this.hasBeenFilled&&this.getValidator().validate()}),this.getField().addEventListener("blur",()=>{this.hasBeenFilled=!0,this.getValidator().validate()})}};__name(_TextArea,"TextArea");let TextArea=_TextArea;const _TextAreaFactory=class _TextAreaFactory{static create(field,name,unstructuredConditions,notices,stepId){const textarea=field.querySelector("textarea");return textarea?new TextArea(field,textarea,name,new BasicConditionValidator,new BasicConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator])):(console.error("TextArea field is missing textarea element"),NullFieldFactory.create(field,"textarea",name,unstructuredConditions,notices,stepId))}};__name(_TextAreaFactory,"TextAreaFactory");let TextAreaFactory=_TextAreaFactory;const _GalleryValueLoader=class _GalleryValueLoader{parent;init(parent){this.parent=parent}load(value){!value||Array.isArray(value)===!1||value.length===0||value.forEach(item=>{!item.id||!item.url||createFileInputFakeFile(item,this.parent.getField())})}};__name(_GalleryValueLoader,"GalleryValueLoader");let GalleryValueLoader=_GalleryValueLoader;const _GalleryFactory=class _GalleryFactory{static create(field,name,unstructuredConditions,notices,stepId){const input=field.querySelector('input[type="file"]');return input?new Basic(field,input,name,new FileConditionValidator,new FileConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new HtmlValidator]),new GalleryValueLoader):(console.error('Image field is not an input element with type "file"'),NullFieldFactory.create(field,"input",name,unstructuredConditions,notices,stepId))}};__name(_GalleryFactory,"GalleryFactory");let GalleryFactory=_GalleryFactory;const defaultClasses={actionbar:"mod-frontend-form__wysiwyg-actionbar",button:"mod-frontend-form__wysiwyg-button",content:"mod-frontend-form__wysiwyg-content",selected:"mod-frontend-form__wysiwyg-button--selected"},_EditorConfig=class _EditorConfig{constructor(actionsInstance,settings){this.actionsInstance=actionsInstance,this.settings=settings,this.classes=this.setClasses(),this.actions=this.setActions()}classes;actions;getElement(){return this.settings.element}getClasses(){return this.classes}getEditorActions(){return this.actions}setActions(){let actions={};const defaultActions=this.actionsInstance.getDefaultActions();for(const key in this.settings.actions)if(typeof this.settings.actions[key]=="string"){const actionKey=this.settings.actions[key];actions[key]=defaultActions[actionKey]}else actions[key]=this.settings.actions[key];return actions}setClasses(){return{actionbar:this.settings.classes?.actionbar||defaultClasses.actionbar,button:this.settings.classes?.button||defaultClasses.button,content:this.settings.classes?.content||defaultClasses.content,selected:this.settings.classes?.selected||defaultClasses.selected}}};__name(_EditorConfig,"EditorConfig");let EditorConfig=_EditorConfig;const _WysiwygValueLoader=class _WysiwygValueLoader{parent;init(parent){this.parent=parent}load(value){this.parent.getEditor().getContentArea().getElement().innerHTML=value??""}};__name(_WysiwygValueLoader,"WysiwygValueLoader");let WysiwygValueLoader=_WysiwygValueLoader;const _Wysiwyg=class _Wysiwyg{constructor(field,hiddenField,name,editor,conditionValidator,conditionsHandler,validator,loader=new WysiwygValueLoader){this.field=field,this.hiddenField=hiddenField,this.name=name,this.editor=editor,this.conditionValidator=conditionValidator,this.conditionsHandler=conditionsHandler,this.validator=validator,this.loader=loader}required=!1;init(conditionBuilder){this.required=this.getFieldContainer().hasAttribute("data-js-required"),this.conditionsHandler.init(this,conditionBuilder),this.conditionValidator.init(this),this.validator.init(this),this.loader.init(this),this.addChangeListener()}getName(){return this.name}getFieldContainer(){return this.field}getConditionsHandler(){return this.conditionsHandler}getConditionValidator(){return this.conditionValidator}getEditor(){return this.editor}getValidator(){return this.validator}isRequired(){return this.required}hasValue(){return this.editor.hasContent()}getHiddenField(){return this.hiddenField}getValueLoader(){return this.loader}addChangeListener(){this.editor.addChangeListeners(html=>{this.hiddenField.value=html,this.conditionsHandler.checkConditions(),this.validator.validate()})}};__name(_Wysiwyg,"Wysiwyg");let Wysiwyg=_Wysiwyg;const _ContentArea=class _ContentArea{constructor(config,editor,actions){this.config=config,this.editor=editor,this.actions=actions}contentArea;defaultParagraphSeparator="div";defaultParagraphSeparatorString="defaultParagraphSeparator";shouldCleanFontTags=!1;getElement(){return this.contentArea}appendContentArea(){const div=document.createElement("div");return div.className=this.config.getClasses().content,div.contentEditable="true",this.config.getElement().appendChild(div),this.contentArea=div,div}setupChangeListener(){this.contentArea.addEventListener("input",this.handleInput.bind(this)),this.actions.exec(this.defaultParagraphSeparatorString,this.defaultParagraphSeparator)}handleInput(event){const el=event.target;this.shouldCleanFontTags&&(this.cleanFontTags(el),this.restoreCaretToEnd(el),this.shouldCleanFontTags=!1),this.editor.runChangeListeners(el.innerHTML)}cleanFontTags(el){el.innerHTML=el.innerHTML.replace(/<\/?font[^>]*>/gi,"")}restoreCaretToEnd(el){const range=document.createRange(),selection=window.getSelection();range.selectNodeContents(el),range.collapse(!1),selection?.removeAllRanges(),selection?.addRange(range)}};__name(_ContentArea,"ContentArea");let ContentArea=_ContentArea;const _Actionbar=class _Actionbar{constructor(config,contentAreaInstance){this.config=config,this.contentAreaInstance=contentAreaInstance}actionbar;buttonList={};appendActionbar(){const div=document.createElement("div");return div.className=this.config.getClasses().actionbar,this.config.getElement().appendChild(div),this.actionbar=div,div}getElement(){return this.actionbar}getActionButtons(){return this.buttonList}addActionButtons(actions){for(const key in actions)this.addActionButton(actions[key],key)}addActionButton(actionButton,name){const button=this.createActionButton(actionButton);return button.addEventListener("click",()=>{this.contentAreaInstance.getElement().focus(),actionButton.result();for(const other of["olist","ulist"])other!==name&&this.buttonList[other]&&this.buttonList[other].classList.remove(this.config.getClasses().selected)}),actionButton.state&&this.bindActionState(button,actionButton.state),this.buttonList[name]=button,this.actionbar.appendChild(button),button}createActionButton(actionButton){const button=document.createElement("button");return button.className=this.config.getClasses().button,button.innerHTML=actionButton.icon,button.title=actionButton.title,button.setAttribute("type","button"),button.setAttribute("data-tooltip",actionButton.title),button}bindActionState(button,state){const update=__name(()=>button.classList.toggle(this.config.getClasses().selected,state()??void 0),"update");this.contentAreaInstance.getElement().addEventListener("keyup",update),this.contentAreaInstance.getElement().addEventListener("mouseup",update),button.addEventListener("click",update),update()}};__name(_Actionbar,"Actionbar");let Actionbar=_Actionbar;const _Editor=class _Editor{constructor(config,actions){this.config=config,this.actions=actions}contentArea;actionbar;listeners=[];init(){return this.contentArea=new ContentArea(this.config,this,this.actions),this.actionbar=new Actionbar(this.config,this.contentArea),this.actionbar.appendActionbar(),this.contentArea.appendContentArea(),this.contentArea.setupChangeListener(),this.actionbar.addActionButtons(this.config.getEditorActions()),this}addChangeListeners(listener){this.listeners.push(listener)}runChangeListeners(html){this.listeners.forEach(listener=>listener(html))}getContentArea(){return this.contentArea}getActionbar(){return this.actionbar}getContent(){return this.contentArea.getElement().innerHTML}hasContent(){const content=this.contentArea.getElement().innerHTML.trim();return!(!content||content==="<br>"||content==="<div><br></div>"||content==="<p><br></p>")}};__name(_Editor,"Editor");let Editor=_Editor;const _WysiwygConditionValidator=class _WysiwygConditionValidator{parent=null;init(parent){this.parent=parent}validate(condition){const value=!!this.parent?.getEditor().hasContent();switch(condition.operator){case"==":case"=":case"===":case"!=empty":case"==contains":return value===!0;case"!=":case"!==":case"==empty":case"!=contains":return value===!1;default:return console.error("Invalid operator:",condition.operator),!1}}};__name(_WysiwygConditionValidator,"WysiwygConditionValidator");let WysiwygConditionValidator=_WysiwygConditionValidator;const _WysiwygConditionsHandler=class _WysiwygConditionsHandler{constructor(unstructuredConditions){this.unstructuredConditions=unstructuredConditions}fieldsObject={};parent=null;conditions=[];isDisabled=!1;init(parent,conditionsBuilder){this.parent=parent,this.conditions=conditionsBuilder.build(this.unstructuredConditions)}updateDisabled(disabled){this.parent&&this.isDisabled!==disabled&&(this.isDisabled=disabled,this.parent.getFieldContainer().classList.toggle("u-display--none",disabled),this.parent.getHiddenField().disabled=disabled,this.checkConditions())}validate(){let isValid=!1;for(const condition of this.getConditions())if(condition.validate()){isValid=!0;break}this.updateDisabled(!isValid)}getIsDisabled(){return this.isDisabled}getConditions(){return this.conditions}addValueChangeListener(field){this.fieldsObject[field.getName()]=field}checkConditions(){for(const fieldName in this.fieldsObject)this.fieldsObject[fieldName].getConditionsHandler().validate()}};__name(_WysiwygConditionsHandler,"WysiwygConditionsHandler");let WysiwygConditionsHandler=_WysiwygConditionsHandler;const _Actions=class _Actions{constructor(modularityFrontend){this.modularityFrontend=modularityFrontend,this.defaultActions=this.setDefaultActions()}isExecuting=!1;defaultActions={};getDefaultParagraphSeparatorString(){return"defaultParagraphSeparator"}getFormatBlock(){return"formatBlock"}getActiveActions(){const active=[],actions=this.getDefaultActions();for(const key in actions)actions[key].state&&actions[key].state()&&active.push(key);return active}createIcon(name){return`<span class="c-icon c-icon--size-md material-symbols material-symbols-rounded material-symbols-sharp material-symbols-outlined" data-material-symbol="${name}"></span>`}queryCommandState(command){return document.queryCommandState(command)}queryCommandValue(command){return document.queryCommandValue(command)}exec(command,value){if(!this.isExecuting)try{this.isExecuting=!0,document.execCommand(command,!1,value??void 0)}finally{this.isExecuting=!1}}getDefaultActions(){return this.defaultActions}setDefaultActions(){return{bold:{icon:this.createIcon("format_bold"),title:this.modularityFrontend.bold??"Bold",state:__name(()=>this.queryCommandState("bold"),"state"),result:__name(()=>this.exec("bold"),"result")},italic:{icon:this.createIcon("format_italic"),title:this.modularityFrontend.italic??"Italic",state:__name(()=>this.queryCommandState("italic"),"state"),result:__name(()=>this.exec("italic"),"result")},underline:{icon:this.createIcon("format_underlined"),title:this.modularityFrontend.underline??"Underline",state:__name(()=>this.queryCommandState("underline"),"state"),result:__name(()=>this.exec("underline"),"result")},strikethrough:{icon:this.createIcon("format_strikethrough"),title:this.modularityFrontend.strikeThrough??"Strike-through",state:__name(()=>this.queryCommandState("strikeThrough"),"state"),result:__name(()=>this.exec("strikeThrough"),"result")},heading2:{icon:this.createIcon("format_h1"),title:this.modularityFrontend.heading??"Heading 2",state:__name(()=>this.queryCommandValue(this.getFormatBlock())?.toLowerCase()==="h2","state"),result:__name(()=>{const current=this.queryCommandValue(this.getFormatBlock())?.toLowerCase();this.exec(this.getFormatBlock(),current==="h2"?"<p>":"<h2>")},"result")},heading3:{icon:this.createIcon("format_h2"),title:this.modularityFrontend.subheading??"Heading 3",state:__name(()=>this.queryCommandValue(this.getFormatBlock())?.toLowerCase()==="h3","state"),result:__name(()=>{const current=this.queryCommandValue(this.getFormatBlock())?.toLowerCase();this.exec(this.getFormatBlock(),current==="h3"?"<p>":"<h3>")},"result")},quote:{icon:this.createIcon("format_quote"),title:this.modularityFrontend.blockquote??"Quote",state:__name(()=>this.queryCommandValue(this.getFormatBlock())?.toLowerCase()==="blockquote","state"),result:__name(()=>this.exec(this.getFormatBlock(),"<blockquote>"),"result")},olist:{icon:this.createIcon("format_list_numbered"),title:this.modularityFrontend.olist??"Ordered List",state:__name(()=>this.queryCommandState("insertOrderedList"),"state"),result:__name(()=>this.exec("insertOrderedList"),"result")},ulist:{icon:this.createIcon("format_list_bulleted"),title:this.modularityFrontend.ulist??"Unordered List",state:__name(()=>this.queryCommandState("insertUnorderedList"),"state"),result:__name(()=>this.exec("insertUnorderedList"),"result")},link:{icon:this.createIcon("link"),title:this.modularityFrontend.link??"Link",result:__name(()=>{const url=window.prompt("Enter the link URL");url&&this.exec("createLink",url)},"result")}}}};__name(_Actions,"Actions");let Actions=_Actions;const _WysiwygValidator=class _WysiwygValidator{constructor(modularityFrontendFormLang2){this.modularityFrontendFormLang=modularityFrontendFormLang2}wysiwyg;init(parent){this.wysiwyg=parent}isInvalid(){return this.wysiwyg.isRequired()&&!this.wysiwyg.hasValue()?this:!1}getFailedValidationMessage(){return this.modularityFrontendFormLang.errorWysiwyg??"Please add some content"}};__name(_WysiwygValidator,"WysiwygValidator");let WysiwygValidator=_WysiwygValidator;const _WysiwygFactory=class _WysiwygFactory{static create(field,name,unstructuredConditions,modularityFrontendFormLang2,notices,stepId){const actions=new Actions(modularityFrontendFormLang2),editorConfig=new EditorConfig(actions,{element:field,actions:{bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",link:"link",quote:"quote",olist:"olist",ulist:"ulist",heading2:"heading2",heading3:"heading3"}}),editor=new Editor(editorConfig,actions).init(),hiddenField=field.querySelector("[data-js-wysiwyg-hidden-field]");return hiddenField?new Wysiwyg(field,hiddenField,name,editor,new WysiwygConditionValidator,new WysiwygConditionsHandler(unstructuredConditions),new FieldValidator(new FieldValidatorUIHandler(notices),[new WysiwygValidator(modularityFrontendFormLang2)])):(console.error("Failed to find hidden input field needed for Wysiwyg field."),NullFieldFactory.create(field,"wysiwyg",name,unstructuredConditions,notices,stepId))}};__name(_WysiwygFactory,"WysiwygFactory");let WysiwygFactory=_WysiwygFactory;const _FieldBuilder=class _FieldBuilder{constructor(fieldsInitiator,notices,modularityFrontendFormData2,modularityFrontendFormLang2){this.fieldsInitiator=fieldsInitiator,this.notices=notices,this.modularityFrontendFormData=modularityFrontendFormData2,this.modularityFrontendFormLang=modularityFrontendFormLang2}name="data-js-field-name";condition="data-js-conditional-logic";fieldsObject={};fieldsStepObject={};build(field,type,stepId){if(!this.validateRequiredAttributes(field))return console.error("Field name and/or conditional logic are required"),NullFieldFactory.create(field,type,this.getFieldName(field),"0",this.notices,stepId);let fieldInstance;switch(type){case"image":fieldInstance=ImageFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"gallery":fieldInstance=GalleryFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"file":fieldInstance=FileFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"checkbox":fieldInstance=CheckboxFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId,this.modularityFrontendFormLang);break;case"text":fieldInstance=TextFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"textarea":fieldInstance=TextAreaFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"email":fieldInstance=EmailFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"url":fieldInstance=UrlFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"date":fieldInstance=DateFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"time":fieldInstance=TimeFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"number":fieldInstance=NumberFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"select":fieldInstance=SelectFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"trueFalse":fieldInstance=TrueFalseFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"radio":fieldInstance=RadioFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.modularityFrontendFormLang,this.notices,stepId);break;case"message":fieldInstance=MessageFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"googleMap":fieldInstance=GoogleMapFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.modularityFrontendFormData,this.modularityFrontendFormLang,this.notices,stepId);break;case"repeater":fieldInstance=RepeaterFactory.create(this,this.fieldsInitiator,field,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break;case"wysiwyg":fieldInstance=WysiwygFactory.create(field,this.getFieldName(field),this.getFieldCondition(field),this.modularityFrontendFormLang,this.notices,stepId);break;default:fieldInstance=NullFieldFactory.create(field,type,this.getFieldName(field),this.getFieldCondition(field),this.notices,stepId);break}return this.fieldsObject[fieldInstance.getName()]=fieldInstance,this.fieldsStepObject[stepId]||(this.fieldsStepObject[stepId]={}),this.fieldsStepObject[stepId][fieldInstance.getName()]=fieldInstance,fieldInstance}removeField(name,stepId){delete this.fieldsObject[name],delete this.fieldsStepObject[stepId][name]}getFieldsObject(){return this.fieldsObject}getFieldsStepObject(){return this.fieldsStepObject}getFieldName(field){const name=field.getAttribute("data-js-field-name");return name||(console.error("Field is missing data-js-field-name attribute"),"unknown")}getFieldCondition(field){let condition=0;try{condition=JSON.parse(field.getAttribute("data-js-conditional-logic"))}catch{condition=0}return condition}validateRequiredAttributes(field){return[this.name,this.condition].every(attribute=>field.getAttribute(attribute)?!0:(console.error(`Field is missing required attribute: ${attribute}`),!1))}};__name(_FieldBuilder,"FieldBuilder");let FieldBuilder=_FieldBuilder;const _AndCondition=class _AndCondition{constructor(conditions){this.conditions=conditions}validate(){for(const condition of this.conditions)if(condition.class&&(condition.class.getConditionsHandler().getIsDisabled()||!condition.class.getConditionValidator().validate(condition)))return!1;return!0}getConditions(){return this.conditions}getConditionFieldNames(){return this.conditions.flatMap(condition=>condition.field?[condition.field]:[])}};__name(_AndCondition,"AndCondition");let AndCondition=_AndCondition;const _NullCondition=class _NullCondition{validate(){return!0}getConditions(){return[]}getConditionFieldNames(){return[]}};__name(_NullCondition,"NullCondition");let NullCondition=_NullCondition;const _OrCondition=class _OrCondition{constructor(condition){this.condition=condition}validate(){return this.condition.class?this.condition.class.getConditionsHandler().getIsDisabled()?!1:this.condition.class.getConditionValidator().validate(this.condition):!0}getConditions(){return[this.condition]}getConditionFieldNames(){return[this.condition.field]}};__name(_OrCondition,"OrCondition");let OrCondition=_OrCondition;const _ConditionBuilder=class _ConditionBuilder{constructor(fieldBuilder){this.fieldBuilder=fieldBuilder}build(conditions){if(!Array.isArray(conditions)||conditions.length===0)return[new NullCondition];let conditionsList=[];return conditions.forEach(conditionSet=>{if(!Array.isArray(conditionSet)||conditionSet.length===0){conditionsList.push(new NullCondition);return}if(conditionSet.length===1)this.checkConditionValidity(conditionSet[0])&&(conditionSet[0].class=this.fieldBuilder.getFieldsObject()[conditionSet[0].field],conditionsList.push(new OrCondition(conditionSet[0])));else{const validConditions=conditionSet.filter(condition=>this.checkConditionValidity(condition)).map(condition=>({...condition,class:this.fieldBuilder.getFieldsObject()[condition.field]}));validConditions.length>0&&conditionsList.push(new AndCondition(validConditions))}}),conditionsList.length>0?conditionsList:[new NullCondition]}checkConditionValidity(condition){return!(typeof condition!="object"||!("field"in condition)||!("operator"in condition)||!this.fieldBuilder.getFieldsObject()[condition.field])}};__name(_ConditionBuilder,"ConditionBuilder");let ConditionBuilder=_ConditionBuilder;const _AsyncNonce=class _AsyncNonce{constructor(modularityFrontendFormData2,modularityFrontendFormLang2){this.modularityFrontendFormData=modularityFrontendFormData2,this.modularityFrontendFormLang=modularityFrontendFormLang2}async get(statusHandler,moduleId){let url=this.modularityFrontendFormData?.apiRoutes?.nonceGet;if(!url)return statusHandler.setStatus(SubmitStatus.Error,this.modularityFrontendFormLang?.nonceUrlMissing??"Could not find the nonce URL. Please check your configuration.","link_off",0),null;url=moduleId?(()=>{const urlBuilder=new URL(url);return urlBuilder.searchParams.append("module-id",moduleId.toString()),urlBuilder.toString()})():url;try{statusHandler.setStatus(SubmitStatus.Working,this.modularityFrontendFormLang?.nonceRequest??"Fetching security validation key...","lock_open",30);const response=await fetch(url);if(!response.ok)throw statusHandler.setStatus(SubmitStatus.Error,this.modularityFrontendFormLang?.nonceRequestFailed??"Failed to fetch security validation key, please try again.","error",0),new Error(`HTTP error: ${response.status}`);return statusHandler.setStatus(SubmitStatus.Working,this.modularityFrontendFormLang?.nonceRequestSuccess??"Fetched security validation key...","lock",60),(await response.json())?.nonce??null}catch{return statusHandler.setStatus(SubmitStatus.Error,this.modularityFrontendFormLang?.nonceRequestFailed??"Failed to fetch security validation key, please try again.","error",0),null}}inject(form,nonce,nonceElementId){this.isNoncePresent(form,nonceElementId)&&this.removeNonce(form,nonceElementId),form.appendChild(this.createNonceElement(nonce,nonceElementId))}isNoncePresent(form,nonceElementId){return form.querySelector("#"+nonceElementId)!==null}removeNonce(form,nonceElementId){const existingNonceInput=form.querySelector("#"+nonceElementId);existingNonceInput&&form.removeChild(existingNonceInput)}createNonceElement(nonce,nonceElementId){const nonceInput=document.createElement("input");return nonceInput.id=nonceElementId,nonceInput.type="hidden",nonceInput.name="nonce",nonceInput.value=nonce,nonceInput.setAttribute("aria-hidden","true"),nonceInput.setAttribute("autocomplete","off"),nonceInput.setAttribute("autocorrect","off"),nonceInput}async setup(form,statusHandler){const moduleId=parseInt(form.getAttribute("data-js-frontend-form-id")||""),nonce=await this.get(statusHandler,moduleId);nonce&&this.inject(form,nonce,"async-nonce-element")}};__name(_AsyncNonce,"AsyncNonce");let AsyncNonce=_AsyncNonce;const _StatusHandler=class _StatusHandler{constructor(formContainer){this.formContainer=formContainer}setStatus(status,message,icon,progress,delay=200,showReturn=!1,showTryAgain=!1,hideOverlay=!1){this.formContainer.dispatchEvent(new CustomEvent("submitStatusChanged",{detail:{status,message,icon,progress,delay,showReturn,showTryAgain,hideOverlay}}))}};__name(_StatusHandler,"StatusHandler");let StatusHandler=_StatusHandler;const _FieldsInitiator=class _FieldsInitiator{fieldBuilder=null;init(fieldBuilder){this.fieldBuilder=fieldBuilder}initializeConditionals(fields){if(!this.fieldBuilder){console.error("FieldsInitiator is not initialized");return}for(const fieldName in fields)this.fieldBuilder.getFieldsObject()[fieldName].getConditionsHandler().getConditions().forEach(condition=>{condition.getConditionFieldNames().forEach(conditionFieldName=>{this.fieldBuilder.getFieldsObject()[conditionFieldName]&&this.fieldBuilder.getFieldsObject()[conditionFieldName].getConditionsHandler().addValueChangeListener(this.fieldBuilder.getFieldsObject()[fieldName])})});for(const fieldName in fields)this.fieldBuilder.getFieldsObject()[fieldName].getConditionsHandler().checkConditions()}};__name(_FieldsInitiator,"FieldsInitiator");let FieldsInitiator=_FieldsInitiator;const _Notice=class _Notice{constructor(formContainer){this.formContainer=formContainer,this.errorNotice=this.extractNotice(this.errorNoticeTarget),this.successNotice=this.extractNotice(this.successNoticeTarget)}errorNotice;successNotice;errorNoticeTarget="[data-js-frontend-form-error-notice]";successNoticeTarget="[data-js-frontend-form-success-notice]";getErrorNotice(){const div=document.createElement("div");return div.innerHTML=this.errorNotice,div}getSuccessNotice(){const div=document.createElement("div");return div.innerHTML=this.successNotice,div}extractNotice(target){const template=this.formContainer.querySelector(target);return template?template.innerHTML:(console.error("Notice template not found"),"")}};__name(_Notice,"Notice");let Notice=_Notice;const _CustomInvalidValidationMessageItem=class _CustomInvalidValidationMessageItem{constructor(item,validationKeys,attributePrefixCamelCased){this.item=item,this.validationKeys=validationKeys,this.attributePrefixCamelCased=attributePrefixCamelCased,this.setInvalidListener()}cachedCustomValidityMessages={};previousFirstInvalid=null;setInvalidListener(){this.item.addEventListener("input",()=>{this.item.setCustomValidity("")}),this.item.addEventListener("invalid",event=>{const firstFaulty=this.getFirstInvalidReason(this.item);if(firstFaulty===null)return;if(this.cachedCustomValidityMessages[firstFaulty]){this.item.setCustomValidity(this.cachedCustomValidityMessages[firstFaulty]);return}const keyWithFirstUpperCase=firstFaulty.charAt(0).toUpperCase()+firstFaulty.slice(1),datasetKey=this.attributePrefixCamelCased+keyWithFirstUpperCase,customMessage=this.item.dataset[datasetKey];this.cachedCustomValidityMessages[firstFaulty]=customMessage??this.item.validationMessage,customMessage&&this.item.setCustomValidity(customMessage)})}getFirstInvalidReason(input){const validity=input.validity;if(validity.valid)return null;if(this.previousFirstInvalid!==null&&validity[this.previousFirstInvalid])return this.previousFirstInvalid;for(const key of this.validationKeys)if(validity[key])return this.previousFirstInvalid=key,key;return null}};__name(_CustomInvalidValidationMessageItem,"CustomInvalidValidationMessageItem");let CustomInvalidValidationMessageItem=_CustomInvalidValidationMessageItem;const _ValidateForm=class _ValidateForm{attributePrefix="data-js-validation-message-";attributePrefixCamelCased="jsValidationMessage";validationKeys=[];target="";excludeKeys=["valid","constructor"];constructor(){this.validationKeys=this.getValidationKeys(),this.target=this.getTarget(),this.applyValidation(document),this.listenForDomChanges()}applyValidation(root){root.querySelectorAll(this.target).forEach(item=>{const element=item;element.dataset.validationInitialized||(new CustomInvalidValidationMessageItem(element,this.validationKeys,this.attributePrefixCamelCased),element.dataset.validationInitialized="true")})}getTarget(){return`:is(input, select, textarea):is(${this.validationKeys.map(key=>`[${this.attributePrefix}${key.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}]`).join(", ")})`}getValidationKeys(){return Object.getOwnPropertyNames(Object.getPrototypeOf(document.createElement("input").validity)).filter(key=>!this.excludeKeys.includes(key))}listenForDomChanges(){new MutationObserver(mutations=>{mutations.forEach(mutation=>{mutation.addedNodes.forEach(node=>{node instanceof HTMLElement&&this.applyValidation(node)})})}).observe(document.body,{childList:!0,subtree:!0})}};__name(_ValidateForm,"ValidateForm");let ValidateForm=_ValidateForm;const _Form=class _Form{_mode;form;constructor(form,mode){this.form=form,this._mode=mode}get mode(){return this._mode}set mode(value){this.form.setAttribute("data-form-mode",value),this._mode=value}get formElement(){return this.form}get formElementContainer(){return this.form.closest("[data-js-frontend-form]")}get formId(){const formId=this.form.getAttribute("data-js-frontend-form-id");if(formId)return parseInt(formId);throw new Error("Form ID not found")}get holdingPostId(){const holdingPostId=this.form.getAttribute("data-js-frontend-form-holding-post-id");return holdingPostId?parseInt(holdingPostId):null}get formUpdateId(){if(this.mode!==FormMode.Update)return null;const postId=new URLSearchParams(window.location.search).get("postId");if(postId)return parseInt(postId);throw new Error("Post ID not found in URL")}};__name(_Form,"Form");let Form=_Form;const _Step=class _Step{constructor(stepContainer,stepContentContainer,editItem,editItemIcon,id,validator){this.stepContainer=stepContainer,this.stepContentContainer=stepContentContainer,this.editItem=editItem,this.editItemIcon=editItemIcon,this.id=id,this.validator=validator}getStepContainer(){return this.stepContainer}getEditItem(){return this.editItem}getEditItemIcon(){return this.editItemIcon}validate(){return this.validator.validateStep(this.getId().toString())}getStepContentContainer(){return this.stepContentContainer}getId(){return this.id}};__name(_Step,"Step");let Step=_Step;const _StepFactory=class _StepFactory{static createStep(stepContainer,step,editItem,editItemIcon,id,validator){return new Step(stepContainer,step,editItem,editItemIcon,id,validator)}};__name(_StepFactory,"StepFactory");let StepFactory=_StepFactory;const _StepsFactory=class _StepsFactory{static create(container,validator){let steps={};return container.querySelectorAll("[data-js-frontend-form-step-container]").forEach(stepContainer=>{const step=stepContainer.querySelector("[data-js-frontend-form-step]"),id=step?.getAttribute("data-js-frontend-form-step"),editItem=container.querySelector(`[data-js-frontend-form-progressbar-step="${id}"]`),editItemIcon=editItem?.querySelector("[data-material-symbol]");if(!id){console.error("Missing data-js-frontend-form-step attribute");return}const stepId=parseInt(id);steps[stepId]=StepFactory.createStep(stepContainer,step,editItem,editItemIcon,stepId,validator)}),steps}};__name(_StepsFactory,"StepsFactory");let StepsFactory=_StepsFactory;const _StepValidator=class _StepValidator{builder;invalidSteps=[];init(builder){this.builder=builder}getInvalidSteps(){return[...this.invalidSteps].sort((a,b)=>Number(a)-Number(b))}validateSteps(){const fieldsStepObject=this.builder.getFieldsStepObject();this.invalidSteps=[];for(const stepId in fieldsStepObject)this.validateStep(stepId);return this.invalidSteps.length===0}validateStep(stepId){const fields=this.builder.getFieldsStepObject()[stepId];if(!fields)return console.error(`No fields found for step ${stepId}`),!0;const valid=!Object.values(fields).filter(field=>!field.getConditionsHandler().getIsDisabled()).map(field=>field.getValidator().validate()).includes(!1);return!valid&&!this.invalidSteps.includes(stepId)&&this.invalidSteps.push(stepId),valid&&this.invalidSteps.includes(stepId)&&(this.invalidSteps=this.invalidSteps.filter(id=>id!==stepId)),valid}};__name(_StepValidator,"StepValidator");let StepValidator=_StepValidator;const _StatusRenderer=class _StatusRenderer{constructor(formContainer,statusRendererMessageUI,statusRendererOverlayUI,statusRendererButtonUIHandler){this.formContainer=formContainer,this.statusRendererMessageUI=statusRendererMessageUI,this.statusRendererOverlayUI=statusRendererOverlayUI,this.statusRendererButtonUIHandler=statusRendererButtonUIHandler}messageQueue=[];isProcessing=!1;latestStatus=null;timeoutId=null;reset(){this.latestStatus=null,this.isProcessing=!1,this.messageQueue=[],this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=null)}setup(){return this.formContainer.addEventListener("submitStatusChanged",event=>{this.handleStatusEvent(event)}),this}processQueue(){this.messageQueue[0]&&(this.latestStatus=this.messageQueue.shift(),this.isProcessing=!0),this.handleMessage()}handleMessage(){if(!this.latestStatus){this.isProcessing=!1;return}if(this.statusRendererOverlayUI.applyStatusClass(this.latestStatus.status),this.statusRendererButtonUIHandler.toggleReturnButton(this.latestStatus.showReturn),this.statusRendererButtonUIHandler.toggleTryAgainButton(this.latestStatus.showTryAgain),this.statusRendererMessageUI.updateProgressBar(this.latestStatus.progress),this.statusRendererMessageUI.updateDescription(this.latestStatus.message,this.latestStatus.progress),this.statusRendererMessageUI.updateTitle(this.latestStatus.status),this.statusRendererMessageUI.updateIcon(this.latestStatus.icon),this.latestStatus.hideOverlay){this.statusRendererOverlayUI.removeOverlay(this.latestStatus.delay),this.reset();return}this.timeoutId=window.setTimeout(()=>{this.processQueue()},this.latestStatus.delay)}handleStatusEvent(event){const{status,message,icon,progress,delay=200,showReturn=!1,showTryAgain=!1,hideOverlay=!1}=event.detail;this.messageQueue.push({status,message,icon,progress,delay,showReturn,showTryAgain,hideOverlay}),this.isProcessing||(this.statusRendererOverlayUI.showWorkingOverlay(),this.processQueue())}};__name(_StatusRenderer,"StatusRenderer");let StatusRenderer=_StatusRenderer;const _StatusRendererButtonUIHandler=class _StatusRendererButtonUIHandler{constructor(formContainer,returnButton,tryAgainButton,statusRendererOverlayUI){this.formContainer=formContainer,this.returnButton=returnButton,this.tryAgainButton=tryAgainButton,this.statusRendererOverlayUI=statusRendererOverlayUI,this.tryAgainListener(),this.returnToFormListener()}tryAgainOnclick=!1;returnOnclick=!1;toggleReturnButton(shouldShow=!1){this.returnOnclick=shouldShow,this.returnButton.classList.toggle("u-display--none",!shouldShow)}toggleTryAgainButton(shouldShow=!1){this.tryAgainOnclick=shouldShow,this.tryAgainButton.classList.toggle("u-display--none",!shouldShow)}tryAgainListener(){this.tryAgainButton.addEventListener("click",e=>{e.preventDefault(),this.tryAgainOnclick&&this.tryAgainOnclick.retry()})}returnToFormListener(){this.returnButton.addEventListener("click",()=>{this.formContainer.dataset.jsFormStatus==="success"?window.location.reload():this.returnOnclick&&(this.returnOnclick.return(),this.statusRendererOverlayUI.removeOverlay(),this.statusRendererOverlayUI.removeStatusClasses())})}};__name(_StatusRendererButtonUIHandler,"StatusRendererButtonUIHandler");let StatusRendererButtonUIHandler=_StatusRendererButtonUIHandler;const _StatusRendererMessageUI=class _StatusRendererMessageUI{constructor(modularityFrontendFormLang2,icon,title,description,progressbar){this.modularityFrontendFormLang=modularityFrontendFormLang2,this.icon=icon,this.title=title,this.description=description,this.progressbar=progressbar}updateIcon(iconName){const currentIcon=this.icon.getAttribute("data-material-symbol")||"",[currentBase]=currentIcon.split("_"),[newBase]=iconName.split("_");currentBase!==newBase?(this.icon.style.transition="opacity 0.3s",this.icon.style.opacity="0",setTimeout(()=>{this.icon.setAttribute("data-material-symbol",iconName),this.icon.style.opacity="1"},300)):this.icon.setAttribute("data-material-symbol",iconName)}updateTitle(status){const statusTitles={[SubmitStatus.Loading]:this.modularityFrontendFormLang?.statusTitleLoading??"Loading",[SubmitStatus.Success]:this.modularityFrontendFormLang?.statusTitleSucess??"Success",[SubmitStatus.Error]:this.modularityFrontendFormLang?.statusTitleError??"Error",[SubmitStatus.Working]:this.modularityFrontendFormLang?.statusTitleSubmitting??"Submitting"};this.title.textContent=statusTitles[status]??""}updateDescription(message,progress){this.description.textContent=progress>0?`${message} (${progress}%)`:message}updateProgressBar(progress){this.progressbar.style.width=`${progress}%`}};__name(_StatusRendererMessageUI,"StatusRendererMessageUI");let StatusRendererMessageUI=_StatusRendererMessageUI;const _StatusRendererOverlayUI=class _StatusRendererOverlayUI{constructor(formContainer,workingOverlay){this.formContainer=formContainer,this.workingOverlay=workingOverlay}statusClasses=["is-loading","is-working","is-success","is-error"];removeOverlay(delay=0){setTimeout(()=>{this.workingOverlay.classList.add("u-display--none"),this.removeStatusClasses()},delay)}showWorkingOverlay(){this.workingOverlay.classList.remove("u-display--none"),this.workingOverlay.style.opacity="0",setTimeout(()=>{this.workingOverlay.style.opacity="1"},10)}applyStatusClass(status){this.removeStatusClasses(),this.formContainer.classList.add(`is-${status}`),this.formContainer.setAttribute("data-js-form-status",status)}removeStatusClasses(){this.formContainer.classList.remove(...this.statusClasses)}};__name(_StatusRendererOverlayUI,"StatusRendererOverlayUI");let StatusRendererOverlayUI=_StatusRendererOverlayUI;const _StatusRendererFactory=class _StatusRendererFactory{static create(formContainer,modularityFrontendFormLang2){const statusIcon=formContainer.querySelector("[data-js-frontend-form-working__icon]"),statusTitle=formContainer.querySelector("[data-js-frontend-form-working__title]"),description=formContainer.querySelector("[data-js-frontend-form-working__description]"),progressbar=formContainer.querySelector("[data-js-frontend-form-working__progress] .c-progressbar__value"),tryAgainButton=formContainer.querySelector("[data-js-frontend-form-working-try-again-button]"),returnButton=formContainer.querySelector("[data-js-frontend-form-working-return-button]"),workingOverlay=formContainer.querySelector("[data-js-frontend-form-working]");if(!statusIcon||!statusTitle||!description||!progressbar||!workingOverlay||!tryAgainButton||!returnButton)return console.error("Not all status elements were found the form container."),null;const statusRendererOverlayUI=new StatusRendererOverlayUI(formContainer,workingOverlay);return new StatusRenderer(formContainer,new StatusRendererMessageUI(modularityFrontendFormLang2,statusIcon,statusTitle,description,progressbar),statusRendererOverlayUI,new StatusRendererButtonUIHandler(formContainer,returnButton,tryAgainButton,statusRendererOverlayUI)).setup()}};__name(_StatusRendererFactory,"StatusRendererFactory");let StatusRendererFactory=_StatusRendererFactory;const _FormParamExtractor=class _FormParamExtractor{constructor(form){this.form=form}tryExtractFormParams(){const params=new URLSearchParams(window.location.search),postId=Number(params.get("postId")),token=params.get("token")??"",moduleId=Number(this.form.getAttribute("data-js-frontend-form-id")||"");return!isNaN(postId)&&token.length===32?{moduleId,postId,token}:null}};__name(_FormParamExtractor,"FormParamExtractor");let FormParamExtractor=_FormParamExtractor;const _FormDataFetcher=class _FormDataFetcher{constructor(form,formParams,modularityFrontendFormData2,modularityFrontendFormLang2,asyncNonce,statusHandler,statusRenderer){this.form=form,this.formParams=formParams,this.modularityFrontendFormData=modularityFrontendFormData2,this.modularityFrontendFormLang=modularityFrontendFormLang2,this.asyncNonce=asyncNonce,this.statusHandler=statusHandler,this.statusRenderer=statusRenderer}formDataListeners=[];retry(){this.statusRenderer.reset(),this.tryFetchFormData()}return(){this.statusRenderer.reset()}subscribeToFetchedFormData(callback){this.formDataListeners.push(callback)}async tryFetchFormData(){this.statusHandler.setStatus(SubmitStatus.Loading,"Loading form data...","file_open",0,1e3);const formData=await this.get(this.formParams.postId,this.formParams.token);if(formData){if(this.form.mode=FormMode.Update,this.formDataListeners.map(listener=>listener(formData)).includes(!1)){this.statusHandler.setStatus(SubmitStatus.Error,this.modularityFrontendFormLang?.submitError??"Error loading form data.","error",0,1e4,!1,this);return}this.statusHandler.setStatus(SubmitStatus.Success,this.modularityFrontendFormLang?.loadingSuccessful??"Form loaded successfully!","celebration",100,2e3,!1,!1,!0)}}async get(postId,token){let url=this.modularityFrontendFormData?.apiRoutes?.getForm;if(!url)return this.statusHandler.setStatus(SubmitStatus.Loading,"Could not find url.","file_open",100,2e3,this,this),null;const nonce=await this.asyncNonce.get(this.statusHandler,this.form.formId);url=(()=>{const{form}=this,urlBuilder=new URL(url),params=new URLSearchParams({"post-id":postId.toString(),token,"module-id":form.formElement?.getAttribute("data-js-frontend-form-id")||"",nonce:nonce?.toString()||""});return urlBuilder.search=params.toString(),urlBuilder.toString()})();try{const response=await fetch(url),json=await response.json();return response.ok?(this.statusHandler.setStatus(SubmitStatus.Loading,"Loading form data...","file_open",100,500),json?.data??null):(this.statusHandler.setStatus(SubmitStatus.Error,json.message??this.modularityFrontendFormLang?.communicationError??"Communication error.","vpn_key_alert",0,1e4,this,this),null)}catch{return this.statusHandler.setStatus(SubmitStatus.Error,this.modularityFrontendFormLang?.communicationError??"Communication error.","link_off",0,1e4,this,this),null}}};__name(_FormDataFetcher,"FormDataFetcher");let FormDataFetcher=_FormDataFetcher;const _FieldsPopulator=class _FieldsPopulator{constructor(fieldsObject){this.fieldsObject=fieldsObject}tryPopulateFields(data){if(!this.checkIfAllFieldsExistInData(data))return!1;for(const fieldName in data)this.fieldsObject.hasOwnProperty(fieldName)&&this.fieldsObject[fieldName].getValueLoader().load(data[fieldName]);return!0}checkIfAllFieldsExistInData(data){for(const fieldName in data)if(!this.fieldsObject.hasOwnProperty(fieldName))return console.error(`Data could not be loaded for field with name "${fieldName}". It was not found in the fetched data`),!1;return!0}};__name(_FieldsPopulator,"FieldsPopulator");let FieldsPopulator=_FieldsPopulator;const _FormHandler=class _FormHandler{constructor(formContainer,formElement){this.formContainer=formContainer,this.formElement=formElement,this.form=new Form(this.formElement,FormMode.Post),this.init()}form;init(){new ValidateForm;const statusRenderer=StatusRendererFactory.create(this.formContainer,modularityFrontendFormLang);if(!statusRenderer){console.error("StatusRenderer could not be created.");return}const stepValidator=new StepValidator,stepsObject=this.setupSteps(stepValidator,statusRenderer);if(!stepsObject){console.error("No steps were found");return}const fieldsInitiatorInstance=new FieldsInitiator,builder=this.createBuilder(fieldsInitiatorInstance),conditionBuilder=new ConditionBuilder(builder);stepValidator.init(builder),fieldsInitiatorInstance.init(builder),this.setupFields(stepsObject,builder,conditionBuilder),fieldsInitiatorInstance.initializeConditionals(builder.getFieldsObject()),this.removeLoader(stepsObject),this.setupFormPopulator(statusRenderer,builder.getFieldsObject())}setupFormPopulator(statusRenderer,fieldsObject){const formParams=new FormParamExtractor(this.form.formElement).tryExtractFormParams();if(!formParams)return;const formDataFetcher=new FormDataFetcher(this.form,formParams,modularityFrontendFormData,modularityFrontendFormLang,new AsyncNonce(modularityFrontendFormData,modularityFrontendFormLang),new StatusHandler(this.form.formElementContainer),statusRenderer),fieldPopulator=new FieldsPopulator(fieldsObject);formDataFetcher.subscribeToFetchedFormData(data=>fieldPopulator.tryPopulateFields(data)),formDataFetcher.tryFetchFormData()}createBuilder(fieldsInitiatorInstance){return new FieldBuilder(fieldsInitiatorInstance,new Notice(this.form.formElementContainer),modularityFrontendFormData,modularityFrontendFormLang)}setupFields(stepsObject,builder,conditionBuilder){for(const stepId in stepsObject)stepsObject[stepId].getStepContainer().querySelectorAll("[data-js-field]").forEach(element=>{builder.build(element,element.getAttribute("data-js-field")??"",stepId)});for(const fieldName in builder.getFieldsObject())builder.getFieldsObject()[fieldName].init(conditionBuilder)}setupSteps(validator,statusRenderer){const nextButton=this.formContainer.querySelector("[data-js-frontend-form-next-step]"),previousButton=this.formContainer.querySelector("[data-js-frontend-form-previous-step]");if(!nextButton||!previousButton)return console.error("Missing next or previous button"),null;const steps=StepsFactory.create(this.form.formElementContainer,validator),submit=new Submit(this.form,modularityFrontendFormData,modularityFrontendFormLang,new AsyncNonce(modularityFrontendFormData,modularityFrontendFormLang),new StatusHandler(this.formContainer),statusRenderer),stepUIManager=new StepUIManager(steps,modularityFrontendFormLang,nextButton,previousButton);return new Steps(steps,new StepNavigator(steps,validator,submit,stepUIManager,this.formContainer),stepUIManager,nextButton,previousButton).init(),steps}removeLoader(stepsObject){stepsObject[0].getStepContainer().classList.remove("is-loading")}};__name(_FormHandler,"FormHandler");let FormHandler=_FormHandler;document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-js-frontend-form]").forEach(formContainer=>{const form=formContainer.querySelector("form");form&&new FormHandler(formContainer,form)})});
//# sourceMappingURL=init.DpEucEQ4.js.map
